/*
@license

dhtmlxSpreadsheet v.3.0.3 Evaluation

This software is covered by DHTMLX Evaluation License and purposed only for evaluation.
Contact sales@dhtmlx.com to get Commercial or Enterprise license.
Usage without proper license is prohibited.

(c) Dinamenta, UAB.

*/
if(window.dhx&&(window.dhx_legacy=dhx,delete window.dhx),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.dhx=e():t.dhx=e()}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/codebase/",n(n.s=37)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(50);e.el=i.defineElement,e.sv=i.defineSvgElement,e.view=i.defineView,e.create=i.createView,e.inject=i.injectView,e.disableHelp=function(){i.DEVMODE.mutations=!1,i.DEVMODE.warnings=!1,i.DEVMODE.verbose=!1,i.DEVMODE.UNKEYED_INPUT=!1},e.resizer=function(t){return e.el("iframe",{_hooks:{didInsert:function(e){var n=function(){var n=e.el.offsetHeight,i=e.el.offsetWidth;t(i,n)};e.el.contentWindow.onresize=n,n()}},style:"position:absolute;left:0;top:-100%;width:100%;height:100%;margin:1px 0 0;border:none;opacity:0;visibility:hidden;pointer-events:none;"})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2);function o(t){if(!t)return"";var e=(t=--t)%26,n=String.fromCharCode(65+e),i=Math.floor(t/26);return i>0?o(i)+n:n}function r(t){return t?(t=t.toUpperCase()).split("").reduce(function(t,e,n,i){return t+=(e.charCodeAt(0)-64)*Math.pow(26,i.length-(n+1))},0):-1}function s(t,e){if(!e)return{};var n=e.match(/([a-zA-Z]*\d*):([a-zA-Z]*\d*)/);if(n)return{start:s(t,n[1]),end:s(t,n[2])};var i=a(e);if(!i)return{};var o=t.data.getId(i.row),r=t.config.columns[i.col];return o&&r&&r.id?{col:r.id,row:o}:{}}function a(t){var e=t.match(/([a-zA-Z]*)(\d*)/);if(e&&e[1]&&e[2])return{col:r(e[1]),row:parseInt(e[2],10)-1}}function l(t,e){return""+o(e)+(t+1)}function c(t){return new RegExp(/([A-Z]+\d+:[A-Z]+\d+)|(?:,)([A-Z]+\d+)/).test(t)}function u(t){var e=t.split(":").map(function(t){return a(t)});return{start:{row:Math.min(e[0].row,e[1].row),col:Math.min(e[0].col,e[1].col)},end:{row:Math.max(e[0].row,e[1].row),col:Math.max(e[0].col,e[1].col)}}}function d(t){var e=[];if(t)for(var n=u(t),i=n.start,o=n.end,r=i.row;r<=o.row;r++)for(var s=i.col;s<=o.col;s++){var a=l(r,s);e.push(a)}return e}e.getLetterFromNumber=o,e.getNumberFromLetter=r,e.getCellIds=s,e.getCellIndex=a,e.getCellNameByIndex=l,e.getCellNameById=function(t,e,n){if(!e)return"";var r=t.data.getIndex(e)+1,s=i.findIndex(t.config.columns,function(t){return n===t.id});return r<0||s<0?void 0:""+o(s)+r},e.getCellInfo=function(t,e){var n=s(t,e);if(n.start&&(n=n.start),!n||!e)return{locked:!1};var i=t.data.getItem(n.row);return i?(i.$info||(i.$info={}),i.$info[n.col]||(i.$info[n.col]={}),t.data.getItem(n.row).$info[n.col]):{}},e.updateCellInfo=function(t,e,n){var o=s(t,e),r=t.data.getItem(o.row);if(!r)return{};r.$info||(r.$info={}),r.$info[o.col]||(r.$info[o.col]={}),i.extend(r.$info[o.col],n)},e.isRangeId=c,e.getRangeIndexes=u,e.getRangeArray=d,e.getCellsArray=function(t){if(t)return t.split(",").reduce(function(t,e){return c(e=e.toUpperCase())?t=t.concat(d(e)):t.push(e),t},[])},e.extendConfig=function(t,e,n){for(var o in void 0===t&&(t={}),void 0===e&&(e={}),void 0===n&&(n=!0),t){var r=e[o],s=t[o];s&&"validate"in s&&(e[o]=s.validate(r)?r:s.default,t[o]=s.default)}return i.extend(t,e,n)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(new Date).valueOf();e.uid=function(){return"u"+i++},e.extend=function t(e,n,i){if(void 0===i&&(i=!0),n)for(var o in n){var r=n[o],s=e[o];!i||"object"!=typeof s||s instanceof Date||s instanceof Array?e[o]=r:t(s,r)}return e},e.copy=function(t){var e={};for(var n in t)e[n]=t[n];return e},e.naturalSort=function(t){return t.sort(function(t,e){return"string"==typeof t?t.localeCompare(e):t-e})},e.findIndex=function(t,e){for(var n=t.length,i=0;i<n;i++)if(e(t[i]))return i;return-1},e.isEqualString=function(t,e){if(t.length>e.length)return!1;for(var n=0;n<t.length;n++)if(t[n].toLowerCase()!==e[n].toLowerCase())return!1;return!0},e.singleOuterClick=function(t){var e=function(n){t(n)&&document.removeEventListener("click",e)};document.addEventListener("click",e)}},function(t,e,n){"use strict";function i(t,e){for(void 0===e&&(e="dhx_id"),t instanceof Event&&(t=t.target);t&&t.getAttribute;){if(t.getAttribute(e))return t;t=t.parentNode}}Object.defineProperty(e,"__esModule",{value:!0}),n(39),e.toNode=function(t){return"string"==typeof t&&(t=document.getElementById(t)||document.querySelector(t)),t||document.body},e.eventHandler=function(t,e){var n=Object.keys(e);return function(i){for(var o=t(i),r=i.target;r;){var s=r.getAttribute&&r.getAttribute("class")||"";if(s.length)for(var a=s.split(" "),l=0;l<n.length;l++)if(a.indexOf(n[l])>-1)return e[n[l]](i,o);r=r.parentNode}return!0}},e.locate=function(t,e){void 0===e&&(e="dhx_id");var n=i(t,e);return n?n.getAttribute(e):""},e.locateNode=i,e.getBox=function(t){var e=t.getBoundingClientRect(),n=document.body,i=window.pageYOffset||n.scrollTop,o=window.pageXOffset||n.scrollLeft;return{top:e.top+i,left:e.left+o,right:n.offsetWidth-e.right,bottom:n.offsetHeight-e.bottom,width:e.right-e.left,height:e.bottom-e.top}};var o=-1;e.getScrollbarWidth=function(){if(o>-1)return o;var t=document.createElement("div");return document.body.appendChild(t),t.style.cssText="position: absolute;left: -99999px;overflow:scroll;width: 100px;height: 100px;",o=t.offsetWidth-t.clientWidth,document.body.removeChild(t),o},e.fitPosition=function(t,e,n,i){var o=t.left+t.width,r=t.top+t.height;if("bottom"===e)return{position:"absolute",left:l=window.innerWidth<t.left+n?o-n:t.left,top:r+i>window.innerHeight?t.top-i+window.scrollY:r+window.scrollY,minWidth:n};var s=void 0,a=t.top+window.scrollY,l=window.innerWidth<o+n?t.left-n:o;return r+i>window.innerHeight&&(r-i>0?a=r-i+window.scrollY:(s="scroll",i=.8*(window.innerHeight-t.top))),{position:"absolute",left:l,top:a,minWidth:n,overflow:s,height:i}},e.isIE=function(){var t=window.navigator.userAgent;return t.indexOf("MSIE ")>-1||t.indexOf("Trident/")>-1}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(7);e.getCss=function(t){var e="";return t.type!==o.ItemType.button&&t.size&&(e+=" "+t.size),t.active&&(e+=" active"),t.$disabled&&(e+=" disabled"),t.css&&(e+=" "+t.css),e},e.getButtonCss=function(t){var e=" ";switch(e+="link"===t.name?"dhx_btn--link":"dhx_btn--flat",e+="large"===t.size?" dhx_btn--large":" dhx_btn--small",t.usage){case"danger":e+=" dhx_btn--danger";break;case"secondary":e+=" dhx_btn--secondary";break;case"success":e+=" dhx_btn--success"}return e},e.counter=function(t){if(t.count)return i.el(".counter",t.count)},e.icon=function(t){void 0===t&&(t="");var e="dhx-icon-block ";return"dxi"===t.slice(0,3)&&(e+="dxi "),i.el("div",{class:e+t})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.beforeValueChange="beforeValueChange",t.afterValueChange="afterValueChange",t.beforeStyleChange="beforeStyleChange",t.afterStyleChange="afterStyleChange",t.beforeSelectionSet="beforeSelectionSet",t.afterSelectionSet="afterSelectionSet",t.beforeRowAdd="beforeRowAdd",t.afterRowAdd="afterRowAdd",t.beforeRowDelete="beforeRowDelete",t.afterRowDelete="afterRowDelete",t.beforeColumnAdd="beforeColumnAdd",t.afterColumnAdd="afterColumnAdd",t.beforeColumnDelete="beforeColumnDelete",t.afterColumnDelete="afterColumnDelete",t.beforeFocusSet="beforeFocusSet",t.afterFocusSet="afterFocusSet",t.beforeEditStart="beforeEditStart",t.afterEditStart="afterEditStart",t.beforeEditEnd="beforeEditEnd",t.afterEditEnd="afterEditEnd",t.editLineInput="editLineInput",t.editLineFocus="editLineFocus",t.editLineBlur="editLineBlur",t.cellInput="cellInput",t.gridRedraw="gridRedraw"}(e.SpreadsheetEvents||(e.SpreadsheetEvents={})),function(t){t.setCellStyle="setCellStyle",t.setCellValue="setCellValue",t.removeCellStyles="removeCellStyles",t.lockCell="lockCell",t.deleteRow="deleteRow",t.addRow="addRow",t.deleteColumn="deleteColumn",t.addColumn="addColumn",t.groupAction="groupAction",t.groupRowAction="groupRowAction",t.groupColAction="groupColAction"}(e.Actions||(e.Actions={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.events={},this.context=t||this}return t.prototype.on=function(t,e,n){var i=t.toLowerCase();this.events[i]=this.events[i]||[],this.events[i].push({callback:e,context:n||this.context})},t.prototype.detach=function(t,e){var n=t.toLowerCase(),i=this.events[n];if(e)for(var o=i.length-1;o>=0;o--)i[o].context===e&&i.splice(o,1);else this.events[n]=[]},t.prototype.fire=function(t,e){void 0===e&&(e=[]);var n=t.toLowerCase();return!this.events[n]||this.events[n].map(function(t){return t.callback.apply(t.context,e)}).indexOf(!1)<0},t}();e.EventSystem=i,e.EventsMixin=function(t){var e=new i(t=t||{});t.detachEvent=e.detach.bind(e),t.attachEvent=e.on.bind(e),t.callEvent=e.fire.bind(e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(15);e.DataEvents=i.DataEvents,function(t){t.button="button",t.input="input",t.separator="separator",t.text="text",t.iconButton="iconButton",t.imageButton="imageButton",t.spacer="spacer",t.menuItem="menuItem",t.imageButtonText="imageButtonText",t.block="block",t.customHTMLButton="customButton",t.selectButton="selectButton",t.dhxButton="dhx-button"}(e.ItemType||(e.ItemType={})),function(t){t.inputCreated="inputcreated",t.click="click"}(e.ToolbarEvents||(e.ToolbarEvents={})),function(t){t.pointer="pointer",t.click="click"}(e.NavigationType||(e.NavigationType={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={undo:"Undo",redo:"Redo",textColor:"Text color",backgroundColor:"Background color",bold:"Bold",italic:"Italic",lockCell:"Lock cell",unlockCell:"Unlock cell",format:"Format",edit:"Edit",clear:"Clear",clearValue:"Clear value",clearStyles:"Clear styles",clearAll:"Clear all",insert:"Insert",columns:"Columns",rows:"Rows",addColumn:"Add column",removeColumn:"Remove column",addRow:"Add row",removeRow:"Remove row",configuration:"Configuration",underline:"Underline",align:"Align",left:"Left",right:"Right",center:"Center",help:"Help"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=n(3),r=function(){function t(t,e){this._uid=i.uid(),this.config=e||{}}return t.prototype.mount=function(t,e){e&&(this._view=e),t&&this._view&&this._view.mount&&(this._container=o.toNode(t),this._container.tagName?this._view.mount(this._container):this._container.attach&&this._container.attach(this))},t.prototype.getRootView=function(){return this._view},t.prototype.paint=function(){this._view&&(this._view.node||this._container)&&(this._doNotRepaint=!1,this._view.redraw())},t}();e.View=r},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(11)),i(n(30)),i(n(33)),i(n(53)),i(n(16)),i(n(12)),i(n(31)),i(n(32)),i(n(55))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(15);e.DataEvents=i.DataEvents,e.DragBehaviour=i.DragBehaviour,e.DragMode=i.DragMode,function(t){t[t.all=1]="all",t[t.specific=2]="specific",t[t.leafs=3]="leafs"}(e.TreeFilterType||(e.TreeFilterType={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(16),o=n(31),r=n(32);e.isEqualObj=function(t,e){for(var n in t)if(t[n]!==e[n])return!1;return!0},e.naturalCompare=function(t,e){var n=[],i=[];for(t.replace(/(\d+)|(\D+)/g,function(t,e,i){n.push([e||1/0,i||""])}),e.replace(/(\d+)|(\D+)/g,function(t,e,n){i.push([e||1/0,n||""])});n.length&&i.length;){var o=n.shift(),r=i.shift(),s=o[0]-r[0]||o[1].localeCompare(r[1]);if(s)return s}return n.length-i.length},e.findByConf=function(t,e){if("function"==typeof e){if(e.call(this,t))return t}else if(e.by&&e.match&&t[e.by]===e.match)return t},e.isDebug=function(){var t=window.dhx;if(void 0!==t)return void 0!==t.debug&&t.debug},e.dhxWarning=function(t){console.warn(t)},e.dhxError=function(t){throw new Error(t)},e.toProxy=function(t){var e=typeof t;return"string"===e?new i.DataProxy(t):"object"===e?t:void 0},e.toDataDriver=function(t){if("string"==typeof t)switch(t){case"csv":return new o.CsvDriver;case"json":return new r.JsonDriver;default:console.warn("incorrect driver type",t)}else if("object"==typeof t)return t}},function(t,e,n){"use strict";function i(t){if("#"===t.substr(0,1))return t;var e=/(.*?)rgb[a]?\((\d+), *(\d+), *(\d+),* *([\d]*)\)/.exec(t);return"#"+parseInt(e[2],10).toString(16)+parseInt(e[3],10).toString(16)+parseInt(e[4],10).toString(16)}Object.defineProperty(e,"__esModule",{value:!0}),e.rgbToHex=i,e.transpose=function(t,e){for(var n=[],i=0;i<t.length;i++)for(var o=t[i],r=0;r<o.length;r++){n[r]=n[r]||[];var s=e?e(o[r]):o[r];n[r].push(s)}return n},e.getStrWidth=function(t,e){void 0===e&&(e="14px Arial");var n=document.createElement("canvas").getContext("2d");return n.font=e,Math.round(n.measureText(t).width)},e.getStyleByClass=function(t,e,n,o){var r=e.querySelector("."+n),s=function(t,e){return"string"==typeof e?(t.insertAdjacentHTML("beforeend",e),t.lastChild):(t.appendChild(e),e)}(r,'<div class="'+t+'"></div>'),a=window.getComputedStyle(s),l={color:"rgb(0, 0, 0)"===a.color?o.color:i(a.color),background:"rgba(0, 0, 0, 0)"===a.backgroundColor?o.background:i(a.backgroundColor),fontSize:parseFloat(a.fontSize)};return r.removeChild(s),l.color===o.color&&l.background===o.background&&l.fontSize===o.fontSize?null:l},e.removeHTMLTags=function(t){return(""+(t||"")).replace(/<[^>]*>/g,"").replace(/[\"]/g,"&quot;").trim()},e.isCssSupport=function(t,e){try{return CSS.supports(t,e)}catch(i){var n=document.createElement("div");return n.style[t]=e,n.style[t]===e}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1);function o(t,e){return'<div class="dhx_custom_header_cell">'+t+'\n\t<div class="dhx_resizer_grip_wrap">\n\t\t\t<div class="dhx_resizer_grip" dhx_id='+e+'>\n\t\t\t\t<div class="dhx_resizer_grip_line"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t</div>'}e.getHeaderCell=o,e.updateColumns=function(t){var e=0;t.columns.map(function(t,n){if(t.width=t.width||120,e+=t.width,"$index"!==t.id){var r=i.getLetterFromNumber(n);t.header=[{text:o(r,n),css:""}],t.$letter=r}}),t.$totalWidth=e},e.updateRowsIndex=function(t){t.map(function(t,e){t.$index=e+1})},e.removeRowsCss=function(t){t.data.map(function(e){t.removeRowCss(e.id,"dhx_selected_row")})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.afterAdd="afteradd",t.beforeAdd="beforeadd",t.removeAll="removeall",t.beforeRemove="beforeremove",t.afterRemove="afterremove",t.change="change",t.load="load"}(e.DataEvents||(e.DataEvents={})),function(t){t.beforeDrag="beforedrag",t.beforeDrop="beforeDrop",t.dragStart="dragstart",t.dragEnd="dragend",t.canDrop="candrop",t.cancelDrop="canceldrop",t.dropComplete="dropcomplete",t.dragOut="dragOut",t.dragIn="dragIn"}(e.DragEvents||(e.DragEvents={})),function(t){t.target="target",t.both="both",t.source="source"}(e.DragMode||(e.DragMode={})),function(t){t.child="child",t.sibling="sibling",t.complex="complex"}(e.DragBehaviour||(e.DragBehaviour={})),function(t){t.beforeUnSelect="beforeunselect",t.afterUnSelect="afterunselect",t.beforeSelect="beforeselect",t.afterSelect="afterselect"}(e.SelectionEvents||(e.SelectionEvents={}))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function e(t){this.url=t}return e.prototype.load=function(){return this._ajax(this.url)},e.prototype.save=function(t,e){return this._ajax(this.url,t,{insert:"POST",delete:"DELETE",update:"POST"}[e]||"POST")},e.prototype._ajax=function(e,n,i){return void 0===i&&(i="GET"),new t(function(t,o){var r=new XMLHttpRequest;switch(r.onload=function(){r.status>=200&&r.status<300?t(r.response||r.responseText):o({status:r.status,statusText:r.statusText})},r.onerror=function(){o({status:r.status,statusText:r.statusText})},r.open(i,e),r.setRequestHeader("Content-Type","application/json"),i){case"POST":case"DELETE":case"PUT":r.send(JSON.stringify(n));break;case"GET":default:r.send()}})},e}();e.DataProxy=n}).call(this,n(20))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.sort="sort",t.expand="expand",t.headerInput="headerInput",t.cellClick="cellClick",t.cellRightClick="cellRightClick",t.cellMouseOver="cellMouseOver",t.cellMouseDown="cellMouseDown",t.cellDblClick="cellDblClick",t.headerCellClick="headerCellClick",t.footerCellClick="footerCellClick",t.headerCellMouseOver="headerCellMouseOver",t.footerCellMouseOver="footerCellMouseOver",t.headerCellMouseDown="headerCellMouseDown",t.footerCellMouseDown="footerCellMouseDown",t.headerCellDblClick="headerCellDblClick",t.footerCellDblClick="footerCellDblClick"}(e.GridEvents||(e.GridEvents={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getRealPosition=function(t){var e=t.getBoundingClientRect();return{left:e.left+window.pageXOffset,right:e.right+window.pageXOffset,top:e.top+window.pageYOffset,bottom:e.bottom+window.pageYOffset}},e.calculatePosition=function(t,e){var n=window.pageXOffset+window.innerWidth,i=window.pageYOffset+window.innerHeight,o={left:null,top:null,minWidth:e.width+"px",position:"absolute"};return"bottom"===e.mode?(t.left+e.width>n?o.left=t.left-e.width+"px":o.left=t.left+"px",t.bottom+e.height>i?o.top=t.top-e.height+"px":o.top=t.bottom+"px"):(t.right+e.width>n?o.left=t.left-e.width+"px":o.left=t.right+"px",t.top+e.height>i?o.top=t.bottom-e.height+"px":o.top=t.top+"px"),o},e.addInGroups=function(t,e){t[e.group]?(e.active&&(t[e.group].active=e.id),t[e.group].elements.push(e.id)):t[e.group]={active:e.active?e.id:null,elements:[e.id]}}},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),r=n(86),s=n(87),a=n(88),l=n(89),c=n(90),u=n(91),d=n(92),f=n(93),h=n(94),p=n(95),g=n(96);e.actions={setCellStyle:p.SetCellStyle,setCellValue:g.SetCellValue,removeCellStyles:h.RemoveCellStyles,lockCell:f.LockCell,deleteRow:l.DeleteRow,addRow:s.AddRow,deleteColumn:a.DeleteColumn,addColumn:r.AddColumn,groupAction:c.GroupAction,groupRowAction:d.GroupRowAction,groupColAction:u.GroupColAction};var v=function(){function t(t){this._config=t,this._actions=[],this._redoActions=[]}return t.prototype.execute=function(t,n){if(Array.isArray(t)){var r=function(t,n){var o=t.map(function(t){var o=t.groupAction||t.action;if(o)return new e.actions[o](i({},t,n))});return{do:function(){o.map(function(t){return t.do()})},undo:function(){o.map(function(t){return t.undo()})}}}(t,this._config);return r.do(),void this._actions.push(r)}if(o.extend(n,this._config),e.actions[t]){var s=new e.actions[t](n);s.do(),this._actions.push(s)}},t.prototype.undo=function(){var t=this._actions.pop();t&&(t.undo(),this._redoActions.push(t))},t.prototype.redo=function(){var t=this._redoActions.pop();t&&(t.do(),this._actions.push(t))},t}();e.ActionsManager=v},function(t,e,n){(function(e,n){!function(){var i=1,o={},r=!1;function s(t){e.setImmediate?n(t):e.importScripts?setTimeout(t):(o[++i]=t,e.postMessage(i,"*"))}function a(t){"use strict";if("function"!=typeof t&&void 0!=t)throw TypeError();if("object"!=typeof this||this&&this.then)throw TypeError();var e,n,i=this,o=0,r=0,l=[];i.promise=i,i.resolve=function(t){return e=i.fn,n=i.er,o||(r=t,o=1,s(d)),i},i.reject=function(t){return e=i.fn,n=i.er,o||(r=t,o=2,s(d)),i},i._d=1,i.then=function(t,e){if(1!=this._d)throw TypeError();var n=new a;return n.fn=t,n.er=e,3==o?n.resolve(r):4==o?n.reject(r):l.push(n),n},i.catch=function(t){return i.then(null,t)};var c=function(t){o=t||4,l.map(function(t){3==o&&t.resolve(r)||t.reject(r)})};try{"function"==typeof t&&t(i.resolve,i.reject)}catch(t){i.reject(t)}return i;function u(t,e,n,i){if(2==o)return i();if("object"!=typeof r&&"function"!=typeof r||"function"!=typeof t)i();else try{var s=0;t.call(r,function(t){s++||(r=t,e())},function(t){s++||(r=t,n())})}catch(t){r=t,n()}}function d(){var t;try{t=r&&r.then}catch(t){return r=t,o=2,d()}u(t,function(){o=1,d()},function(){o=2,d()},function(){try{1==o&&"function"==typeof e?r=e(r):2==o&&"function"==typeof n&&(r=n(r),o=1)}catch(t){return r=t,c()}r==i?(r=TypeError(),c()):u(t,function(){c(3)},c,function(){c(1==o&&3)})})}}(e=this).setImmediate||e.addEventListener("message",function(t){if(t.source==e)if(r)s(o[t.data]);else{r=!0;try{o[t.data]()}catch(t){}delete o[t.data],r=!1}}),a.resolve=function(t){if(1!=this._d)throw TypeError();return t instanceof a?t:new a(function(e){e(t)})},a.reject=function(t){if(1!=this._d)throw TypeError();return new a(function(e,n){n(t)})},a.all=function(t){if(1!=this._d)throw TypeError();if(!(t instanceof Array))return a.reject(TypeError());var e=new a;return function n(i,o){return o?e.resolve(o):i?e.reject(i):(0==t.reduce(function(t,e){return e&&e.then?t+1:t},0)&&e.resolve(t),void t.map(function(e,i){e&&e.then&&e.then(function(e){return t[i]=e,n(),e},n)}))}(),e},a.race=function(t){if(1!=this._d)throw TypeError();if(!(t instanceof Array))return a.reject(TypeError());if(0==t.length)return new a;var e=new a;return function n(i,o){return o?e.resolve(o):i?e.reject(i):(0==t.reduce(function(t,e){return e&&e.then?t+1:t},0)&&e.resolve(t),void t.map(function(t,e){t&&t.then&&t.then(function(t){n(null,t)},n)}))}(),e},a._d=1,t.exports=a}()}).call(this,n(28),n(41).setImmediate)},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(36)),i(n(76)),i(n(77)),i(n(78)),i(n(22)),i(n(7))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(64),o=n(65),r=n(66),s=n(67),a=n(68),l=n(69),c=n(70),u=n(71),d=n(72),f=n(73),h=n(74),p=n(7);function g(t,e){if(t.$hidden)return null;switch(t.type){case p.ItemType.button:return i.button(t);case p.ItemType.text:return h.text(t);case p.ItemType.separator:return d.separator(t);case p.ItemType.spacer:return f.spacer(t);case p.ItemType.input:return c.input(t,e);case p.ItemType.imageButton:return a.imageButton(t);case p.ItemType.iconButton:return s.iconButton(t);case p.ItemType.selectButton:case p.ItemType.menuItem:return u.menuItem(t);case p.ItemType.imageButtonText:return l.imageButtonText(t);case p.ItemType.customHTMLButton:return o.customHTMLButton(t);case p.ItemType.dhxButton:return r.dhx_button(t);case p.ItemType.block:default:throw new Error("unknown item type")}}e.itemfactory=g,e.createFactory=function(t,e){void 0===e&&(e=[]);var n={};return e.forEach(function(t){return n[t]=!0}),function(e,i){return e.type=e.type||t,n[e.type]&&(e.type=t),g(e,i)}}},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),s=n(0),a=n(6),l=n(75),c=n(3),u=n(9),d=n(10),f=n(18),h=n(22),p=n(7),g=function(t){function e(e,n){var i=t.call(this,e,r.extend({popupWidth:175,popupHeight:36},n))||this;return i._isContextMenu=!1,i._documentHaveListener=!1,i.events=new a.EventSystem,i.data=new d.TreeCollection({},i.events),i._documentClick=function(t){c.locate(t,"dhx_widget_id")!==i._uid&&i._documentHaveListener&&(document.removeEventListener("click",i._documentClick),i._documentHaveListener=!1,i._close())},i._currentRoot=i.data.getRoot(),i._factory=h.createFactory(p.ItemType.menuItem),i._init(),i._initHandlers(),i._initEvents(),i}return i(e,t),e.prototype.paint=function(){t.prototype.paint.call(this),this._vpopups.redraw()},e.prototype.disable=function(t){this._setProp(t,"$disabled",!0)},e.prototype.enable=function(t){this._setProp(t,"$disabled",!1)},e.prototype.show=function(t){this._setProp(t,"$hidden",!1)},e.prototype.hide=function(t){this._setProp(t,"$hidden",!0)},e.prototype.destructor=function(){l.keyManager.removeHotKey(null,this)},e.prototype._close=function(){this.config.navigationType===p.NavigationType.click&&(this._isActive=!1),clearTimeout(this._currentTimeout),this._activeMenu=null,this.paint()},e.prototype._init=function(){var t=this;this._vpopups=s.create({render:function(){return s.el("div",o({dhx_widget_id:t._uid,class:"menu-popups"+(t._isContextMenu?" context-menu":"")},t._handlers),t._drawPopups())}}),this._vpopups.mount(document.body)},e.prototype._initHandlers=function(){var t=this;this._isActive=this.config.navigationType!==p.NavigationType.click,this._handlers={onmousemove:function(e){if(t._isActive){var n=c.locateNode(e);if(n){var i=n.getAttribute("dhx_id");if(t._activeMenu!==i){if(t._activeMenu=i,t.data.haveChilds(i)){var o=f.getRealPosition(n);t.data.update(i,{$position:o},!1)}t._activeItemChange(i)}}else t._activeItemChange(null)}},onmouseleave:function(){t.config.navigationType!==p.NavigationType.click&&t._activeItemChange(null)},onclick:function(e){var n=c.locateNode(e);if(n){var i=n.getAttribute("dhx_id"),o=t.data.getItem(i);switch(o.type){case p.ItemType.selectButton:case p.ItemType.menuItem:if(i===t._currentRoot)return void t._close();if(t._isActive||(t._isActive=!0),t._setRoot(i),t._activeMenu=i,t.data.haveChilds(i)){var r=f.getRealPosition(n);t.data.update(i,{$position:r},!1),t._activeItemChange(i)}else t._onMenuItemClick(i,e);break;case p.ItemType.dhxButton:case p.ItemType.imageButtonText:case p.ItemType.iconButton:case p.ItemType.imageButton:case p.ItemType.button:case p.ItemType.customHTMLButton:o.twoState&&t.data.update(o.id,{active:!o.active}),t.events.fire(p.ToolbarEvents.click,[i,e]);case p.ItemType.separator:case p.ItemType.input:case p.ItemType.text:case p.ItemType.spacer:t._close();default:return}}}}},e.prototype._initEvents=function(){var t=this,e=null;this.data.events.on(p.DataEvents.change,function(){t.paint(),e&&clearTimeout(e),e=setTimeout(function(){t._normalizeData(),t._resetHotkeys(),e=null,t.paint()},100)}),this.events.on(p.ToolbarEvents.click,function(e){var n=t.data.getItem(e),i=t.data.getItem(n.parent);if(i&&i.type===p.ItemType.selectButton&&t.data.update(n.parent,{value:n.value,icon:n.icon}),n.group){var o=t._groups[n.group];o.active&&t.data.update(o.active,{active:!1}),o.active=n.id,t.data.update(n.id,{active:!0})}})},e.prototype._drawPopups=function(){var t=this,e=this._activeMenu;if(!this._isContextMenu&&!e)return null;var n=this._currentRoot;return this._isContextMenu&&!this._activePosition?null:this._getParents(e,n).map(function(e){if(!t.data.haveChilds(e))return null;var i=t.data.getItem(e)||{},o=0,r=0;t.data.eachChild(e,function(t){t.$hidden||("separator"===t.type||t.separator?r++:o++)},!1);var a,l,c=i.width||t.config.popupWidth;t._isContextMenu&&t._activePosition&&e===n?(a=t._activePosition,l=t.config.popupHeight*o+5*r):l=((a=i.$position).bottom-a.top)*o+5*r;var u=t._getMode(i,n,a===t._activePosition);return s.el("div",{class:"dhx_widget menu-popup",style:f.calculatePosition(a,{mode:u,width:c,height:l})},t._drawMenuItems(e))}).reverse()},e.prototype._onMenuItemClick=function(t,e){this.data.getItem(t).$disabled||(this.events.fire(p.ToolbarEvents.click,[t,e]),this._close())},e.prototype._activeItemChange=function(t){var e=this;t&&!this._documentHaveListener&&this._listenOuterClick(),t&&this.data.haveChilds(t)?(this._activeMenu=t,clearTimeout(this._currentTimeout),this.paint()):(this._activeMenu=t,clearTimeout(this._currentTimeout),this._currentTimeout=setTimeout(function(){return e.paint()},400))},e.prototype._resetHotkeys=function(){var t=this;l.keyManager.removeHotKey(null,this),this.data.map(function(e){e.hotkey&&l.keyManager.addHotKey(e.hotkey,function(){return t._onMenuItemClick(e.id,null)},t)})},e.prototype._listenOuterClick=function(){document.addEventListener("click",this._documentClick),this._documentHaveListener=!0},e.prototype._getMode=function(t,e,n){return void 0===n&&(n=!1),t.parent===e?"bottom":"right"},e.prototype._drawMenuItems=function(t){var e=this;return this.data.map(function(t){return e._factory(t,e.events)},t,!1)},e.prototype._normalizeData=function(){var t=this,e=this.data.getRoot(),n={};this.data.eachChild(e,function(e){t.data.haveChilds(e.id)&&e.parent!==t.data.getRoot()&&(e.$openIcon="right"),e.group&&f.addInGroups(n,e)},!0),this._groups=n},e.prototype._setRoot=function(t){},e.prototype._getParents=function(t,e){var n=[],i=!1,o=this.data.getItem(t),r=o&&o.$disabled;return this.data.eachParent(t,function(t){t.id===e?(n.push(t.id),i=!0):i||n.push(t.id)},!r),this._isContextMenu&&this._activePosition&&n.push(e),n},e.prototype._setProp=function(t,e,n){var i,o=this;Array.isArray(t)?t.forEach(function(t){var i;return o.data.update(t,((i={})[e]=n,i))}):this.data.update(t,((i={})[e]=n,i))},e}(u.View);e.MenuBase=g},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(8),r=n(1);function s(t,e){return'<div class=\'dhx_toolbar_colorpicker\'>\n\t\t<div class="dhx_selected_color" style="background:'+t+'"></div>\n\t\t<div class="dhx_colorpicker_title">'+e+"</div>\n\t</div>"}e.getColorpickerTemplate=s,e.updateToolbar=function(t,e){e=i({locked:!1},e);var n=i({color:"#4C4C4C",background:"#FFF","text-align":"left","font-style":"","font-weight":"","text-decoration":""},dhx.css.get(e.css));for(var r in function(e){for(var n in e)switch(n){case"color":t.data.update(n,{html:s(e[n]||"#4C4C4C",o.default.textColor)});break;case"background":t.data.update(n,{html:s(e[n]||"#FFF",o.default.backgroundColor)});break;case"text-align":t.data.update("align-left",{active:"left"===e[n]}),t.data.update("align-right",{active:"right"===e[n]}),t.data.update("align-center",{active:"center"===e[n]});break;case"font-weight":t.data.update("font-weight-bold",{active:"bold"===e[n]});break;case"font-style":t.data.update("font-style-italic",{active:"italic"===e[n]});break;case"text-decoration":t.data.update("text-decoration-underline",{active:"underline"===e[n]})}}(n),e)switch(r){case"locked":t.data.getItem("lock")&&t.data.update("lock",{active:e[r]})}},e.getToggledValue=function(t,e,n,i){var o=r.getCellInfo(t,e);return(dhx.css.get(o.css)||{})[n]?"":i}},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(26)),i(n(40)),i(n(27))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=n(27);!function(t){t.right="right",t.bottom="bottom",t.center="center"}(e.Position||(e.Position={}));var r=new WeakMap,s=[],a=document.createElement("div");function l(t,e){e&&clearTimeout(r.get(t));var n=s.indexOf(t);n<0?document.body.removeChild(t):(a.removeChild(t),s.splice(n,1),0===s.length&&document.body.removeChild(a))}a.className="dhx-message-container",e.message=function(t){"string"==typeof t&&(t={text:t});var e=document.createElement("div");if(e.className="dhx-message "+(t.css||""),e.innerHTML='<span class="message-text">'+t.text+'</span> <div class="dxi '+t.icon+'"></div>',t.at){e.style.position="absolute";var n=t.at,c=n.node,u=n.position,d=i.toNode(c).getBoundingClientRect();document.body.appendChild(e);var f=e.getBoundingClientRect(),h=f.width,p=f.height,g=o.findPosition(d,u,h,p),v=g.left,_=g.top,y=g.pos;e.className+=" "+y,e.style.left=v+"px",e.style.top=_+"px"}else 0===s.length&&document.body.appendChild(a),s.push(e),a.appendChild(e);if(t.expire){var m=setTimeout(function(){return l(e)},t.expire);r.set(e,m)}e.onclick=function(){return l(e,!0)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,o=n(3),r=n(26);function s(t,e,n,o){var s,a,l;switch(e){case r.Position.center:return(a=t.left+window.pageXOffset+(t.width-n)/2)+8<window.pageXOffset&&(a=t.left+window.pageXOffset),{left:a,top:l=t.top+window.pageYOffset+(t.height-o)/2,pos:s=i.center};case r.Position.right:return s=i.right,(a=t.right+window.pageXOffset)+n+8>window.innerWidth+window.pageXOffset&&(a=window.pageXOffset+t.left-n,s=i.left),{left:a,top:l=window.pageYOffset+t.top+(t.height-o)/2,pos:s};case r.Position.bottom:return(a=window.pageXOffset+t.left+(t.width-n)/2)<window.pageXOffset&&(a=window.pageXOffset+t.left),s=i.bottom,(l=window.pageYOffset+t.bottom)+o+8>window.innerHeight+window.pageYOffset&&(l=window.pageYOffset+t.top-o,s=i.top),{left:a,top:l,pos:s}}}!function(t){t.left="left",t.right="right",t.top="top",t.bottom="bottom",t.center="center"}(i=e.RealPosition||(e.RealPosition={})),e.findPosition=s;var a=document.createElement("div"),l=document.createElement("span");l.className="tooltip-text",a.appendChild(l),a.style.position="absolute";var c=null,u=null,d=!1,f=null;function h(t,e,n,o,r){void 0===r&&(r=!1);var c=t.getBoundingClientRect();l.textContent=e,document.body.appendChild(a),a.className="dhx-tooltip"+(r?" forced":"");var u=a.getBoundingClientRect(),f=s(c,n,u.width,u.height),h=f.left,p=f.top,g=f.pos;switch(g){case i.bottom:case i.top:case i.left:case i.right:case i.center:a.style.left=h+"px",a.style.top=p+"px"}a.className+=" "+g+" "+(o||""),d=!0,r||setTimeout(function(){a.className+=" animate-tooltip"})}function p(t,e,n,i,o){void 0===o&&(o=!1);var r=function(){d||(c&&clearTimeout(c),c=setTimeout(function(){h(t,e,n,i)},750))},s=function(){d&&u&&(f=setTimeout(function(){document.body.removeChild(a),d=!1,f=null},200)),clearTimeout(c),o||document.removeEventListener("mousemove",r),document.removeEventListener("mouseout",s),document.removeEventListener("click",s),u=null};o?h(t,e,n,i,o):document.addEventListener("mousemove",r),document.addEventListener("mouseout",s),document.addEventListener("click",s)}function g(t,e){var n=o.toNode(e.node);n!==u&&(u=n,f?(clearTimeout(f),f=null,p(n,t,e.position,e.css,!0)):p(n,t,e.position||r.Position.bottom,e.css))}function v(t){var e=o.locateNode(t,"dhx_tooltip_text");e&&g(e.getAttribute("dhx_tooltip_text"),{position:e.getAttribute("dhx_tooltip_position")||r.Position.bottom,node:e})}e.tooltip=g,e.enableTooltip=function(){document.addEventListener("mousemove",v)},e.disableTooltip=function(){document.removeEventListener("mousemove",v)}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(49)),i(n(17))},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(6),r=n(51),s=n(52),a=n(16),l=n(12),c=n(11),u=n(2),d=function(){function t(t,e){this._order=[],this._pull={},this._changes={order:[]},this._initOrder=null,this.config=t||{},this._sort=new s.Sort,this._loader=new r.Loader(this,this._changes),this.events=e||new o.EventSystem(this)}return t.prototype.add=function(t,e){this.events.fire(c.DataEvents.beforeAdd,[t])&&(this._addCore(t,e),this._onChange("add",t.id,t),this.events.fire(c.DataEvents.afterAdd,[t]))},t.prototype.remove=function(t){var e=this._pull[t];if(e){if(!this.events.fire(c.DataEvents.beforeRemove,[e]))return;this._removeCore(e.id),this._onChange("remove",t,e)}this.events.fire(c.DataEvents.afterRemove,[e])},t.prototype.removeAll=function(){this._removeAll(),this.events.fire(c.DataEvents.removeAll),this.events.fire(c.DataEvents.change)},t.prototype.exists=function(t){return!!this._pull[t]},t.prototype.getNearId=function(t){if(!this._pull[t])return this._order[0].id||""},t.prototype.getItem=function(t){return this._pull[t]},t.prototype.update=function(t,e,n){var i=this.getItem(t);if(i){if(l.isEqualObj(e,i))return;e.id&&t!==e.id?(l.dhxWarning("this method doesn't allow change id"),l.isDebug()):(u.extend(this._pull[t],e,!1),this.config.update&&this.config.update(this._pull[t]),n||this._onChange("update",t,this._pull[t]))}else l.dhxWarning("item not found")},t.prototype.getIndex=function(t){var e=u.findIndex(this._order,function(e){return e.id===t});return this._pull[t]&&e>=0?e:-1},t.prototype.getId=function(t){if(this._order[t])return this._order[t].id},t.prototype.getLength=function(){return this._order.length},t.prototype.filter=function(t,e){var n=this;if((e=u.extend({add:!1,multiple:!0},e)).add||(this._order=this._initOrder||this._order,this._initOrder=null),this._filters=this._filters||{},e.multiple&&t||(this._filters={}),t){if("function"==typeof t){this._filters._={match:"_",compare:t}}else t.match?(t.compare=t.compare||function(t,e){return t===e},this._filters[t.by]=t):delete this._filters[t.by];var i=this._order.filter(function(t){return Object.keys(n._filters).every(function(e){return t[e]?n._filters[e].compare(t[e],n._filters[e].match,t):n._filters[e].compare(t)})});this._initOrder||(this._initOrder=this._order,this._order=i)}this.events.fire(c.DataEvents.change)},t.prototype.find=function(t){for(var e in this._pull){var n=l.findByConf(this._pull[e],t);if(n)return n}return null},t.prototype.findAll=function(t){var e=[];for(var n in this._pull){var i=l.findByConf(this._pull[n],t);i&&e.push(i)}return e},t.prototype.sort=function(t){this._sort.sort(this._order,t),this._initOrder&&this._initOrder.length&&this._sort.sort(this._initOrder,t),this.events.fire(c.DataEvents.change)},t.prototype.copy=function(t,e,n,o){if(!this.exists(t))return null;var r=u.uid();return n?o?void n.add(i({},this.getItem(t)),e,o):n.exists(t)?(n.add(i({},this.getItem(t),{id:r}),e),r):(n.add(this.getItem(t),e),t):(this.add(i({},this.getItem(t),{id:r}),e),r)},t.prototype.move=function(t,e,n,i){if(n&&n!==this&&this.exists(t)){var o=this.getItem(t);return n.exists(t)&&(o.id=u.uid()),i&&(o.parent=i),n.add(o,e),this.remove(o.id),o.id}if(this.getIndex(t)===e)return null;var r=this._order.splice(this.getIndex(t),1)[0];return-1===e&&(e=this._order.length),this._order.splice(e,0,r),this.events.fire(c.DataEvents.change),t},t.prototype.load=function(t,e){return"string"==typeof t&&(t=new a.DataProxy(t)),this._loader.load(t,e)},t.prototype.parse=function(t,e){return this._removeAll(),this._loader.parse(t,e)},t.prototype.$parse=function(t){var e=this.config.approximate;e&&(t=this._approximate(t,e.value,e.maxNum)),this._parse_data(t),this.events.fire(c.DataEvents.change),this.events.fire(c.DataEvents.load)},t.prototype.save=function(t){this._loader.save(t)},t.prototype.isSaved=function(){return!this._changes.order.length},t.prototype.map=function(t){for(var e=[],n=0;n<this._order.length;n++)e.push(t.call(this,this._order[n],n));return e},t.prototype.reduce=function(t,e){for(var n=0;n<this._order.length;n++)e=t.call(this,e,this._order[n],n);return e},t.prototype.serialize=function(){return this.map(function(t){var e=i({},t);return Object.keys(e).forEach(function(t){"$"===t[0]&&delete e[t]}),e})},t.prototype.getInitialData=function(){return this._initOrder},t.prototype._removeAll=function(){this._pull={},this._order=[],this._changes.order=[],this._initOrder=null},t.prototype._addCore=function(t,e){this.config.init&&(t=this.config.init(t)),t.id=t.id?t.id.toString():u.uid(),this._pull[t.id]&&l.dhxError("Item already exist"),this._initOrder&&this._initOrder.length&&this._addToOrder(this._initOrder,t,e),this._addToOrder(this._order,t,e)},t.prototype._removeCore=function(t){this.getIndex(t)>=0&&(this._order=this._order.filter(function(e){return e.id!==t}),delete this._pull[t]),this._initOrder&&this._initOrder.length&&(this._initOrder=this._initOrder.filter(function(e){return e.id!==t}))},t.prototype._parse_data=function(t){var e=this._order.length;this.config.prep&&(t=this.config.prep(t));for(var n=0,i=t;n<i.length;n++){var o=i[n];this.config.init&&(o=this.config.init(o)),o.id=o.id||u.uid(),this._pull[o.id]=o,this._order[e++]=o}},t.prototype._approximate=function(t,e,n){for(var i=t.length,o=e.length,r=Math.floor(i/n),s=Array(Math.ceil(i/r)),a=0,l=0;l<i;l+=r){for(var c=u.copy(t[l]),d=Math.min(i,l+r),f=0;f<o;f++){for(var h=0,p=l;p<d;p++)h+=t[p][e[f]];c[e[f]]=h/(d-l)}s[a++]=c}return s},t.prototype._onChange=function(t,e,n){for(var o=0,r=this._changes.order;o<r.length;o++){var s=r[o];if(s.id===e&&!s.saving)return s.error&&(s.error=!1),s=i({},s,{obj:n,status:t}),void this.events.fire(c.DataEvents.change,[e,t,n])}this._changes.order.push({id:e,status:t,obj:i({},n),saving:!1}),this.events.fire(c.DataEvents.change,[e,t,n])},t.prototype._addToOrder=function(t,e,n){n>=0&&t[n]?(this._pull[e.id]=e,t.splice(n,0,e)):(this._pull[e.id]=e,t.push(e))},t}();e.DataCollection=d},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t){void 0===t&&(t={});this.config=i({},{skipHeader:0,nameByHeader:!1,row:"\n",column:","},t),this.config.nameByHeader&&(this.config.skipHeader=1)}return t.prototype.getFields=function(t,e){for(var n=t.trim().split(this.config.column),i={},o=0;o<n.length;o++)i[e?e[o]:o+1]=n[o];return i},t.prototype.getRows=function(t){return t.trim().split(this.config.row)},t.prototype.toJsonArray=function(t){var e=this,n=this.getRows(t),i=this.config.names;if(this.config.skipHeader){var o=n.splice(0,this.config.skipHeader);this.config.nameByHeader&&(i=o[0].trim().split(this.config.column))}return n.map(function(t){return e.getFields(t,i)})},t}();e.CsvDriver=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.prototype.toJsonArray=function(t){return this.getRows(t)},t.prototype.getFields=function(t){return t},t.prototype.getRows=function(t){return"string"==typeof t?JSON.parse(t):t},t}();e.JsonDriver=i},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),s=n(30),a=n(16),l=n(12),c=n(11);function u(t,e,n,i){void 0!==i&&-1!==i&&t[n]&&t[n][i]?t[n].splice(i,0,e):(t[n]||(t[n]=[]),t[n].push(e))}var d=function(t){function e(e,n){var i,o=t.call(this,e,n)||this,s=o._root="_ROOT_"+r.uid();return o._childs=((i={})[s]=[],i),o._initChilds=null,o}return i(e,t),e.prototype.add=function(e,n,i){if(void 0===n&&(n=-1),void 0===i&&(i=this._root),"object"!=typeof e&&(e={value:e}),e.parent=e.parent?e.parent.toString():i,t.prototype.add.call(this,e,n),Array.isArray(e.childs))for(var o=0,r=e.childs;o<r.length;o++){var s=r[o];this.add(s,-1,e.id)}},e.prototype.getRoot=function(){return this._root},e.prototype.getParent=function(t,e){if(void 0===e&&(e=!1),!this._pull[t])return null;var n=this._pull[t].parent;return e?this._pull[n]:n},e.prototype.getChilds=function(t){return this._childs&&this._childs[t]?this._childs[t]:[]},e.prototype.getLength=function(t){return void 0===t&&(t=this._root),this._childs[t]?this._childs[t].length:null},e.prototype.removeAll=function(e){var n;if(e)for(var i=0,o=this._childs[e].slice();i<o.length;i++){var r=o[i];this.remove(r.id)}else{t.prototype.removeAll.call(this);var s=this._root;this._initChilds=null,this._childs=((n={})[s]=[],n)}},e.prototype.getIndex=function(t){var e=this.getParent(t);return e&&this._childs[e]?r.findIndex(this._childs[e],function(e){return e.id===t}):-1},e.prototype.sort=function(t){var e=this._childs;for(var n in e)this._sort.sort(e[n],t);this.events.fire(c.DataEvents.change)},e.prototype.map=function(t,e,n){void 0===e&&(e=this._root),void 0===n&&(n=!0);var i=[];if(!this.haveChilds(e))return i;for(var o=0;o<this._childs[e].length;o++)if(i.push(t.call(this,this._childs[e][o],o)),n){var r=this.map(t,this._childs[e][o].id,n);i=i.concat(r)}return i},e.prototype.filter=function(t){if(t){this._initChilds||(this._initChilds=this._childs),t.type=t.type||c.TreeFilterType.all;var e={};this._recursiveFilter(t,this._root,0,e),this._childs=e,this.events.fire(c.DataEvents.change)}else this.restoreOrder()},e.prototype.restoreOrder=function(){this._initChilds&&(this._childs=this._initChilds,this._initChilds=null),this.events.fire(c.DataEvents.change)},e.prototype.copy=function(t,n,i,s){if(void 0===i&&(i=this),void 0===s&&(s=this._root),!this.exists(t))return null;var a=o({},this._childs)[t];if(i===this&&!this.canCopy(t,s))return null;if(i instanceof e){if(this.exists(t)){var l=o({},this.getItem(t));i.exists(t)?l.id=r.uid():l.id=t,l.parent=s,i.add(l,n),t=l.id}if(a)for(var c=0,u=a;c<u.length;c++){var d=u[c].id,f=this.getIndex(d);this.copy(d,f,i,t)}return t}i.add(this._pull[t])},e.prototype.move=function(t,n,i,o){if(void 0===i&&(i=this),void 0===o&&(o=this._root),!this.exists(t))return null;if(i!==this){if(!(i instanceof e))return i.add(this._pull[t]),void this.remove(t);var r=this.copy(t,n,i,o);return this.remove(t),r}if(!this.canCopy(t,o))return null;var s=this.getParent(t),a=this.getIndex(t),l=this._childs[s].splice(a,1)[0];return l.parent=o,this._childs[s].length||delete this._childs[s],this.haveChilds(o)||(this._childs[o]=[]),-1===n?n=this._childs[o].push(l):this._childs[o].splice(n,0,l),this.events.fire(c.DataEvents.change),t},e.prototype.eachChild=function(t,e,n){if(void 0===n&&(n=!0),this.haveChilds(t))for(var i=0;i<this._childs[t].length;i++)e.call(this,this._childs[t][i],i),n&&!1!==this.getItem(this._childs[t][i].id).$opened&&this.eachChild(this._childs[t][i].id,e,n)},e.prototype.getNearId=function(t){return t},e.prototype.loadChilds=function(t,e){var n=this;void 0===e&&(e="json");var i=this.config.autoload+"?id="+t;new a.DataProxy(i).load().then(function(i){i=(e=l.toDataDriver(e)).toJsonArray(i),n._parse_data(i,t),n.events.fire(c.DataEvents.change)})},e.prototype.refreshChilds=function(t,e){void 0===e&&(e="json"),this.removeAll(t),this.loadChilds(t,e)},e.prototype.eachParent=function(t,e,n){void 0===n&&(n=!1);var i=this.getItem(t);if(i&&(n&&e.call(this,i),i.parent!==this._root)){var o=this.getItem(i.parent);e.call(this,o),this.eachParent(i.parent,e)}},e.prototype.haveChilds=function(t){return t in this._childs},e.prototype.canCopy=function(t,e){if(t===e)return!1;var n=!0;return this.eachParent(e,function(e){return e.id===t?n=!1:null}),n},e.prototype.serialize=function(t){return this._serialize(this._root,t)},e.prototype.getId=function(t,e){if(void 0===e&&(e=this._root),this._childs[e]&&this._childs[e][t])return this._childs[e][t].id},e.prototype._removeAll=function(e){var n;if(e)for(var i=0,o=this._childs[e].slice();i<o.length;i++){var r=o[i];this.remove(r.id)}else{t.prototype._removeAll.call(this);var s=this._root;this._initChilds=null,this._childs=((n={})[s]=[],n)}},e.prototype._removeCore=function(t){if(this._pull[t]){var e=this.getParent(t);this._childs[e]=this._childs[e].filter(function(e){return e.id!==t}),e===this._root||this._childs[e].length||delete this._childs[e],this._initChilds&&this._initChilds[e]&&(this._initChilds[e]=this._initChilds[e].filter(function(e){return e.id!==t}),e===this._root||this._initChilds[e].length||delete this._initChilds[e]),this._fastDeleteChilds(this._childs,t),this._initChilds&&this._fastDeleteChilds(this._initChilds,t)}},e.prototype._addToOrder=function(t,e,n){var i=this._childs,o=this._initChilds,r=e.parent;this._pull[e.id]=e,u(i,e,r,n),o&&u(o,e,r,n)},e.prototype._parse_data=function(t,e){void 0===e&&(e=this._root);for(var n=0,i=t;n<i.length;n++){var o=i[n];this.config.init&&(o=this.config.init(o)),"object"!=typeof o&&(o={value:o}),o.id=o.id?o.id.toString():r.uid(),o.parent=o.parent?o.parent.toString():e,this._pull[o.id]=o,this._childs[o.parent]||(this._childs[o.parent]=[]),this._childs[o.parent].push(o),o.childs&&o.childs instanceof Object&&this._parse_data(o.childs,o.id)}},e.prototype._fastDeleteChilds=function(t,e){if(this._pull[e]&&delete this._pull[e],t[e]){for(var n=0;n<t[e].length;n++)this._fastDeleteChilds(t,t[e][n].id);delete t[e]}},e.prototype._recursiveFilter=function(t,e,n,i){var o=this,r=this._childs[e];if(r){var s=function(e){switch(t.type){case c.TreeFilterType.all:return!0;case c.TreeFilterType.specific:return n===t.specific;case c.TreeFilterType.leafs:return!o.haveChilds(e.id)}};if(t.by&&t.match){var a=function(e){return!s(e)||-1!==e[t.by].toString().toLowerCase().indexOf(t.match.toString().toLowerCase())};i[e]=r.filter(a)}else if(t.rule&&"function"==typeof t.rule){a=function(e){return!s(e)||t.rule(e)};var l=r.filter(a);l.length&&(i[e]=l)}for(var u=0,d=r;u<d.length;u++){var f=d[u];this._recursiveFilter(t,f.id,n+1,i)}}},e.prototype._serialize=function(t,e){var n=this;return void 0===t&&(t=this._root),this.map(function(t){var i={};for(var o in t)"parent"!==o&&"childs"!==o&&(i[o]=t[o]);return e&&(i=e(i)),n.haveChilds(t.id)&&(i.childs=n._serialize(t.id,e)),i},t,!1)},e}(s.DataCollection);e.TreeCollection=d},function(t,e,n){"use strict";function i(t,e){t[e]&&("string"==typeof t[e]?t[e]=[{text:""+t[e]}]:t[e]=t[e].map(function(t){return"string"==typeof t&&(t={text:t}),t}))}Object.defineProperty(e,"__esModule",{value:!0}),e.normalizeColumns=function(t){for(var e=0,n=t;e<n.length;e++){var o=n[e];o.$cellCss=o.$cellCss||{},i(o,"header"),i(o,"footer"),o.width=o.width||100}},e.countColumns=function(t,e){var n=0,i=0,o=!1,r=0,s=!1;return e.map(function(t){if(n=Math.max(n,t.header.length),i+=t.width,t.footer&&!s&&(s=!0),!o)for(var e=0,r=t.header;e<r.length;e++)if(r[e].colspan)return void(o=!0)}),e.map(function(t){if(t.header.length<n)for(var e=0;e<n;e++)t.header[e]=t.header[e]||{text:""};t.header.map(function(t){t.css=t.css||"",t.text||/dhx_cell_empty/.test(t.css)||(t.css+=" dhx_cell_empty")}),""===t.header[0].text&&r++}),t.$totalWidth=i,t.$headerLevel=n,t.$colspans=o,t.$footer=s,r},e.calculatePositions=function(t,e,n,i){for(var o=i.$totalWidth/i.columns.length,r=Math.round(t/o),s=Math.round(e/i.rowHeight),a=Math.round(n.top/i.rowHeight)||0,l=a-1>=0?a-1:0,c=a+s+1,u=0,d=n.left,f=0;f<i.columns.length&&(d-=i.columns[f].width)+o/2>0;f++)u++;return{xStart:u-1>=0?u-1:0,xEnd:u+r+1,yStart:l,yEnd:c}},e.getUnique=function(t,e){return t.filter(function(t,n,i){return n===i.reduce(function(n,i,o){return i[e]===t[e]?o:n},-1)}).sort(function(t,n){return t[e]>n[e]?1:-1})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(17);function r(t,e,n,i){t.fire(o.GridEvents.headerInput,[i.target.value,e,n])}function s(t,e,n){var i=t.id,o=e.data.map(function(t){return parseFloat(t[i])||0}),r=o;return"tree"===e.type&&(r=e.data.reduce(function(t,e){return 0===e.$level&&t.push(parseFloat(e[i])||0),t},[])),n(o,r)}e.content={inputFilter:{toHtml:function(t,e){return i.el("input",{type:"text",class:"dhx_grid_filter",oninput:[r,e.events,t.id,"inputFilter"],style:{width:t.width-20},_key:t.id})},match:function(t,e){return new RegExp("^"+e,"i").test(t)}},selectFilter:{toHtml:function(t,e){return i.el("select",{type:"text",class:"dhx_grid_filter",oninput:[r,e.events,t.id,"selectFilter"],style:{width:t.width-20},_key:t.id},[i.el("option",{value:""},"")].concat(t.$uniqueData.map(function(e){return i.el("option",{value:e[t.id]},e[t.id])})))},match:function(t,e){return t===e}},sum:{calculate:function(t,e){return e.reduce(function(t,e){return t+(parseFloat(e)||0)},0).toFixed(3)},toHtml:function(t,e){return s(t,e,this.calculate)}},avg:{calculate:function(t,e){return(e.reduce(function(t,e){return t+e},0)/t.length).toFixed(3)},toHtml:function(t,e){return s(t,e,this.calculate)}},min:{calculate:function(t){return Math.min.apply(Math,t).toFixed(3)},toHtml:function(t,e){return s(t,e,this.calculate)}},max:{calculate:function(t){return Math.max.apply(Math,t).toFixed(3)},toHtml:function(t,e){return s(t,e,this.calculate)}},count:{calculate:function(t,e){return e.reduce(function(t,e){return t+e},0)},toHtml:function(t,e){return s(t,e,this.calculate)}}}},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),r=n(0),s=n(3),a=n(25),l=n(7),c=n(18),u=n(22),d=function(t){function e(e,n){var i=t.call(this,e,o.extend({navigationType:"click"},n))||this;i._currentRoot=null,i._factory=u.createFactory(l.ItemType.button);return i.mount(e,r.create({render:function(){return i._draw()}})),i}return i(e,t),e.prototype.getValues=function(){var t={};for(var e in this.data.eachChild(this.data.getRoot(),function(e){e.twoState?t[e.id]=e.active:e.type===l.ItemType.input&&(t[e.id]=e.value)},!1),this._groups)this._groups[e].active&&(t[e]=this._groups[e].active);return t},e.prototype.setValues=function(t){for(var e in t){if(this._groups[e])this._groups[e].active&&(this.data.update(this._groups[e].active,{active:!1}),this._groups[e].active=t[e],this.data.update(t[e],{active:!0}));else this.data.getItem(e).type===l.ItemType.input?this.data.update(e,{value:t[e]}):this.data.update(e,{active:t[e]})}},e.prototype._initHandlers=function(){var e=this;t.prototype._initHandlers.call(this),this._onInput=function(t){var n=s.locate(t);e.data.update(n,{value:t.target.value})},this._showTooltip=function(t){var n=s.locateNode(t);if(n){var i=n.getAttribute("dhx_id"),o=e.data.getItem(i);o.tooltip&&a.tooltip(o.tooltip,{node:n,position:a.Position.bottom})}}},e.prototype._draw=function(){var t=this;return r.el(".toolbar.dhx_widget"+(this.config.css?"."+this.config.css:""),{dhx_widget_id:this._uid,onclick:this._handlers.onclick,oninput:this._onInput,onmouseover:this._showTooltip},this.data.map(function(e){return t._factory(e,t.events)},this.data.getRoot(),!1))},e.prototype._getMode=function(t,e){return t.id===e?"bottom":"right"},e.prototype._close=function(){this._activeMenu=null,this._activePosition=null,this._currentRoot=null,this.paint()},e.prototype._normalizeData=function(){var t=this,e=this.data.getRoot(),n={};this.data.eachChild(e,function(i){i.type!==l.ItemType.menuItem&&i.type!==l.ItemType.selectButton||t.data.haveChilds(i.id)&&(t.data.eachChild(i.id,function(t){return t.type=t.type||l.ItemType.menuItem},!1),i.parent!==e?i.$openIcon="right":i.$openIcon="bot"),i.group&&c.addInGroups(n,i)},!0),this._groups=n},e.prototype._setRoot=function(t){this.data.getParent(t)===this.data.getRoot()&&(this._currentRoot=t)},e}(n(23).MenuBase);e.Toolbar=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(38);e.css=i.cssManager;var o=n(8),r=n(25);e.message=r.message;var s=window.dhx=window.dhx||{};e.i18n=s.i18n||{},e.i18n.setLocale=function(t,n){var i=e.i18n[t];for(var o in n)i[o]=n[o]},e.i18n.spreadsheet=e.i18n.spreadsheet||o.default,s.css=s.css||i.cssManager,n(45);var a=n(48);e.Spreadsheet=a.Spreadsheet},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=function(){function t(){this._classes={};var t=document.createElement("style");t.id="dhx_generated_styles",this._styleCont=document.head.appendChild(t)}return t.prototype.update=function(){document.head.appendChild(this._styleCont),this._styleCont.innerHTML=this._generateCss()},t.prototype.remove=function(t){delete this._classes[t],this.update()},t.prototype.add=function(t,e,n){void 0===n&&(n=!1);var i=this._toCssString(t),o=this._findSameClassId(i);return o||this._addNewClass(i,e,n)},t.prototype.get=function(t){if(this._classes[t]){for(var e={},n=0,i=this._classes[t].split(";");n<i.length;n++){var o=i[n];if(o){var r=o.split(":");e[r[0]]=r[1]}}return e}return null},t.prototype._findSameClassId=function(t){for(var e in this._classes)if(t===this._classes[e])return e;return null},t.prototype._addNewClass=function(t,e,n){var o=e||"dhx_generated_class_"+i.uid();return this._classes[o]=t,n||this.update(),o},t.prototype._toCssString=function(t){var e="";for(var n in t){var i=t[n];e+=n.replace(/[A-Z]{1}/g,function(t){return"-"+t.toLowerCase()})+":"+i+";"}return e},t.prototype._generateCss=function(){var t="";for(var e in this._classes){t+="."+e+"{"+this._classes[e]+"}\n"}return t},t}();e.CssManager=o,e.cssManager=new o},function(t,e){if(Element&&!Element.prototype.matches){var n=Element.prototype;n.matches=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector}},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=n(44);function o(t){var e=document.activeElement;e.classList.contains("apply-button")||e.classList.contains("reject-button")||t.preventDefault()}function r(t){var e=document.createElement("div");return e.className="dhx-blocker "+(t||""),document.body.appendChild(e),document.addEventListener("keydown",o),function(){document.body.removeChild(e),document.removeEventListener("keydown",o)}}e.blockScreen=r,e.alert=function(e){var n=e.buttons&&e.buttons[0]?e.buttons[0]:i.default.apply,o=r(e.blockerCss);return new t(function(t){var i=document.createElement("div");i.className="dhx-alert "+(e.css||""),i.innerHTML='\n\t\t\t<div class="message-box-header">\n\t\t\t\t<div class="mesage-box-title">'+e.header+'</div>\n\t\t\t</div>\n\t\t\t<div class="alert-message">'+e.text+'</div>\n\t\t\t<div class="action-button '+(e.buttonsAlignment?e.buttonsAlignment:"")+'">\n\t\t\t\t<button class="apply-button alert-btn dhx_btn dhx_btn--flat">'+n+"</button>\n\t\t\t</div>",document.body.appendChild(i),i.querySelector(".apply-button").focus(),i.querySelector("button").addEventListener("click",function(){o(),document.body.removeChild(i),t(!0)})})},e.confirm=function(e){var n=e.buttons&&e.buttons[1]?e.buttons[1]:i.default.apply,o=e.buttons&&e.buttons[0]?e.buttons[0]:i.default.reject,s=r(e.blockerCss);return new t(function(t){var i=document.createElement("div");i.className="dhx-confirm "+(e.css||""),i.innerHTML='\n\t\t\t<div class="message-box-header">\n\t\t\t\t<div class="mesage-box-title">'+e.header+'</div>\n\t\t\t</div>\n\t\t\t<div class="confirm-message">'+e.text+'</div>\n\t\t\t<div class="action-button '+(e.buttonsAlignment?e.buttonsAlignment:"")+'">\n\t\t\t\t<button class="reject-button dhx_btn dhx_btn--link">'+o+'</button>\n\t\t\t\t<button class="apply-button dhx_btn dhx_btn--flat">'+n+"</button>\n\t\t\t</div>",document.body.appendChild(i),i.querySelector(".reject-button").focus();var r=function(e){"BUTTON"===e.target.tagName&&function(e){s(),i.removeEventListener("click",r),document.body.removeChild(i),t(e)}(e.target.classList.contains("apply-button"))};i.addEventListener("click",r)})}}).call(this,n(20))},function(t,e,n){var i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(42),e.setImmediate=setImmediate,e.clearImmediate=clearImmediate},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var i,o=1,r={},s=!1,a=t.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(t);l=l&&l.setTimeout?l:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick(function(){u(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&u(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),i=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){u(t.data)},i=function(e){t.port2.postMessage(e)}}():a&&"onreadystatechange"in a.createElement("script")?function(){var t=a.documentElement;i=function(e){var n=a.createElement("script");n.onreadystatechange=function(){u(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():i=function(t){setTimeout(u,0,t)},l.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var s={callback:t,args:e};return r[o]=s,i(o),o++},l.clearImmediate=c}function c(t){delete r[t]}function u(t){if(s)setTimeout(u,0,t);else{var e=r[t];if(e){s=!0;try{!function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(n,i)}}(e)}finally{c(t),s=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(28),n(43))},function(t,e){var n,i,o=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(t){n=r}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}}();var l,c=[],u=!1,d=-1;function f(){u&&l&&(u=!1,l.length?c=l.concat(c):d=-1,c.length&&h())}function h(){if(!u){var t=a(f);u=!0;for(var e=c.length;e;){for(l=c,c=[];++d<e;)l&&l[d].run();d=-1,e=c.length}l=null,u=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||u||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={apply:"apply",reject:"reject"}},function(t,e,n){},,,function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),r=n(29),s=n(61),a=n(21),l=n(79),c=n(0),u=n(6),d=n(3),f=n(10),h=n(19),p=n(97),g=n(98),v=n(99),_=n(100),y=n(14),m=n(101),w=n(102),C=n(1),x=n(24),b=n(103),k=n(8),S=n(106),I=n(5),E=function(t){function e(e,n){var i=t.call(this,e,n)||this;i.container=d.toNode(e),i._sizes={rowsCount:1e3,colsCount:200},i.config=C.extendConfig({rowsCount:{validate:function(t){return t>=0},default:1e3},colsCount:{validate:function(t){return t>=0},default:25},menu:{validate:function(t){return"boolean"==typeof t},default:!1},editLine:{validate:function(t){return"boolean"==typeof t},default:!0},readonly:{validate:function(t){return"boolean"==typeof t},default:!1}},i.config),i.events=new u.EventSystem,i._initLayout(),i._colorPicker=new l.Colorpicker,i._setEventsHandlers(),i._actionsManager=new h.ActionsManager({spreadsheet:i,editLine:i._editLine,grid:i._grid}),i._buffer=new m.BufferManager(i,i._grid,i._callAction),i.selection=new S.Selection(i,i._grid,i._buffer);var o=i._grid.getRootView();return o.hooks=o.hooks||{},o.hooks.didMount=function(t){i.config.readonly||t.node.el.addEventListener("contextmenu",function(t){i.contextMenu.data.update("lock",{value:i.isLocked(i.selection.getSelectedCell())?k.default.unlockCell:k.default.lockCell}),i.contextMenu.showAt(t),t.preventDefault()}),o.hooks.didRedraw=function(t){i.events.fire(I.SpreadsheetEvents.gridRedraw,[t])}},i._generateGridStruct(),b.initHotkeys(i,i._grid,i._buffer),i.selection.setSelectedCell("A1"),i}return i(e,t),e.prototype.destructor=function(){this._layout.getRootView().unmount(),this.contextMenu.destructor(),this.menu.destructor(),this.toolbar.destructor()},e.prototype.paint=function(){this.config.rowsCount===this._sizes.rowsCount&&this.config.colsCount===this._sizes.colsCount||this._generateGridStruct(),this._layout.paint(),this._grid.paint()},e.prototype.load=function(t,e){var n=this;return f.toProxy(t).load().then(function(t){n.parse(t,e)})},e.prototype.parse=function(t,e){var n;if("csv"===e&&(e=new w.CustomCsvDriver),t=f.toDataDriver(e||"json").toJsonArray(t),this._grid.data.map(function(t){for(var e in t)"id"!==e&&"$index"!==e&&(t[e]="")}),"styles"in t){var i=t.styles;for(var o in i){var r=i[o];dhx.css.add(r,o)}t=t.data}this._updateGridSizes(t);for(var s=0,a=t;s<a.length;s++){var l=a[s],c=C.getCellIds(this._grid,l.cell);this._grid.data.update(c.row,((n={})[c.col]=l.value,n),!0),l.css&&(this._grid.addCellCss(c.row,c.col,l.css),C.updateCellInfo(this._grid,l.cell.toUpperCase(),{css:l.css}))}this._grid.data.events.fire(f.DataEvents.change),this.selection.setSelectedCell("A1")},


    e.prototype._getCells=function(){

        var t=this,
            e=[],
            n={};

        return this._grid.data.map( function(i) {

            var arr = { index : i.id, column : [] };

            if(t._grid.config.columns.slice(1).some(function(t){return i[t.id]}))

                for(var o in i)

                    if("id" !== o && "$index" !==o)
                    {
                        var r=C.getCellNameById(t._grid,i.id,o),
                            s=i[o],
                            a={cell:r};

                        a['id'] = i.id;
                        a['index'] = i.$index;

                        if(o === "$info" || o === "$css")
                        {
                            continue;
                        }

                        i.$info &&
                        i.$info[o] &&
                        i.$info[o].css &&
                        (a.css = i.$info[o].css, n[a.css]= dhx.css.get(a.css)),

                            arr.column.push({
                                index : o,
                                value : i[o],
                                css : a.css || "",
                                cssVal : n[a.css] || {},
                                id : r
                            })

                    }

                    return arr;

        })


    },

    e.prototype.serialize=function(){

    var t=this,
        e=[],
        n={};

    return this._grid.data.map( function(i) {


        if(t._grid.config.columns.slice(1).some(function(t){return i[t.id]}))

            for(var o in i)

                if("id" !== o && "$index" !==o)
                {
                    var r=C.getCellNameById(t._grid,i.id,o),
                        s=i[o],
                        a={cell:r};

                    a['id'] = i.id;
                    a['index'] = i.$index;

                    i.$info &&
                    i.$info[o] &&
                    i.$info[o].css &&

                    (a.css = i.$info[o].css, n[a.css]= dhx.css.get(a.css)),


                    s&&(a.value=s),
                    r&&(a.value||a.css) && e.push(a)


        }

    }),Object.keys(n).length>0?{data:e,styles:n}:e


}


,e.prototype.setValue=function(t,e){if(t&&(this._checkForMissedCells(t),this.events.fire(I.SpreadsheetEvents.beforeValueChange,[t,e]))){var n=C.getCellIds(this._grid,t);this._callAction({row:n.row,col:n.col,cell:t,val:e,action:I.Actions.setCellValue,groupAction:I.Actions.groupAction}),this._grid.paint(),this.events.fire(I.SpreadsheetEvents.afterValueChange,[t,e])}},e.prototype.getValue=function(t){if(t){if(t=t.toUpperCase(),C.isRangeId(t)){var e=[];return this.eachCell(function(t,n){e.push(n)},t),e}var n=C.getCellIds(this._grid,t),i=this._grid.data.getItem(n.row);return i?i[n.col]:void 0}},e.prototype.eachCell=function(t,e){e=e||this.selection.getSelectedCell();for(var n=0,i=C.getCellsArray(e);n<i.length;n++){var o=i[n],r=C.getCellIds(this._grid,o),s=r.row,a=r.col,l=this._grid.data.getItem(s),c=l?l[a]:null;void 0!==c&&t(o,c)}},e.prototype.getStyle=function(t){var e=this;if(t){if(C.isRangeId(t)){var n=[];return this.eachCell(function(t){n.push(e.getStyle(t)||{})},t),n}var i=C.getCellInfo(this._grid,t);return dhx.css.get(i.css)}},e.prototype.setStyle=function(t,e){if(t&&e&&this.events.fire(I.SpreadsheetEvents.beforeStyleChange,[t,e])){var n=C.getCellIds(this._grid,t),i=n.row,o=n.col;Object.keys(e).length?this._callAction({val:e,row:i,col:o,cell:t,action:I.Actions.setCellStyle,groupAction:I.Actions.groupAction}):this._callAction({row:i,col:o,cell:t,action:I.Actions.removeCellStyles,groupAction:I.Actions.groupAction})}},e.prototype.isLocked=function(t){var e=this;if("start"in C.getCellIds(this._grid,t)){var n=!1;return this.eachCell(function(t){if(!n){var i=C.getCellInfo(e._grid,t).locked;n=i}},t),n}return!!C.getCellInfo(this._grid,t).locked},e.prototype.lock=function(t){var e=C.getCellIds(this._grid,t);this._callAction({row:e.row,col:e.col,val:!0,cell:t,action:I.Actions.lockCell,groupAction:I.Actions.groupAction}),this._grid.paint()},e.prototype.unlock=function(t){var e=C.getCellIds(this._grid,t);this._callAction({row:e.row,col:e.col,val:!1,cell:t,action:I.Actions.lockCell,groupAction:I.Actions.groupAction}),this._grid.paint()},e.prototype.addRow=function(t){this.events.fire(I.SpreadsheetEvents.beforeRowAdd,[t])&&(this._callAction({cell:t,action:I.Actions.addRow,groupAction:I.Actions.groupRowAction}),this.events.fire(I.SpreadsheetEvents.afterRowAdd,[t]))},e.prototype.deleteRow=function(t){if(this.events.fire(I.SpreadsheetEvents.beforeRowDelete,[t])){var e=C.getCellIds(this._grid,t);this._callAction({row:e.row,col:e.col,cell:t,action:I.Actions.deleteRow,groupAction:I.Actions.groupRowAction}),this.events.fire(I.SpreadsheetEvents.afterRowDelete,[t])}},e.prototype.addColumn=function(t){this.events.fire(I.SpreadsheetEvents.beforeColumnAdd,[t])&&(this._callAction({cell:t,action:I.Actions.addColumn,groupAction:I.Actions.groupColAction}),this.events.fire(I.SpreadsheetEvents.afterColumnAdd,[t]))},e.prototype.deleteColumn=function(t){this.events.fire(I.SpreadsheetEvents.beforeColumnDelete,[t])&&(this._callAction({cell:t,action:I.Actions.deleteColumn,groupAction:I.Actions.groupColAction}),this.events.fire(I.SpreadsheetEvents.afterColumnDelete,[t]))},e.prototype.undo=function(){this._actionsManager.undo()},e.prototype.redo=function(){this._actionsManager.redo()},e.prototype.startEdit=function(t,e){if(!this.config.readonly){var n=this.selection.getFocusedCell();if(t||(t=n),t=t.toUpperCase(),this._checkForMissedCells(t),this.events.fire(I.SpreadsheetEvents.beforeEditStart,[t,e]))if(!this.isLocked(t))n!==t&&(this.endEdit(!0),this.selection.setSelectedCell(t)),C.getCellInfo(this._grid,t).edited||(C.updateCellInfo(this._grid,t,{edited:!0,nextValue:e}),this.events.fire(I.SpreadsheetEvents.afterEditStart,[t,e]))}},e.prototype.endEdit=function(t){var e=this.selection.getFocusedCell(),n=C.getCellInfo(this._grid,e);if(n.edited){if(!this.events.fire(I.SpreadsheetEvents.beforeEditEnd,[e,n.nextValue]))return;t||void 0===n.nextValue||this.setValue(e,n.nextValue),n.edited=!1,n.nextValue=void 0,this._editLine.setValue(this.getValue(e)),this._editLine.blur(),this.events.fire(I.SpreadsheetEvents.afterEditEnd,[e,n.nextValue])}},e.prototype._callAction=function(t){t&&!this.config.readonly&&(Array.isArray(t)?this._actionsManager.execute(t):C.isRangeId(t.cell)?this._actionsManager.execute(t.groupAction,t):this._actionsManager.execute(t.action,t))},e.prototype._initLayout=function(){this._grid=new r.Grid(null,{rowHeight:32,width:100,height:100,headerRowHeight:32,disableHeaderSort:!0,splitAt:1}),this.menu=new a.Menu(null,{navigationType:"click"}),this.menu.data.parse(g.getMenuStruct()),this.toolbar=new a.Toolbar;var t=v.getToolbarStruct(this.config.toolbarBlocks);this.toolbar.data.parse(t),this.contextMenu=new a.ContextMenu,this.contextMenu.data.parse(p.getContextMenuStruct()),this._editLine=new _.EditLine(null,{events:this.events});var e=this._layout=new s.Layout(this.container,{height:"100%",rows:[{id:"menu",css:"menu_wrapper"},{id:"toolbar",css:"toolbar_wrapper"},{id:"editLine",css:"editLine_wrapper"},{id:"grid",css:"dhx-spreadsheet-grid"}],css:"dhx-spreadsheet"});e.cell("menu").attach(this.menu,this),e.cell("toolbar").attach(this.toolbar,this),e.cell("grid").attach(this._grid,this),e.cell("editLine").attach(this._editLine,this),this.config.editLine&&!this.config.readonly||e.cell("editLine").hide(),this.config.menu&&!this.config.readonly||e.cell("menu").hide(),!this.config.readonly&&t&&t.length||e.cell("toolbar").hide()},e.prototype._generateGridStruct=function(){var t=this,e=this.serialize(),n=this.config,i=n.rowsCount,o=n.colsCount;(i>7e4||o>200)&&(this.config.rowsCount=Math.min(this.config.rowsCount,7e4),this.config.colsCount=Math.min(this.config.colsCount,200));for(var r=[],s=1;s<=i;s++){for(var a={id:""+s,$index:s},l=1;l<=o;l++)a[l]="";r.push(a)}var u,d,f=[{id:"$index",width:40,header:[{text:""}],template:function(e,n){return t._grid.data.getIndex(n.id)+1}}],h=!1,p=function(e){requestAnimationFrame(function(){h&&t._restoreFocus(e)})},g=function(e){var n=e.el;n.focus(),n.setSelectionRange(n.value.length,n.value.length),n.addEventListener("blur",p),t._editLine.setValue(n.value),h=!0},v=function(){h=!1,document.removeEventListener("blur",p)},_=function(e,n){h&&t.events.fire(I.SpreadsheetEvents.cellInput,[e,n.target.value])};this.events.on(I.SpreadsheetEvents.gridRedraw,function(){u=null,d=null});var m=function(e,n,i){u||(u=t.selection.getFocusedCell(),d=C.getCellsArray(t.selection.getSelectedCell()));var o=function(t){return n.$info&&n.$info[i.id]&&n.$info[i.id][t]},r=o("locked"),s=o("edited"),a=o("nextValue"),l=o("css"),f=i.$letter+n.$index,h=void 0===a||null===a?e:a;return u&&s?c.el("input.dhx_cell_input",{oninput:[_,f],_hooks:{didInsert:g,didRemove:v},class:l,_key:"selection_input",dhx_id:"cell_input",value:h}):c.el(".dhx_spreadsheet_cell.dhx_noselect",[r&&c.el(".dhx_lock_icon.dxi.dxi-key"),u===f&&d.length<=1&&c.el(".dhx_selection_grip",{dhx_id:"selection_grip"}),d&&d.length>1&&d.indexOf(f)===d.length-1&&c.el(".dhx_selection_grip",{dhx_id:"selection_grip"}),h])};for(s=1;s<=o;s++){var w=C.getLetterFromNumber(s);f.push({id:""+s,width:120,$letter:w,header:[{text:y.getHeaderCell(w,s)}],template:m})}this._grid.setHeader(f),this._grid.data.parse(r),this.parse(e),this._sizes.rowsCount=this.config.rowsCount,this._sizes.colsCount=this.config.colsCount},e.prototype._checkForMissedCells=function(t){var e=C.isRangeId(t)?C.getRangeIndexes(t).end:C.getCellIndex(t);(e.row>this.config.rowsCount||e.col>this.config.colsCount)&&(this.config.rowsCount=Math.max(this.config.rowsCount,e.row+1),this.config.colsCount=Math.max(this.config.colsCount,e.col),this._generateGridStruct())},e.prototype._updateGridSizes=function(t){var e=t.reduce(function(t,e){var n=C.getCellIndex(e.cell);return t.row=Math.max(t.row,n.row+1),t.col=Math.max(t.col,n.col),t},{row:this.config.rowsCount,col:this.config.colsCount});(e.row>this.config.rowsCount||e.col>this.config.colsCount)&&(this.config.rowsCount=Math.max(e.row+1,this.config.rowsCount),this.config.colsCount=Math.max(e.col+1,this.config.colsCount),this._generateGridStruct())},e.prototype._setEventsHandlers=function(){var t=this;this.events.on(I.SpreadsheetEvents.editLineInput,function(e){var n=t.selection.getFocusedCell();t.events.fire(I.SpreadsheetEvents.cellInput,[n,e])}),this.events.on(I.SpreadsheetEvents.editLineFocus,function(){var e=t.selection.getFocusedCell();t.startEdit(e),requestAnimationFrame(function(){t._editLine.focus()})}),this.events.on(I.SpreadsheetEvents.cellInput,function(e,n){t.isLocked(e)||(C.updateCellInfo(t._grid,e,{nextValue:n}),t._grid.paint())}),this._grid.events.on(r.GridEvents.cellMouseDown,function(){t.contextMenu._close()}),this.events.on(I.SpreadsheetEvents.beforeSelectionSet,function(){if(t.config.readonly)return!1;t.endEdit()}),this.events.on(I.SpreadsheetEvents.afterSelectionSet,function(){t._grid.paint()}),this.events.on(I.SpreadsheetEvents.afterFocusSet,function(e){var n=t.getValue(e),i=C.getCellInfo(t._grid,e);x.updateToolbar(t.toolbar,i),t._editLine.setValue(n),i.locked&&t._editLine.lock(),t._grid.paint()}),this.events.on(I.SpreadsheetEvents.afterStyleChange,function(e){if(e===t.selection.getFocusedCell()){var n=C.getCellInfo(t._grid,e);x.updateToolbar(t.toolbar,n)}}),this.events.on(I.SpreadsheetEvents.afterEditStart,function(){t._grid.paint()}),this.events.on(I.SpreadsheetEvents.afterEditEnd,function(){t._grid.paint()}),this.toolbar.events.on(a.ToolbarEvents.click,function(e,n){t._handleAction(e,n)}),this.contextMenu.events.on(a.ToolbarEvents.click,function(e,n){t._handleAction(e,n)}),this.menu.events.on(a.ToolbarEvents.click,function(e,n){t._handleAction(e,n)}),this._colorPicker.attachEvent(l.ColorpickerEvents.colorChange,function(e){var n,i=t.selection.getSelectedCell();t.setStyle(i,((n={})[t._colorpickerTarget]=e,n)),requestAnimationFrame(function(){t._colorpickerTarget=null,b.focusHandler.setFocusState(!0),t._activeInput&&(t._activeInput.focus(),t._activeInput=null)})}),this.events.on(I.SpreadsheetEvents.editLineBlur,function(e,n){t._restoreFocus(n)})},e.prototype._handleAction=function(t,e){var n,i=this.selection.getSelectedCell();switch(requestAnimationFrame(function(){b.focusHandler.setFocusState(!0)}),t){case"undo":this._actionsManager.undo();break;case"redo":this._actionsManager.redo();break;case"color":case"background":this._colorpickerTarget=t;var o=C.getCellInfo(this._grid,i),r=(dhx.css.get(o.css)||{})[t]||{background:"#FFFFFF",color:"#4C4C4C"}[t];this._colorPicker.setValue(r);var s=d.locateNode(e,"dhx_id");this._colorPicker.show(s);break;case"align-left":case"align-right":case"align-center":case"align-justify":var a=t.split("-")[1];this.setStyle(i,{"text-align":a});break;case"font-weight-bold":case"font-style-italic":case"text-decoration-underline":var l=t.split("-"),c=l.pop(),u=l.join("-");c=x.getToggledValue(this._grid,i,u,c),this.setStyle(i,((n={})[u]=c,n));break;case"clear-value":this.setValue(i,"");break;case"clear-styles":this.setStyle(i,{});break;case"clear-all":this._callAction([{cell:i,action:I.Actions.setCellStyle,groupAction:C.isRangeId(i)?I.Actions.groupAction:null,val:""},{cell:i,action:I.Actions.setCellValue,groupAction:C.isRangeId(i)?I.Actions.groupAction:null,val:""}]);break;case"lock":if(this.isLocked(i))return void this.unlock(i);this.lock(i);break;case"remove-row":this.deleteRow(i);break;case"add-row":this.addRow(i);break;case"remove-col":this.deleteColumn(i);break;case"add-col":this.addColumn(i);break;case"help":window.open("https://dhtmlx.gitbook.io/spreadsheet-user-guide/")}},e.prototype._restoreFocus=function(t){var e=this._editLine.getRootView().node.el,n=this.selection.getFocusedCell();if(!n||C.getCellInfo(this._grid,n).edited){if(!b.focusHandler.getFocusState())return this._colorpickerTarget?void(this._activeInput=t.target):void this.endEdit();var i=t.target,o=t.relatedTarget;if(!(e.contains(o)||e.contains(i)&&o&&"cell_input"===o.getAttribute("dhx_id"))){var r=i;r.focus(),setTimeout(function(){r.setSelectionRange(r.value.length,r.value.length)},100)}}},e}(o.View);e.Spreadsheet=E},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),s=n(6),a=n(3),l=n(9),c=n(10),u=n(34),d=n(56),f=n(13),h=n(57),p=n(60),g=n(17),v=n(2),_=n(35),y=function(t){function e(e,n){var i=t.call(this,e,n)||this;i._defConfig={rowHeight:40,headerRowHeight:40,columns:[],data:[]},i.content=_.content,i.config=o({},i._defConfig,n),i._scroll={top:0,left:0},i._htmlEvents={onclick:a.eventHandler(function(t){return a.locate(t)},{dhx_grid_header_cell:function(t,e){i.config.disableHeaderSort||i.events.fire(g.GridEvents.sort,[e])},dhx_grid_expand_cell:function(t,e){return i.events.fire(g.GridEvents.expand,[e])}}),onscroll:function(t){i._scroll={top:t.target.scrollTop,left:t.target.scrollLeft},i.paint()}},i._init(),i.config.columns&&i._parseColumns(),i.config.data&&i.config.columns&&i.data.parse(i.config.data);var s=r.create({render:function(t,e){return h.render(t,e,i._currentData)}},i);return i.mount(e,s),i}return i(e,t),e.prototype.destructor=function(){this.getRootView().unmount()},e.prototype.setHeader=function(t){this.config.columns=t,this._parseColumns()},e.prototype.sort=function(t,e){e?this._sortDir=e:this._sortBy===t?this._sortDir="asc"===this._sortDir?"desc":"asc":this._sortDir="desc",this._sortBy=t,this.data.sort({by:t,dir:this._sortDir,as:function(t){return""+t}})},e.prototype.addRowCss=function(t,e){var n=this.data.getItem(t),i=n.$css||"";i.match(new RegExp(e,"g"))||(n.$css=i+" "+e)},e.prototype.removeRowCss=function(t,e){var n=this.data.getItem(t),i=n.$css?n.$css.replace(e,""):"";n.$css=i},e.prototype.addCellCss=function(t,e,n){var i=this._getColumn(e);i&&(i.$cellCss[t]?i.$cellCss[t]+=i.$cellCss[t].match(new RegExp(n,"g"))?"":" "+n:this.data.getItem(t)&&(i.$cellCss[t]=n+" "),this.paint())},e.prototype.removeCellCss=function(t,e,n){var i=this._getColumn(e);i&&(i.$cellCss[t]?(i.$cellCss[t]=i.$cellCss[t].replace(n,""),this.paint()):this.data.getItem(t)&&(i.$cellCss[t]=""))},e.prototype.getScrollState=function(){return{x:this._scroll.left,y:this._scroll.top}},e.prototype.scroll=function(t,e){var n=this.getRootView().refs.grid_body.el;n.scrollLeft="number"==typeof t?t:n.scrollLeft,n.scrollTop="number"==typeof e?e:n.scrollTop},e.prototype.scrollTo=function(t,e){var n=v.findIndex(this.config.columns,function(t){return t.id===e}),i=this.config.splitAt?this.config.columns.slice(0,this.config.splitAt).reduce(function(t,e){return t+e.width},0):0,o=this.config.columns.slice(0,n).reduce(function(t,e){return t+e.width},0)-i,r=this.data.getIndex(t)*this.config.rowHeight,s=this.getScrollState(),a=this.config.width+s.x,l=this.config.height+s.y-this.config.headerRowHeight*this.config.$headerLevel,c=r-s.y-this.config.rowHeight,u=o-s.x-this.config.columns[n].width,d=r+2*this.config.rowHeight+17-l,f=o+2*this.config.columns[n].width+17-a,h=c>0&&d<0?0:c<0?c:d,p=u>0&&f<0?0:u<0?u:f;this.scroll(p+s.x,h+s.y)},e.prototype.adjustColumnWidth=function(t){var e=v.findIndex(this.config.columns,function(e){return e.id===t}),n=this.config.columns[e];this.data.map(function(t){n.maxWidth=n.maxWidth||n.width,n.maxWidth=Math.max(f.getStrWidth(f.removeHTMLTags(t[n.id]))+20,n.maxWidth)}),this.config.$totalWidth=this.config.columns.reduce(function(t,e){return e.width=e.maxWidth||e.width,t+e.width},0),this.paint()},e.prototype._getColumn=function(t){for(var e=0,n=this.config.columns;e<n.length;e++){var i=n[e];if(i.id===t)return i}},e.prototype._init=function(){var t=this;this.events=new s.EventSystem(this),this._attachDataCollection(),this.data.events.on(c.DataEvents.load,function(){t._parseData()}),this.data.events.on(c.DataEvents.change,function()
{
    t._currentData= t.data.map(

        function(t) {

            return t


        }) || [], t._checkMarks(),
    t.config.columnsAutoWidth&&("number"==typeof t.config.columnsAutoWidth?t._setAutoWidth(t.config.columnsAutoWidth):t._setAutoWidth()),t._render()



}

),this.export=new d.Exporter(this),this._setEventHandlers()},e.prototype._setEventHandlers=function(){var t=this;this.events.on(g.GridEvents.sort,function(e){return t.sort(e)}),this.events.on(g.GridEvents.expand,function(e){var n=t.data.getItem(e);t.data.update(e,{$opened:!n.$opened})}),this.events.on(g.GridEvents.headerInput,function(e,n,i){t.data.filter({by:n,match:e,compare:t.content[i].match},{multiple:!0})})},e.prototype._attachDataCollection=function(){var t=this,e=function(e){return e.spans&&(t.config.spans=e.spans,e=e.data),e};"tree"===this.config.type?this.data=new p.TreeGridCollection({prep:e},this.events):this.data=new c.DataCollection({prep:e},this.events)},e.prototype._setMarks=function(t,e){for(var n=this.data.map(function(e){return{id:e.id,data:e[t.id],row:e}}),i=this.data.map(function(e){return e[t.id]}),o=function(n){var o=e(n.data,i,n.row,t);if(o){t.$cellCss=t.$cellCss||{};var r=(t.$cellCss[n.id]||"").split(" ");o.split(" ").map(function(t){-1===r.indexOf(t)&&r.push(t)}),t.$cellCss[n.id]=r.join(" ")}},r=0,s=n;r<s.length;r++){o(s[r])}},e.prototype._checkMarks=function(){var t=this;this.config.columns.map(function(e){var n=e.mark;n&&("function"==typeof n?t._setMarks(e,n):t._setMarks(e,function(t,e){var i=e.filter(function(t){return null!==t}),o=Math.min.apply(Math,i),r=Math.max.apply(Math,i);return n.max&&r===parseFloat(t)?n.max:!(!n.min||o!==parseFloat(t))&&n.min}))})},e.prototype._parseColumns=function(){var t=this.config.columns;u.normalizeColumns(t),u.countColumns(this.config,t),"tree"===this.config.type&&t.length&&this._getTreeHeadersWidth()},e.prototype._setAutoWidth=function(t){var e=this;this.data.map(function(n){e.config.columns.map(function(e,i){if(t&&t<=i)return e;e.maxWidth=e.maxWidth||e.width,e.maxWidth=Math.max(f.getStrWidth(f.removeHTMLTags(n[e.id]))+20,e.maxWidth)})}),this.config.$totalWidth=this.config.columns.reduce(function(t,e){return e.width=e.maxWidth||e.width,t+e.width},0)},e.prototype._detectColsTypes=function(){var t=this.data.getItem(this.data.getId(0));this.config.columns=this.config.columns.map(function(e){if(e.type)return e;var n=parseFloat(t[e.id]),i=isNaN(n)?t[e.id]:n;return e.type=typeof i,e})},e.prototype._parseData=function(){this.data.getId(0)&&(this.config.columns.length&&(this._detectColsTypes(),"tree"===this.config.type&&this._getTreeHeadersWidth()),this._currentData=this.data.serialize()||[]),this._checkFilters(),this._checkMarks(),this._render()},e.prototype._checkFilters=function(){var t=this._currentData;this.config.columns.map(function(e){e.header.map(function(n){n.content&&(e.$uniqueData=u.getUnique(t,e.id))})})},e.prototype._getTreeHeadersWidth=function(){if("getMaxLevel"in this.data){var t=this.data.getMaxLevel(),e=this.config.columns[0],n=45*t,i=0;this.data.map(function(t){i=Math.max(f.getStrWidth(f.removeHTMLTags(""+t[e.id])),i)});var o=Math.max(i+n,e.width);this.config.$totalWidth=this.config.$totalWidth-e.width+o,this.config.columns[0].width=o}},e.prototype._render=function(){this.paint()},e}(l.View);e.Grid=y},function(t,e,n){
/**
* Copyright (c) 2017, Leon Sorokin
* All rights reserved. (MIT Licensed)
*
* domvm.js (DOM ViewModel)
* A thin, fast, dependency-free vdom view layer
* @preserve https://github.com/leeoniya/domvm (v3.2.6, micro build)
*/
t.exports=function(){"use strict";var t=1,e=2,n=3,i=4,o=5,r="undefined"!=typeof window,s=(r?window:{}).requestAnimationFrame,a={};function l(){}var c=Array.isArray;function u(t){return null!=t}function d(t){return null!=t&&t.constructor===Object}function f(t,e,n,i){t.splice.apply(t,[n,i].concat(e))}function h(t){var e=typeof t;return"string"===e||"number"===e}function p(t){return"function"==typeof t}function g(t){for(var e=arguments,n=1;n<e.length;n++)for(var i in e[n])t[i]=e[n][i];return t}function v(t,e){for(var n=[],i=e;i<t.length;i++)n.push(t[i]);return n}function _(t,e){for(var n in t)if(t[n]!==e[n])return!1;return!0}function y(t,e){var n=t.length;if(e.length!==n)return!1;for(var i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function m(t){if(!s)return t;var e,n,i;function o(){e=0,t.apply(n,i)}return function(){n=this,i=arguments,e||(e=s(o))}}function w(t){return"o"===t[0]&&"n"===t[1]}function C(t){return"_"===t[0]}function x(t){return"style"===t}function b(t){t&&t.el&&t.el.offsetHeight}function k(t){return null!=t.node&&null!=t.node.el}function S(t,e){switch(e){case"value":case"checked":case"selected":return!0}return!1}function I(t){for(t=t||a;null==t.vm&&t.parent;)t=t.parent;return t.vm}function E(){}var O=E.prototype={constructor:E,type:null,vm:null,key:null,ref:null,data:null,hooks:null,ns:null,el:null,tag:null,attrs:null,body:null,flags:0,_class:null,_diff:null,_dead:!1,_lis:!1,idx:null,parent:null};function M(t){var n=new E;return n.type=e,n.body=t,n}var A={},D=/\[(\w+)(?:=(\w+))?\]/g,T=1,P=2,j=4,L=8;function R(e,n,i,o){var r=new E;r.type=t,u(o)&&(r.flags=o),r.attrs=n;var s=function(t){var e,n,i,o,r=A[t];if(null==r)for(A[t]=r={tag:(e=t.match(/^[-\w]+/))?e[0]:"div",id:(n=t.match(/#([-\w]+)/))?n[1]:null,class:(i=t.match(/\.([-\w.]+)/))?i[1].replace(/\./g," "):null,attrs:null};o=D.exec(t);)null==r.attrs&&(r.attrs={}),r.attrs[o[1]]=o[2]||"";return r}(e);if(r.tag=s.tag,s.id||s.class||s.attrs){var a=r.attrs||{};if(s.id&&!u(a.id)&&(a.id=s.id),s.class&&(r._class=s.class,a.class=s.class+(u(a.class)?" "+a.class:"")),s.attrs)for(var l in s.attrs)u(a[l])||(a[l]=s.attrs[l]);r.attrs=a}var c=r.attrs;return u(c)&&(u(c._key)&&(r.key=c._key),u(c._ref)&&(r.ref=c._ref),u(c._hooks)&&(r.hooks=c._hooks),u(c._data)&&(r.data=c._data),u(c._flags)&&(r.flags=c._flags),u(r.key)||(u(r.ref)?r.key=r.ref:u(c.id)?r.key=c.id:u(c.name)&&(r.key=c.name+("radio"===c.type||"checkbox"===c.type?c.value:"")))),null!=i&&(r.body=i),r}function H(t,n,r,s){if(t.type!==o&&t.type!==i){t.parent=n,t.idx=r,t.vm=s,null!=t.ref&&function(t,e,n){var i=["refs"].concat(e.split("."));!function(t,e,n){for(var i;i=e.shift();)0===e.length?t[i]=n:t[i]=t=t[i]||{}}(t,i,n)}(I(t),t.ref,t);var a=t.hooks,l=s&&s.hooks;(a&&(a.willRemove||a.didRemove)||l&&(l.willUnmount||l.didUnmount))&&function(t){for(;t=t.parent;)t.flags|=T}(t),c(t.body)&&function(t){for(var n=t.body,i=0;i<n.length;i++){var o=n[i];!1===o||null==o?n.splice(i--,1):c(o)?f(n,o,i--,1):(null==o.type&&(n[i]=o=M(""+o)),o.type===e?null==o.body||""===o.body?n.splice(i--,1):i>0&&n[i-1].type===e?(n[i-1].body+=o.body,n.splice(i--,1)):H(o,t,i,null):H(o,t,i,null))}}(t)}}var F={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,order:!0,lineClamp:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function B(t,e){return isNaN(e)||F[t]?e:e+"px"}function V(t,e){var n=(t.attrs||a).style,i=e?(e.attrs||a).style:null;if(null==n||h(n))t.el.style.cssText=n;else{for(var o in n){var r=n[o];(null==i||null!=r&&r!==i[o])&&(t.el.style[o]=B(o,r))}if(i)for(var s in i)null==n[s]&&(t.el.style[s]="")}}var $=[];function N(t,e,n,i,o){if(null!=t){var r=n.hooks[e];if(r){if("d"!==e[0]||"i"!==e[1]||"d"!==e[2])return r(n,i);o?b(n.parent)&&r(n,i):$.push([r,n,i])}}}function z(t){var e;if($.length)for(b(t.node);e=$.shift();)e[0](e[1],e[2])}var G=r?document:null;function W(t){return t.nextSibling}function X(t,e,n){var i=e._node,o=i.vm;if(c(i.body))if((i.flags&T)===T)for(var r=0;r<i.body.length;r++)X(e,i.body[r].el);else Y(i);delete e._node,t.removeChild(e),N(i.hooks,"didRemove",i,null,n),null!=o&&(N(o.hooks,"didUnmount",o,o.data,n),o.node=null)}function U(t,e){var n=e._node;if(!n._dead){var i=function t(e){var n=e.vm,i=null!=n&&N(n.hooks,"willUnmount",n,n.data),o=N(e.hooks,"willRemove",e);if((e.flags&T)===T&&c(e.body))for(var r=0;r<e.body.length;r++)t(e.body[r]);return i||o}(n);null!=i&&function(t){return"object"==typeof t&&p(t.then)}(i)?(n._dead=!0,i.then(function(t,e,n){return function(){return t.apply(n,e)}}(X,[t,e,!0]))):X(t,e)}}function Y(t){for(var e=t.body,n=0;n<e.length;n++){var i=e[n];delete i.el._node,null!=i.vm&&(i.vm.node=null),c(i.body)&&Y(i)}}function K(t){var e=t.el;if(0==(t.flags&T))c(t.body)&&Y(t),e.textContent=null;else{var n=e.firstChild;do{var i=W(n);U(e,n)}while(n=i)}}function q(t,e,n){var i=e._node,o=null!=e.parentNode,r=e!==n&&o?null:i.vm;null!=r&&N(r.hooks,"willMount",r,r.data),N(i.hooks,o?"willReinsert":"willInsert",i),t.insertBefore(e,n),N(i.hooks,o?"didReinsert":"didInsert",i),null!=r&&N(r.hooks,"didMount",r,r.data)}function J(t,e,n){q(t,e,n?W(n):null)}var Z={},Q=l;function tt(t,e,n){t[e]=n}function et(t,e,n,i,o){var r=t.apply(o,e.concat([n,i,o,o.data]));o.onevent(n,i,o,o.data,e),Q.call(null,n,i,o,o.data,e),!1===r&&(n.preventDefault(),n.stopPropagation())}function nt(t){var e,n,i=function(t){for(;null==t._node;)t=t.parentNode;return t._node}(t.target),o=I(i),r=t.currentTarget._node.attrs["on"+t.type];if(c(r))e=r[0],n=r.slice(1),et(e,n,t,i,o);else for(var s in r)if(t.target.matches(s)){var a=r[s];c(a)?(e=a[0],n=a.slice(1)):(e=a,n=[]),et(e,n,t,i,o)}}function it(t,e,n,i){if(n!==i){var o=t.el;null==n||p(n)?tt(o,e,n):null==i&&tt(o,e,nt)}}function ot(t,e,n){"."===e[0]&&(e=e.substr(1),n=!0),n?t.el[e]="":t.el.removeAttribute(e)}function rt(t,e,n,i,o){var r=t.el;null==n?!o&&ot(t,e,!1):null!=t.ns?r.setAttribute(e,n):"class"===e?r.className=n:"id"===e||"boolean"==typeof n||i?r[e]=n:"."===e[0]?r[e.substr(1)]=n:r.setAttribute(e,n)}function st(t,e,n){var i=t.attrs||a,o=e.attrs||a;if(i===o);else{for(var r in i){var s=i[r],l=S(t.tag,r),c=l?t.el[r]:o[r];s===c||(x(r)?V(t,e):C(r)||(w(r)?it(t,r,s,c):rt(t,r,s,l,n)))}for(var r in o)!(r in i)&&!C(r)&&ot(t,r,S(t.tag,r)||w(r))}}function at(t,e,n,o){return t.type===i&&(e=t.data,n=t.key,o=t.opts,t=t.view),new xt(t,e,n,o)}function lt(t){for(var e=0;e<t.body.length;e++){var r=t.body[e],s=r.type;if(s<=n)q(t.el,ct(r));else if(s===i){var a=at(r.view,r.data,r.key,r.opts)._redraw(t,e,!1);s=a.node.type,q(t.el,ct(a.node))}else if(s===o){var a=r.vm;a._redraw(t,e),s=a.node.type,q(t.el,a.node.el)}}}function ct(i,o){return null==i.el&&(i.type===t?(i.el=o||function(t,e){return null!=e?G.createElementNS(e,t):G.createElement(t)}(i.tag,i.ns),null!=i.attrs&&st(i,a,!0),(i.flags&L)===L&&i.body.body(i),c(i.body)?lt(i):null!=i.body&&""!==i.body&&(i.el.textContent=i.body)):i.type===e?i.el=o||function(t){return G.createTextNode(t)}(i.body):i.type===n&&(i.el=o||function(t){return G.createComment(t)}(i.body))),i.el._node=i,i.el}window.lisMove=ht;var ut=1,dt=2;function ft(t,e,n,i,o,r,s,a){return function(l,c,u,d,f,h){var p,g;if(null!=d[i]){if(null==(p=d[i]._node))return void(d[i]=t(d[i]));if(function(t){return t.parent}(p)!==l)return g=t(d[i]),null!=p.vm?p.vm.unmount(!0):U(c,d[i]),void(d[i]=g)}if(d[o]==f)return dt;if(null==d[o].el)n(c,ct(d[o]),d[i]),d[o]=e(d[o],u);else if(d[o].el===d[i])d[o]=e(d[o],u),d[i]=t(d[i]);else{if(h||p!==d[s])return h&&null!=d[i]?ht(t,e,n,i,o,c,u,p,d):ut;g=d[i],d[i]=t(g),a(c,g,d[r]),d[r]=g}}}function ht(t,e,n,i,o,r,s,a,l){if(a._lis)n(r,l[o].el,l[i]),l[o]=e(l[o],s);else{var c=function(t,e){var n,i=0,o=e.length-1;if(o<=2147483647)for(;i<=o;){if(e[n=i+o>>1]===t)return n;e[n]<t?i=n+1:o=n-1}else for(;i<=o;){if(n=Math.floor((i+o)/2),e[n]===t)return n;e[n]<t?i=n+1:o=n-1}return i==e.length?null:i}(a.idx,l.tombs);a._lis=!0;var u=t(l[i]);n(r,l[i],null!=c?s[l.tombs[c]].el:c),null==c?l.tombs.push(a.idx):l.tombs.splice(c,0,a.idx),l[i]=u}}var pt=ft(W,function(t,e){return e[t.idx+1]},q,"lftSib","lftNode","rgtSib","rgtNode",J),gt=ft(function(t){return t.previousSibling},function(t,e){return e[t.idx-1]},J,"rgtSib","rgtNode","lftSib","lftNode",q);function vt(t,e,n,i){for(var o=Array.prototype.slice.call(e.childNodes),r=[],s=0;s<o.length;s++){var a=o[s]._node;a.parent===t&&r.push(a.idx)}for(var l=function(t){var e,n,i=t.slice(),o=[];o.push(0);for(var r=0,s=t.length;r<s;++r){var a=o[o.length-1];if(t[a]<t[r])i[r]=a,o.push(r);else{for(e=0,n=o.length-1;e<n;){var l=(e+n)/2|0;t[o[l]]<t[r]?e=l+1:n=l}t[r]<t[o[e]]&&(e>0&&(i[r]=o[e-1]),o[e]=r)}}for(e=o.length,n=o[e-1];e-- >0;)o[e]=n,n=i[n];return o}(r).map(function(t){return r[t]}),c=0;c<l.length;c++)n[l[c]]._lis=!0;for(i.tombs=l;;){var u=pt(t,e,n,i,null,!0);if(u===dt)break}}function _t(t){return t.el._node.parent!==t.parent}function yt(t,e,n){return e[n]}function mt(t,e,n){for(;n<e.length;n++){var r=e[n];if(null!=r.vm){if(t.type===i&&r.vm.view===t.view&&r.vm.key===t.key||t.type===o&&r.vm===t.vm)return r}else if(!_t(r)&&t.tag===r.tag&&t.type===r.type&&t.key===r.key&&(t.flags&~T)==(r.flags&~T))return r}return null}function wt(t,e,n){return e[e._keys[t.key]]}function Ct(r,s){N(s.hooks,"willRecycle",s,r);var l=r.el=s.el,u=s.body,d=r.body;if(l._node=r,r.type!==e||d===u){null==r.attrs&&null==s.attrs||st(r,s,!1);var f=c(u),h=c(d),p=(r.flags&L)===L;f?h||p?function(e,r){var s=e.body,l=s.length,c=r.body,u=c.length,d=(e.flags&L)===L,f=(e.flags&P)===P,h=(e.flags&j)===j,p=!f&&e.type===t,g=!0,v=h?wt:f||d?yt:mt;if(h){for(var _={},y=0;y<c.length;y++)_[c[y].key]=y;c._keys=_}if(p&&0===l)return K(r),void(d&&(e.body=[]));var m,w,C=0,x=!1,b=0;if(d)var S={key:null},I=Array(l);for(var y=0;y<l;y++){if(d){var E=!1,O=null;g&&(h&&(S.key=s.key(y)),m=v(S,c,b)),null!=m?(w=m.idx,!0===(O=s.diff(y,m))?((M=m).parent=e,M.idx=y,M._lis=!1):E=!0):E=!0,E&&(H(M=s.tpl(y),e,y),M._diff=null!=O?O:s.diff(y),null!=m&&Ct(M,m)),I[y]=M}else{var M=s[y],A=M.type;if(A<=n)(m=g&&v(M,c,b))&&(Ct(M,m),w=m.idx);else if(A===i){if(m=g&&v(M,c,b)){w=m.idx;var D=m.vm._update(M.data,e,y)}else var D=at(M.view,M.data,M.key,M.opts)._redraw(e,y,!1);A=D.node.type}else if(A===o){var T=k(M.vm),D=M.vm._update(M.data,e,y,T);A=D.node.type}}if(!h&&null!=m&&(w===b?++b===u&&l>u&&(m=null,g=!1):x=!0,u>100&&x&&++C%10==0))for(;b<u&&_t(c[b]);)b++}d&&(e.body=I),p&&function(t,e){var n=e.body,i=t.el,o=t.body,r={lftNode:o[0],rgtNode:o[o.length-1],lftSib:(n[0]||a).el,rgtSib:(n[n.length-1]||a).el};t:for(;;){for(;;){var s=pt(t,i,o,r,null,!1);if(s===ut)break;if(s===dt)break t}for(;;){var l=gt(t,i,o,r,r.lftNode,!1);if(l===ut)break;if(l===dt)break t}vt(t,i,o,r);break}}(e,r)}(r,s):d!==u&&(null!=d?l.textContent=d:K(s)):h?(K(s),lt(r)):d!==u&&(l.firstChild?l.firstChild.nodeValue=d:l.textContent=d),N(s.hooks,"didRecycle",s,r)}else l.nodeValue=d}function xt(t,e,n,i){var o=this;o.view=t,o.data=e,o.key=n,i&&(o.opts=i,o.config(i));var r=d(t)?t:t.call(o,o,e,n,i);p(r)?o.render=r:(o.render=r.render,o.config(r)),o._redrawAsync=m(function(t){return o.redraw(!0)}),o._updateAsync=m(function(t){return o.update(t,!0)}),o.init&&o.init.call(o,o,o.data,o.key,i)}var bt=xt.prototype={constructor:xt,_diff:null,init:null,view:null,key:null,data:null,state:null,api:null,opts:null,node:null,hooks:null,onevent:l,refs:null,render:null,mount:function(t,e){var n=this;return e?(K({el:t,flags:0}),n._redraw(null,null,!1),t.nodeName.toLowerCase()!==n.node.tag?(ct(n.node),q(t.parentNode,n.node.el,t),t.parentNode.removeChild(t)):q(t.parentNode,ct(n.node,t),t)):(n._redraw(null,null),t&&q(t,n.node.el)),t&&z(n),n},unmount:function(t){var e=this.node;U(e.el.parentNode,e.el),t||z(this)},config:function(t){var e=this;t.init&&(e.init=t.init),t.diff&&(e.diff=t.diff),t.onevent&&(e.onevent=t.onevent),t.hooks&&(e.hooks=g(e.hooks||{},t.hooks)),t.onemit&&(e.onemit=g(e.onemit||{},t.onemit))},parent:function(){return I(this.node.parent)},root:function(){for(var t=this.node;t.parent;)t=t.parent;return t.vm},redraw:function(t){return t?this._redraw(null,null,k(this)):this._redrawAsync(),this},update:function(t,e){return e?this._update(t,null,null,k(this)):this._updateAsync(t),this},_update:function(t,e,n,i){var o=this;return null!=t&&o.data!==t&&(N(o.hooks,"willUpdate",o,t),o.data=t),o._redraw(e,n,i)},_redraw:function(t,e,n){var i,o,r=null==t,s=this,a=s.node&&s.node.el&&s.node.el.parentNode,l=s.node;if(null!=s.diff&&(i=s._diff,s._diff=o=s.diff(s,s.data),null!=l)){var u=c(i)?y:_,d=i===o||u(i,o);if(d)return kt(s,l,t,e)}a&&N(s.hooks,"willRedraw",s,s.data);var f=s.render.call(s,s,s.data,i,o);if(f===l)return kt(s,l,t,e);if(s.refs=null,null!=s.key&&f.key!==s.key&&(f.key=s.key),s.node=f,t?(H(f,t,e,s),t.body[e]=f):l&&l.parent?(H(f,l.parent,l.idx,s),l.parent.body[l.idx]=f):H(f,null,null,s),!1!==n)if(l)if(l.tag!==f.tag||l.key!==f.key){l.vm=f.vm=null;var h=l.el.parentNode,p=W(l.el);U(h,l.el),q(h,ct(f),p),l.el=f.el,f.vm=s}else Ct(f,l);else ct(f);return a&&N(s.hooks,"didRedraw",s,s.data),r&&a&&z(s),s},_redrawAsync:null,_updateAsync:null};function kt(t,e,n,i){return null!=n&&(n.body[i]=e,e.idx=i,e.parent=n,e._lis=!1),t}function St(t,e,n,i){var o,r;return null==n?d(e)?o=e:r=e:(o=e,r=n),R(t,o,r,i)}var It="http://www.w3.org/2000/svg";function Et(t,e,n,i){this.view=t,this.data=e,this.key=n,this.opts=i}function Ot(t){this.vm=t}Et.prototype={constructor:Et,type:i,view:null,data:null,key:null,opts:null},Ot.prototype={constructor:Ot,type:o,vm:null};var Mt={config:function(t){Q=t.onevent||Q,t.onemit&&function(t){g(Z,t)}(t.onemit)},ViewModel:xt,VNode:E,createView:at,defineElement:St,defineSvgElement:function(t,e,n,i){var o=St(t,e,n,i);return o.ns=It,o},defineText:M,defineComment:function(t){var e=new E;return e.type=n,e.body=t,e},defineView:function(t,e,n,i){return new Et(t,e,n,i)},injectView:function(t){return new Ot(t)},injectElement:function(e){var n=new E;return n.type=t,n.el=n.key=e,n},lazyList:function(t,e){var n=t.length,i={items:t,length:n,key:function(n){return e.key(t[n],n)},diff:function(n,i){var o=e.diff(t[n],n);if(null==i)return o;var r=i._diff,s=o===r||c(r)?y(o,r):_(o,r);return s||o},tpl:function(n){return e.tpl(t[n],n)},map:function(t){return e.tpl=t,i},body:function(t){for(var e=Array(n),o=0;o<n;o++){var r=i.tpl(o);r._diff=i.diff(o),e[o]=r,H(r,t,o)}t.body=e}};return i},FIXED_BODY:P,DEEP_REMOVE:T,KEYED_LIST:j,LAZY_LIST:L};function At(t){var e,n,i=arguments,o=i.length;if(o>1){var r=1;d(i[1])&&(n=i[1],r=2),e=o===r+1&&(h(i[r])||c(i[r])||n&&(n._flags&L)===L)?i[r]:v(i,r)}return R(t,n,e)}return O.patch=function(t,e){!function(t,e,n){if(null!=e.type){if(null!=t.vm)return;H(e,t.parent,t.idx,null),t.parent.body[t.idx]=e,Ct(e,t),n&&b(e),z(I(e))}else{var i=Object.create(t);i.attrs=g({},t.attrs);var o=g(t.attrs,e);if(null!=t._class){var r=o.class;o.class=null!=r&&""!==r?t._class+" "+r:t._class}st(t,i),n&&b(t)}}(this,t,e)},bt.emit=function(t){var e=this,n=e,i=v(arguments,1).concat(n,n.data);do{var o=e.onemit,r=o?o[t]:null;if(r){r.apply(e,i);break}}while(e=e.parent());Z[t]&&Z[t].apply(e,i)},bt.onemit=null,bt.body=function(){return function t(e,n){var i=e.body;if(c(i))for(var o=0;o<i.length;o++){var r=i[o];null!=r.vm?n.push(r.vm):t(r,n)}return n}(this.node,[])},Mt.defineElementSpread=At,Mt.defineSvgElementSpread=function(){var t=At.apply(null,arguments);return t.ns=It,t},Mt}()},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=n(12),o=function(){function e(t,e){this._parent=t,this._changes=e}return e.prototype.load=function(t,e){var n=this;return this._parent.loadData=t.load().then(function(t){n._parent.removeAll(),n.parse(t,e)})},e.prototype.parse=function(t,e){void 0===e&&(e="json"),t=(e=i.toDataDriver(e)).toJsonArray(t),this._parent.$parse(t)},e.prototype.save=function(e){for(var n=this,o=function(o){if(o.saving||o.pending)i.dhxWarning("item is saving");else{var s=r._findPrevState(o.id);if(s&&s.saving){var a=new t(function(t,r){s.promise.then(function(){o.pending=!1,t(n._setPromise(o,e))}).catch(function(t){n._removeFromOrder(s),n._setPromise(o,e),i.dhxWarning(t),r(t)})});r._addToChain(a),o.pending=!0}else r._setPromise(o,e)}},r=this,s=0,a=this._changes.order;s<a.length;s++){o(a[s])}this._parent.saveData.then(function(){n._saving=!1})},e.prototype._setPromise=function(t,e){var n=this;return t.promise=e.save(t.obj,t.status),t.promise.then(function(){n._removeFromOrder(t)}).catch(function(e){t.saving=!1,t.error=!0,i.dhxError(e)}),t.saving=!0,this._saving=!0,this._addToChain(t.promise),t.promise},e.prototype._addToChain=function(t){this._parent.saveData&&this._saving?this._parent.saveData=this._parent.saveData.then(function(){return t}):this._parent.saveData=t},e.prototype._findPrevState=function(t){for(var e=0,n=this._changes.order;e<n.length;e++){var i=n[e];if(i.id===t)return i}return null},e.prototype._removeFromOrder=function(t){this._changes.order=this._changes.order.filter(function(e){return!i.isEqualObj(e,t)})},e}();e.Loader=o}).call(this,n(20))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(12),o=function(){function t(){}return t.prototype.sort=function(t,e){var n=this;e.rule&&"function"==typeof e.rule?this._sort(t,e):e.by&&(e.rule=function(t,o){var r=n._checkVal(e.as,t[e.by]),s=n._checkVal(e.as,o[e.by]);return i.naturalCompare(r.toString(),s.toString())},this._sort(t,e))},t.prototype._checkVal=function(t,e){return t?t.call(this,e):e},t.prototype._sort=function(t,e){var n=this,i={asc:1,desc:-1};return t.sort(function(t,o){return e.rule.call(n,t,o)*(i[e.dir]||i.asc)})},t}();e.Sort=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,o=n(3),r=n(15),s=n(54),a=n(33),l=n(11);function c(t){var e=t.y,n=function(t){for(t instanceof Event&&(t=t.target);t&&t.getAttribute;){if(t.getAttribute("dhx_id"))return t;t=t.parentNode}}(t);if(!n)return null;var i=n.childNodes[0].getBoundingClientRect();return(e-i.top)/i.height}!function(t){t[t.top=0]="top",t[t.bot=1]="bot",t[t.in=2]="in"}(i||(i={}));var u=function(){function t(){var t=this;this._transferData={},this._canMove=!0,this._ghostTopPadding=-17,this._onMouseMove=function(e){if(t._transferData.id){var n=e.pageX,i=e.pageY;if(!t._transferData.ghost){if(Math.abs(t._transferData.x-n)<3&&Math.abs(t._transferData.y-i)<3)return;var o=t._onDragStart(t._transferData.id,t._transferData.targetId);if(!o)return void t._endDrop();t._transferData.ghost=o,document.body.appendChild(t._transferData.ghost)}t._moveGhost(n,i),t._onDrag(e)}},this._onMouseUp=function(){t._transferData.x&&(t._transferData.ghost?(t._removeGhost(),t._onDrop()):t._endDrop(),document.removeEventListener("mousemove",t._onMouseMove),document.removeEventListener("mouseup",t._onMouseUp))}}return t.prototype.setItem=function(t,e,n){s.collectionStore.setItem(t,e,n)},t.prototype.onMouseDown=function(t){if(1===t.which){document.addEventListener("mousemove",this._onMouseMove),document.addEventListener("mouseup",this._onMouseUp);var e=o.locate(t,"dhx_id"),n=o.locate(t,"dhx_collection_id");e&&n&&(this._transferData.x=t.x,this._transferData.y=t.y,this._transferData.targetId=n,this._transferData.id=e)}},t.prototype._moveGhost=function(t,e){if(this._transferData.ghost){var n=this._transferData.ghost.offsetWidth/2;this._transferData.ghost.style.left=t-n+"px",this._transferData.ghost.style.top=e+this._ghostTopPadding+"px"}},t.prototype._removeGhost=function(){document.body.removeChild(this._transferData.ghost)},t.prototype._onDrop=function(){if(this._canMove){var t=s.collectionStore.getItem(this._lastCollectionId),e=s.collectionStore.getItemConfig(this._lastCollectionId);if(t&&e.mode!==l.DragMode.source){var n={id:this._lastId,target:t},i={id:this._transferData.id,target:this._transferData.target};i.target.events.fire(r.DragEvents.beforeDrop,[i,n])&&(this._move(i,n),n.target.events.fire(r.DragEvents.dropComplete,[n.id,this._transferData.dropPosition])),this._endDrop()}else this._endDrop()}else this._endDrop()},t.prototype._onDragStart=function(t,e){var n=s.collectionStore.getItem(e),i=s.collectionStore.getItemConfig(e);if(i.dragMode===l.DragMode.target)return null;var o=n.data.getItem(t);n.events.fire(r.DragEvents.dragStart);var a=function(t){var e=document.createElement("div");return e.textContent=t.value||t.text,e.className="drag-ghost",e}(o);return n.events.fire(r.DragEvents.beforeDrag,[o,a])&&t?(this._toggleTextSelection(!0),this._transferData.target=n,this._transferData.dragConfig=i,a):null},t.prototype._onDrag=function(t){var e=t.x,n=t.y,u=document.elementFromPoint(e,n),d=o.locate(u,"dhx_id");if(d){var f,h,p=o.locate(u,"dhx_collection_id");if(this._transferData.dragConfig.behaviour===l.DragBehaviour.complex){var g=c(t);this._transferData.dropPosition=g<=.25?i.top:g>=.75?i.bot:i.in}else if(this._lastId===d&&this._lastCollectionId===p)return;if(d&&p||!this._canMove)if(f=[h={id:this._transferData.id,target:this._transferData.target},{id:d,target:s.collectionStore.getItem(p)}],h.target.events.fire(r.DragEvents.dragOut,f),p!==this._transferData.targetId||!(h.target.data instanceof a.TreeCollection)||h.target.data instanceof a.TreeCollection&&h.target.data.canCopy(h.id,d))this._cancelCanDrop(),this._lastId=d,this._lastCollectionId=p,f.push(this._transferData.dropPosition),h.target.events.fire(r.DragEvents.dragIn,f)&&this._canDrop();else this._cancelCanDrop();else this._cancelCanDrop()}else this._cancelCanDrop()},t.prototype._move=function(t,e){var n=t.target.data,o=e.target.data,r=0,s=e.id;switch(this._transferData.dragConfig.behaviour){case l.DragBehaviour.child:break;case l.DragBehaviour.sibling:s=o.getParent(s),r=o.getIndex(e.id)+1;break;case l.DragBehaviour.complex:var a=this._transferData.dropPosition;a===i.top?(s=o.getParent(s),r=o.getIndex(e.id)):a===i.bot&&(s=o.getParent(s),r=o.getIndex(e.id)+1)}this._transferData.dragConfig.copy?n.copy(t.id,r,o,s):n.move(t.id,r,o,s)},t.prototype._endDrop=function(){this._toggleTextSelection(!1),this._transferData.target&&this._transferData.target.events.fire(r.DragEvents.dragEnd),this._cancelCanDrop(),this._canMove=!0,this._transferData={},this._lastId=null,this._lastCollectionId=null},t.prototype._cancelCanDrop=function(){this._canMove=!1;var t=s.collectionStore.getItem(this._lastCollectionId);t&&this._lastId&&t.events.fire(r.DragEvents.cancelDrop,[this._lastId])},t.prototype._canDrop=function(){this._canMove=!0;var t=s.collectionStore.getItem(this._lastCollectionId);t&&this._lastId&&t.events.fire(r.DragEvents.canDrop,[this._lastId,this._transferData.dropPosition])},t.prototype._toggleTextSelection=function(t){t?document.body.classList.add("dhx-no-select"):document.body.classList.remove("dhx-no-select")},t}();e.dragManager=new u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){this._store={}}return t.prototype.setItem=function(t,e,n){this._store[t]={target:e,config:n}},t.prototype.getItem=function(t){return this._store[t]?this._store[t].target:null},t.prototype.getItemConfig=function(t){return this._store[t]?this._store[t].config:null},t}();e.collectionStore=new i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6),o=n(15),r=n(11),s=function(){function t(t,e,n){var o=this;this.events=n||new i.EventSystem,this._data=e,this._data.events.on(r.DataEvents.removeAll,function(){o._selected=null}),this._data.events.on(r.DataEvents.change,function(){if(o._selected){var t=o._data.getNearId(o._selected);t!==o._selected&&(o._selected=null,t&&o.add(t))}})}return t.prototype.getId=function(){return this._selected},t.prototype.getItem=function(){return this._selected?this._data.getItem(this._selected):null},t.prototype.remove=function(t){return!(t=t||this._selected)||!!this.events.fire(o.SelectionEvents.beforeUnSelect,[t])&&(this._data.update(t,{$selected:!1}),this._selected=null,this.events.fire(o.SelectionEvents.afterUnSelect,[t]),!0)},t.prototype.add=function(t){this._selected!==t&&(this.remove(),this.events.fire(o.SelectionEvents.beforeSelect,[t])&&(this._selected=t,this._data.update(t,{$selected:!0}),this.events.fire(o.SelectionEvents.afterSelect,[t])))},t}();e.Selection=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(13),o=function(){function t(t){this._view=t}return t.prototype.xls=function(t){return this._export(t)},t.prototype._export=function(t){void 0===t&&(t={});for(var e=this._view.config.columns,n={},o=i.transpose(this._view.config.columns.map(function(t){return t.header.map(function(t){return t.text||" "})})),r=[],s={default:{color:"#000000",background:"#FFFFFF",fontSize:14}},a=[],l={},c=this._view.data.serialize().map(function(t,o){return n[t.id]=o,e.map(function(e,n){return l[e.id]=n,i.removeHTMLTags(t[e.id])})}),u=0,d=e;u<d.length;u++){var f=d[u];for(var h in r.push({width:f.width}),f.cellCss){var p=f.cellCss[h],g=p.split("").reduce(function(t,e){var n=(t<<5)-t+e.charCodeAt(0);return Math.abs(n&n)},0).toString();if(!s[g]){var v=document.body,_=i.getStyleByClass(p,v,"dhx_grid_row",s.default);_&&(s[g]=_)}s[g]&&a.push([n[h],f.id,g])}}var y={name:t.name||"data",columns:r,header:o,data:c,styles:{cells:a,css:s}};if(t.url){var m=document.createElement("form");m.setAttribute("target","_blank"),m.setAttribute("action",t.url),m.setAttribute("method","POST"),m.style.visibility="hidden";var w=document.createElement("textarea");w.setAttribute("name","data"),w.value=JSON.stringify(y),m.appendChild(w),document.body.appendChild(m),m.submit(),setTimeout(function(){m.parentNode.removeChild(m)},100)}return y},t}();e.Exporter=o},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(3),s=n(34),a=n(13),l=n(58),c=n(59);function u(t,e){var n,r,s=c.getRows(t,e),a=c.getSpans(t,e),l=t.splitAt>=0&&c.getRows(i({},t,{currentColumns:t.columns.slice(0,t.splitAt),positions:i({},t.positions,{xStart:0,xEnd:t.splitAt})}),e),u=((n={position:"sticky"})[e.position]=0,n);return e.sticky||(u.left=-t.scroll.left,r=-t.scroll.left,u.position="relative"),o.el(".dhx_"+e.name+"_wrapper",{class:e.sticky?"":"dhx_compatible_"+e.name,style:i({},u,{left:e.sticky?r:0,height:t[e.name+"Height"],width:e.sticky?t.$totalWidth:e.wrapper.width-2,zIndex:9999})},[o.el(".dhx_grid_"+e.name,{style:{height:t[e.name+"Height"],left:r,paddingLeft:e.shifts.x,width:t.$totalWidth}},s.concat([o.el(".dhx_"+e.name+"_spans",{style:{marginLeft:-e.shifts.x}},a),l&&o.el(".dhx_"+e.name+"_fixed_cols",{style:{position:"absolute",top:0,left:t.scroll.left+"px",height:"100%"}},l)])),o.el("div",{style:{width:t.$totalWidth}})])}e.render=function(t,e,n){if(t&&t.node&&t.node.parent&&t.node.parent.el){var c=t.node.parent.el;e.config.width=c.clientWidth||1,e.config.height=c.clientHeight||1}var d=e.config;if(!e.data||!d.columns.length)return o.el(".dhx_grid");d.$totalHeight=n.length*d.rowHeight;var f={width:d.width?d.width:e._container.clientWidth,height:d.height?d.height:e._container.clientHeight},h=function(t,e,n){var o=t.config,r=s.calculatePositions(n.width,n.height,t._scroll,o);return i({},o,{data:e,scroll:t._scroll,positions:r,headerHeight:o.$headerLevel*o.headerRowHeight,footerHeight:40,firstColId:o.columns[0].id,events:t.events,currentColumns:o.columns.slice(r.xStart,r.xEnd),sortBy:t._sortBy,sortDir:t._sortDir})}(e,n,f),p=l.getShifts(h),g=l.getContent(h),v=l.getContentSpans(h),_=h.splitAt>=0&&function(t){var e=t.columns.slice(0,t.splitAt);return t.fixedColumnsWidth=e.reduce(function(t,e){return t+(e.width||100)},0),l.getContent(i({},t,{columns:e,positions:i({},t.positions,{xStart:0,xEnd:t.splitAt})}))}(h),y=a.isCssSupport("position","sticky"),m=f.height-2;m=y?m:m-h.headerHeight;var w=h.$footer;m=w?y?m:m-h.footerHeight:m;var C=u(h,{wrapper:f,sticky:y,shifts:p,name:"header",position:"top"}),x=w?u(h,{wrapper:f,sticky:y,shifts:p,name:"footer",position:"bottom"}):null,b=d.$totalWidth<=f.width?0:r.getScrollbarWidth(),k=(y?m:m+h.headerHeight)-b;return o.el(".dhx_grid",[o.resizer(function(){return e.paint()}),o.el(".dhx_grid_content",{style:i({},f),onclick:e._htmlEvents.onclick},[y?null:C,o.el(".dhx_grid_body",{style:{height:m,width:f.width-2},onscroll:e._htmlEvents.onscroll,_ref:"grid_body"},[y?C:null,o.el(".dhx_data_wrap",{style:{height:d.$totalHeight,width:d.$totalWidth,"padding-left":p.x,"padding-top":p.y}},[o.el(".dhx_grid_data",g),o.el(".dhx_grid_spans",v),o.el(".dhx_grid_selection",{_ref:"selection"})]),y?x:null]),_&&o.el(".dhx_grid_fixed_cols_wrap",{style:{height:k,paddingTop:h.headerHeight,overflow:"hidden",width:h.fixedColumnsWidth}},[o.el(".dhx_grid_fixed_cols",{style:{top:-h.scroll.top+h.headerHeight+"px",paddingTop:p.y,height:d.$totalHeight,position:"absolute"}},_)]),y?null:x])])}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=n(0),r=n(13),s=n(17);function a(t,e,n,i){n.events.fire(s.GridEvents.cellClick,[t,e,i])}function l(t,e,n,i){n.events.fire(s.GridEvents.cellMouseDown,[t,e,i])}function c(t,e,n,i){n.events.fire(s.GridEvents.cellRightClick,[t,e,i])}function u(t,e,n,i){n.events.fire(s.GridEvents.cellMouseOver,[t,e,i])}function d(t,e,n,i){n.events.fire(s.GridEvents.cellDblClick,[t,e,i])}e.getContent=function(t){if(!t.data||!t.columns)return[];var e=t.positions,n=t.data?t.data.slice(e.yStart,e.yEnd):[],i=t.columns.slice(e.xStart,e.xEnd);return n.map(function(e){var n="";return t.rowCss&&(n=t.rowCss(e)),e.$css&&(n+=e.$css),o.el(".dhx_grid_row",{style:{height:t.rowHeight},dhx_grid_row:e.id,class:n},i.map(function(n){var i=(n.template||function(t,e,n){return t||""})(e[n.id],e,n);return i="string"==typeof i?o.el("div.dhx_cell_content",{".innerHTML":i}):i,"tree"===t.type&&t.firstColId===n.id?function(t,e,n,i){return o.el(".dhx_grid_cell",{class:"dhx_tree_cell "+(n.$cellCss[e.id]||"")+" "+(e.$childs?"dhx_grid_expand_cell":""),style:{width:n.width,lineHeight:i.rowHeight+"px",paddingLeft:24*e.$level},dhx_id:e.id},[e.$childs?o.el(".dhx_grid_expand_cell_icon",{class:e.$opened?"dxi dxi-chevron-up":"dxi dxi-chevron-down",dhx_id:e.id,style:{lineHeight:i.rowHeight+"px"}}):null,o.el(".dhx_tree_cell",{title:r.removeHTMLTags(e[n.id]),style:{width:n.width-10*e.$level,height:"100%",textAlign:"left"}},[t])])}(i,e,n,t):o.el(".dhx_grid_cell",{class:((n.$cellCss[e.id]||"")+" dhx_"+n.type+"_cell").replace(/\s+/g," "),style:{width:n.width,lineHeight:t.rowHeight+"px"},onclick:[a,e,n,t],onmousedown:[l,e,n,t],oncontextmenu:[c,e,n,t],ondblclick:[d,e,n,t],onmouseover:[u,e,n,t],title:r.removeHTMLTags(e[n.id])},[i])}))})},e.getContentSpans=function(t){var e=[],n=t.columns;if(!n.length)return null;if(!t.spans)return null;for(var r=t.spans.sort(function(t,e){return t.row-e.row}),s=t.rowHeight,a=function(a){var l=r[a].row,c=r[a].column,u=r[a].rowspan;if(1===u)return"continue";for(var d=i.findIndex(n,function(t){return t.id===c}),f=n[d],h=i.findIndex(t.data,function(t){return t.id===l}),p=t.data[h],g=void 0===p[c]?"":p[c],v=t.rowHeight*h,_=0,y=d-1;y>=0;y--)_+=n[y].width;var m=f.header[0].text?"dhx_span_cell":"dhx_span_cell dhx_span_cell--title";0===h&&(m+=" dhx_span_first_row"),0===d&&(m+=" dhx_span_first_col"),d===n.length-1&&(m+=" dhx_span_last_col"),e.push(o.el("div",{class:m,style:{width:f.width,height:u*s,top:v,left:_,lineHeight:t.rowHeight+"px"}},g))},l=0;l<r.length;l++)a(l);return e},e.getShifts=function(t){return{x:t.columns.slice(0,t.positions.xStart).reduce(function(t,e){return t+e.width},0),y:t.positions.yStart*t.rowHeight}}},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(13),s=n(35);function a(t,e,n){return{onclick:[l,t,e,n],onmouseover:[l,t,e,n],onmousedown:[l,t,e,n],ondblclick:[l,t,e,n]}}function l(t,e,n,i){n.events.fire(e+"Cell"+i.type,[t,i])}e.getRows=function(t,e){if(!t.data||!t.columns)return[];var n=e.name,l=t.currentColumns,c=t[n+"RowHeight"]||40,u=function(t,e){var n=t.map(function(t){return t[e]||[{}]});return r.transpose(n)}(l,n);return u.map(function(e,d){return o.el(".dhx_"+n+"_row",{style:{height:c}},e.map(function(e,f){var h=e.css||"",p=d===u.length-1,g=l[f];return t.sortBy&&""+g.id===t.sortBy&&p&&(h+=" dhx_sort dhx_sort--"+(t.sortDir||"asc")),h+=" dhx_"+(g.type||"string")+"_cell ",e.content?function(t,e,n,r,l){void 0===l&&(l="");var c=n[name+"RowHeight"]||40;return o.el(".dhx_grid_"+r+"_cell",i({class:l,style:{width:e.width,lineHeight:c+"px"}},a(e,r,n)),[s.content[t.content].toHtml(e,n)])}(e,g,t,n,h):o.el(".dhx_grid_"+n+"_cell",i({class:h,dhx_id:g.id,_key:f,style:{width:g.width,lineHeight:c+"px"}},a(g,n,t),{title:r.removeHTMLTags(e.text),".innerHTML":e.text}))}))})},e.getSpans=function(t,e){var n=t.columns,i=r.transpose(n.map(function(t){return t[e.name]||[]})),s=t[name+"RowHeight"]||40,a=0;return i.map(function(e,i){return a=0,o.el(".dhx_span_row",{style:{top:s*i+"px",height:s}},e.map(function(e,l){return a+=n[l].width,e.colspan?o.el(".dhx_span_cell",{style:{width:function(t,e,n){return t.reduce(function(t,i,o){return t+=o>=n&&o<n+e?i.width:0},0)}(t.columns,e.colspan,l),height:s,left:a-n[l].width,top:s*i,lineHeight:s+"px"},title:r.removeHTMLTags(e.text),".innerHTML":e.text}):null}).filter(function(t){return!!t}))})}},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),s=function(t){function e(e,n){return t.call(this,e,n)||this}return i(e,t),e.prototype.eachChild=function(t,e,n,i){if(void 0===n&&(n=!0),void 0===i&&(i="$opened"),this.haveChilds(t))for(var o=0;o<this._childs[t].length;o++){var r=this._childs[t][o].id;e.call(this,this.getItem(r),o),n&&!1!==this.getItem(r)[i]&&this.eachChild(r,e,n)}},e.prototype.getMaxLevel=function(){var t=this,e=1;return this.map(function(n){var i=t.getLevel(n.id);e=Math.max(i,e)}),e},e.prototype.getLevel=function(t){var e=0;return this.eachParent(t,function(){e++}),e},e.prototype.serialize=function(){var t=this,e=[];return this.eachChild(this.getRoot(),function(n){if(n){var i=o({},n,{$level:t.getLevel(n.id),$childs:t.haveChilds(n.id)});t.haveChilds(n.id)&&void 0===n.$opened&&(n.$opened=i.$opened=!0),e.push(i)}}),e},e.prototype.map=function(t,e,n){void 0===e&&(e=this._root),void 0===n&&(n=!0);var i=[];if(!this.haveChilds(e))return i;for(var o=0;o<this._childs[e].length;o++)if(i.push(t.call(this,this._childs[e][o],o)),n&&this._childs[e][o].$opened){var r=this.map(t,this._childs[e][o].id,n);i=i.concat(r)}return i},e.prototype.getId=function(t){return Object.keys(this._pull)[t]},e.prototype._parse_data=function(t,e){void 0===e&&(e=this._root);for(var n=0,i=t;n<i.length;n++){var o=i[n];this.config.init&&(o=this.config.init(o)),o.id=o.id?o.id.toString():r.uid(),o.parent=o.parent?o.parent.toString():e,this._pull[o.id]=o,this._childs[o.parent]||(this._childs[o.parent]=[]),this._childs[o.parent].push(o),o.$level=this.getLevel(o.id),o.childs&&o.childs instanceof Object&&this._parse_data(o.childs,o.id)}this._checkChilds()},e.prototype._checkChilds=function(){var t=this;this.eachChild(this._root,function(e){e.$childs=t.haveChilds(e.id)})},e}(n(10).TreeCollection);e.TreeGridCollection=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(62))},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(63),r=n(0),s=function(t){function e(e,n){var i=t.call(this,e,n)||this;if(i._root=i.config.parent||i,i._all={},i._parseConfig(),i.config.views&&(i.config.activeView=i.config.activeView||i._cells[0].id,i._isViewLayout=!0),i._css+=(n.parent?"":" dhx_widget")+(i._xLayout?" layout_x":" layout_y"),!n.parent){var o=r.create({render:function(){return i.toVDOM()}},i);i.mount(e,o)}return i}return i(e,t),e.prototype.cell=function(t){return this._root._all[t]},e.prototype.toVDOM=function(){if(this._isViewLayout){var e=[this.cell(this.config.activeView).toVDOM()];return t.prototype.toVDOM.call(this,e)}var n=[];return this._cells.forEach(function(t){var e=t.toVDOM();Array.isArray(e)?n.push.apply(n,e):n.push(e)}),t.prototype.toVDOM.call(this,n)},e.prototype.removeCell=function(t){var e=this.config.parent||this;if(e!==this)return e.removeCell(t);var n=this.cell(t);if(n){var i=n.getParent();delete this._all[t];for(var o=i._cells,r=-1,s=0;s<o.length;s++)if(o[s].id===t){r=s;break}-1!==r&&o.splice(r,1),i.paint()}},e.prototype.addCell=function(t,e){void 0===e&&(e=-1);var n=this._createCell(t);e<0&&(e=this._cells.length+e+1),this._cells.splice(e,0,n),this.paint()},e.prototype.getId=function(t){return t<0&&(t=this._cells.length+t),this._cells[t]?this._cells[t].id:void 0},e.prototype.getRefs=function(t){return this._root.getRootView().refs[t]},e.prototype._parseConfig=function(){var t=this,e=this.config,n=e.rows||e.cols||e.views;this._xLayout=!e.rows,this._cells=n.map(function(e){return t._createCell(e)})},e.prototype._createCell=function(t){var n;return t.rows||t.cols||t.views?(t.parent=this._root,n=new e(this,t)):n=new o.Cell(this,t),this._root._all[n.id]=n,n},e}(o.Cell);e.Layout=s},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var r,s=n(2),a=n(0),l=n(9);!function(t){t[t.unknown=0]="unknown",t[t.percents=1]="percents",t[t.pixels=2]="pixels",t[t.mixedpx1=3]="mixedpx1",t[t.mixedpx2=4]="mixedpx2",t[t.mixedperc1=5]="mixedperc1",t[t.mixedperc2=6]="mixedperc2"}(r||(r={}));var c=function(t){function e(e,n){var i=t.call(this,e,n)||this,o=e;return o&&o.isVisible&&(i._parent=o),i._initHandlers(),i.id=i.config.id||s.uid(),i._css="",i}return i(e,t),e.prototype.paint=function(){if(this.isVisible()){var t=this.getRootView();t?t.redraw():this._parent.paint()}},e.prototype.isVisible=function(){if(!this._parent)return!(!this._container||!this._container.tagName);var t=this._parent.config.activeView;return(!t||t===this.id)&&(!this.config.hidden&&(!this._parent||this._parent.isVisible()))},e.prototype.hide=function(){this.config.hidden=!0,this._parent&&this._parent.paint&&this._parent.paint()},e.prototype.show=function(){this._parent&&this._parent.config.activeView?this._parent.config.activeView=this.id:this.config.hidden=!1,this._parent&&!this._parent.isVisible()&&this._parent.show(),this.paint()},e.prototype.getParent=function(){return this._parent},e.prototype.destructor=function(){this.config=null},e.prototype.getWidget=function(){return this._ui},e.prototype.attach=function(t,e){return"object"==typeof t?this._ui=t:"string"==typeof t?this._ui=new window.dhx[t](null,e):"function"==typeof t&&(t.prototype instanceof l.View?this._ui=new t(null,e):this._ui={getRootView:function(){return t(e)}}),this.paint(),this._ui},e.prototype.toVDOM=function(t){if(!this.config.hidden){var e,n=this._css+" "+(this.config.css||""),i=this._calculateStyle();if(this.config.html)e=[a.el("div",{".innerHTML":this.config.html})];else if(this._ui){var r=this._ui.getRootView();r.render&&(r=a.inject(r)),e=[r]}else e=t||null;var s=this.config.canResize&&!this._isLastCell()?a.el(".resizer."+(this._isXDirection()?"x":"y"),o({},this._resizerHandlers,{_ref:"resizer_"+this._uid}),[a.el("div",{class:"dxi "+(this._isXDirection()?"dxi-dots-vertical":"dxi-dots-horizontal")})]):null,l={};if(this.config.on)for(var c in this.config.on)l["on"+c]=this.config.on[c];var u=a.el("div",o({_key:this._uid,style:i,_ref:this._uid},l,{class:"dhx_cell "+n+(this.config.collapsed?" collapsed":"")}),[this.config.header?a.el("div",{class:"dhx_cell_header",onclick:this._handlers.collapse},[a.el(".header-text",this.config.header),a.el(".header-action-icon",[a.el("div",{class:"dxi "+this.config.headerIcon})])]):null,this.config.collapsed?null:a.el("div",{class:"dhx_cell_content"},e),this.config.footer?a.el("div",{class:"dhx_cell_footer"},this.config.footer):null]);return s?[u,s]:u}},e.prototype._initHandlers=function(){var t=this,e={left:null,top:null,isActive:!1,range:null,xLayout:null,nextCell:null,size:null,resizerLength:null,mode:null,percentsum:null},n=function(){e.isActive=!1,document.body.classList.remove("dhx-no-select"),document.removeEventListener("mouseup",n),document.removeEventListener("mousemove",i)},i=function(n){if(e.isActive&&e.mode!==r.unknown){var i=e.xLayout?n.x-e.range.min-window.pageXOffset:n.y-e.range.min-window.pageYOffset,o=e.xLayout?"width":"height";switch(i<0?i=e.resizerLength/2:i>e.size&&(i=e.size-e.resizerLength),e.mode){case r.pixels:t.config[o]=i-e.resizerLength/2+"px",e.nextCell.config[o]=e.size-i-e.resizerLength/2+"px";break;case r.mixedpx1:t.config[o]=i-e.resizerLength/2+"px";break;case r.mixedpx2:e.nextCell.config[o]=e.size-i-e.resizerLength/2+"px";break;case r.percents:t.config[o]=i/e.size*e.percentsum+"%",e.nextCell.config[o]=(e.size-i)/e.size*e.percentsum+"%";break;case r.mixedperc1:t.config[o]=i/e.size*e.percentsum+"%";break;case r.mixedperc2:e.nextCell.config[o]=(e.size-i)/e.size*e.percentsum+"%"}t.paint()}};this._handlers={collapse:function(){t.config.canCollapse&&(t.config.collapsed=!t.config.collapsed,t.paint())}},this._resizerHandlers={onmousedown:function(o){if(3!==o.which){e.isActive&&n(),document.body.classList.add("dhx-no-select");var s=t._getCellView(),a=t._getNextCell(),l=a._getCellView(),c=t._getResizerView(),u=s.el.getBoundingClientRect(),d=c.el.getBoundingClientRect(),f=l.el.getBoundingClientRect();if(e.xLayout=t._isXDirection(),e.left=u.left+window.pageXOffset,e.top=u.top+window.pageYOffset,e.range=function(t,e,n){return void 0===n&&(n=!0),n?{min:t.left+window.pageXOffset,max:e.right+window.pageXOffset}:{min:t.top+window.pageYOffset,max:e.bottom+window.pageYOffset}}(u,f,e.xLayout),e.size=e.range.max-e.range.min,e.isActive=!0,e.nextCell=a,e.resizerLength=e.xLayout?d.width:d.height,e.mode=function(t,e,n){var i=t?"width":"height",o=e[i]&&-1!==e[i].indexOf("%"),s=n[i]&&-1!==n[i].indexOf("%"),a=e[i]&&-1!==e[i].indexOf("px"),l=n[i]&&-1!==n[i].indexOf("px");return o&&s?r.percents:a&&l?r.pixels:a&&!l?r.mixedpx1:l&&!a?r.mixedpx2:o?r.mixedperc1:s?r.mixedperc2:r.unknown}(e.xLayout,t.config,a.config),e.mode===r.percents){var h=e.xLayout?"width":"height";e.percentsum=parseFloat(t.config[h])+parseFloat(a.config[h])}if(e.mode===r.mixedperc1){h=e.xLayout?"width":"height";e.percentsum=1/(u[h]/(e.size-e.resizerLength))*parseFloat(t.config[h])}if(e.mode===r.mixedperc2){h=e.xLayout?"width":"height";e.percentsum=1/(f[h]/(e.size-e.resizerLength))*parseFloat(a.config[h])}document.addEventListener("mouseup",n),document.addEventListener("mousemove",i)}},ondragstart:function(t){return t.preventDefault()}}},e.prototype._isLastCell=function(){var t=this._parent;return t&&t._cells.indexOf(this)===t._cells.length-1},e.prototype._getNextCell=function(){var t=this._parent,e=t._cells.indexOf(this);return t._cells[e+1]},e.prototype._getCellView=function(){return this._parent.getRefs(this._uid)},e.prototype._getResizerView=function(){return this._parent.getRefs("resizer_"+this._uid)},e.prototype._isXDirection=function(){return this._parent&&this._parent._xLayout},e.prototype._calculateStyle=function(){var t=this.config,e={};return this._isXDirection()?(void 0!==this.config.width&&(e.flex="0 0 "+t.width),void 0!==t.height&&(e.height=t.height)):(void 0!==this.config.height&&(e.flex="0 0 "+t.height),void 0!==t.width&&(e.width=t.width)),e},e}(l.View);e.Cell=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(4);e.button=function(t){return i.el("div",{class:"button-container main-btn element"+o.getCss(t)+(t.value?"":" no-text"),dhx_id:t.id},[o.counter(t),t.icon?o.icon(t.icon):null,t.value?i.el(".button-text",t.value):null])}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(4);e.customHTMLButton=function(t){return i.el("div",{class:"button-container custom-html-btn element"+o.getCss(t),dhx_id:t.id},[o.counter(t),i.el(".html-content",{".innerHTML":t.html}),t.value?i.el(".button-text",t.value):null])}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(4);e.dhx_button=function(t){return i.el("button",{class:"dhx_btn"+o.getCss(t)+o.getButtonCss(t),dhx_id:t.id},[t.icon?o.icon(t.icon):null,t.value?i.el(".item-value",t.value):null])}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(4);e.iconButton=function(t){return i.el("div",{class:"icon-btn element"+o.getCss(t),dhx_id:t.id},[o.counter(t),o.icon(t.icon),t.css&&-1!==t.css.indexOf("ripple")?i.el(".ripple-container-outside"):null])}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(4);e.imageButton=function(t){return i.el("div",{class:"button-container img-btn element"+o.getCss(t),dhx_id:t.id},[o.counter(t),i.el(".img-button-wrapper",[i.el("img.img-button",{src:t.src})])])}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(4);e.imageButtonText=function(t){return i.el("div",{class:"button-container img-text-btn element"+o.getCss(t),dhx_id:t.id},[o.counter(t),i.el("img.img-button",{src:t.src}),i.el(".button-text",t.value)])}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(7),r=n(4);e.input=function(t,e){return i.el("div",{dhx_id:t.id,class:"input-container element"+r.getCss(t)},[i.el(".input-wrapper",[i.el("input.text-input",{placeholder:t.placeholder,value:t.value,style:{width:t.width?t.width:null},_hooks:{didInsert:function(n){e&&e.fire(o.ToolbarEvents.inputCreated,[t.id,n.el])}},_key:t.id}),i.el(".input-animation")]),t.icon?r.icon(t.icon):null])}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(4);e.menuItem=function(t){return i.el("div",{class:"menu-item element"+o.getCss(t),dhx_id:t.id},[t.icon?o.icon(t.icon):null,t.value?i.el("span.menu-item-content",t.value):null,t.$openIcon?i.el(".dhx-icon.sub-menu-opener",[i.el(".dxi."+("right"===t.$openIcon?".dxi-menu-right":".dxi-menu-down"))]):null,t.hotkey?i.el(".hotkey",t.hotkey):null])}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0);e.separator=function(t){return i.el(".separator")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0);e.spacer=function(t){return i.el(".spacer")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(4);e.text=function(t){return i.el("div",{class:"text element"+o.getCss(t),dhx_id:t.id},t.value)}},function(t,e,n){"use strict";function i(t){for(var e=t.toLowerCase().match(/\w+/g),n=0,i="",o=0;o<e.length;o++){var r=e[o];"ctrl"===r?n+=4:"shift"===r?n+=2:"alt"===r?n+=1:i=r}return n+i}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(){var t=this;this._keysStorage={},document.addEventListener("keydown",function(e){var n=(e.ctrlKey?4:0)+(e.shiftKey?2:0)+(e.altKey?1:0)+e.key.toLowerCase(),i=t._keysStorage[n];i&&i.handler(e)})}return t.prototype.addHotKey=function(t,e,n){var o=i(t);this._keysStorage[o]={handler:e,scope:n}},t.prototype.removeHotKey=function(t,e){var n=this._keysStorage;t&&delete n[o=i(t)];if(e)for(var o in n)n[o].scope===e&&delete n[o]},t.prototype.exist=function(t){var e=i(t);return!!this._keysStorage[e]},t}();e.keyManager=new o},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(18),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isContextMenu=!0,e}return i(e,t),e.prototype.showAt=function(t,e){if(void 0===e&&(e="bottom"),t instanceof MouseEvent)this._changeActivePosition({left:window.pageXOffset+t.x+1,right:window.pageXOffset+t.x+1,top:window.pageYOffset+t.y,bottom:window.pageYOffset+t.y},e);else{var n=o.toNode(t);this._changeActivePosition(r.getRealPosition(n),e)}},e.prototype._close=function(){this._activeMenu=null,this._changeActivePosition(null,null)},e.prototype._normalizeData=function(){var t=this,e=this.data.getRoot();this.data.eachChild(e,function(e){t.data.haveChilds(e.id)&&(e.$openIcon="right")},!0)},e.prototype._getMode=function(t,e,n){return n?this._mode:"right"},e.prototype._changeActivePosition=function(t,e){this._activePosition=t,this._mode=e,this._listenOuterClick(),this.paint()},e}(n(23).MenuBase);e.ContextMenu=s},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),s=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.mount(e,r.create({render:function(){return i._draw()}})),i}return i(e,t),e.prototype._draw=function(){return r.el("div",o({dhx_widget_id:this._uid,class:"main-menu"},this._handlers),this._drawMenuItems(this.data.getRoot()))},e}(n(23).MenuBase);e.Menu=s},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(18),s=n(36),a=n(7),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._draw=function(){var t=this;return o.el(".ribbon.dhx_widget",{dhx_widget_id:this._uid,onclick:this._handlers.onclick},this.data.map(function(e){return t._drawBlock(e.id)},this.data.getRoot(),!1))},e.prototype._setRoot=function(t){var e=this.data.getParent(t);this.data.getItem(e).type===a.ItemType.block&&(this._currentRoot=t)},e.prototype._normalizeData=function(){var t=this,e=this.data.getRoot(),n={};this.data.eachChild(e,function(e){if(e.type===a.ItemType.menuItem&&t.data.haveChilds(e.id)){t.data.eachChild(e.id,function(t){return t.type=t.type||a.ItemType.menuItem},!1);var i=t.data.getParent(e.id),o=t.data.getItem(i);e.$openIcon=o.type===a.ItemType.block?"bot":"right"}e.group&&r.addInGroups(n,e)},!0),this._groups=n},e.prototype._drawBlock=function(t){var e=this,n=this.data.getItem(t);if(!n)return null;var i="row"===n.direction?" ribbon-row":" ribbon-cols",r=this.data.map(function(t){return t.type===a.ItemType.block?e._drawBlock(t.id):e._factory(t)},t,!1);return o.el("div",{class:"ribbon-item-block"+i},[o.el(".block-content",r),n.label?o.el(".block-label",[o.el("span",n.label)]):null])},e}(s.Toolbar);e.Ribbon=l},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(80)),i(n(85))},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(6),s=n(3),a=n(81),l=n(83),c=n(84),u=function(t){function e(e){var n=t.call(this,e)||this;return n._handleGripMove=function(t){var e=n._popup.refs.picker_palette.el.getBoundingClientRect(),i=t.clientY-e.top,o=t.clientX-e.left;n._calculatePaletteGrip(i,o),n._popup.redraw()},n._handleRangeMove=function(t){var e=n._popup.refs.hue_range.el.getBoundingClientRect(),i=t.clientX-e.left-3;n._calculateRangeGrip(i),n._popup.redraw()},e=e||{},n.events=new r.EventSystem(n),n.config.width=e.width||234,n.config.height=e.height||252,n.config.css+=" dhx_colorpicker_popup",n._pickerState={hsv:{h:0,s:1,v:1},currentView:"palette",customColors:[],customHex:""},n._handlers={click:{".dhx_palette_cell":n._onColorClick.bind(n)},mousedown:function(t){var e=s.locate(t);n._pickerState.customHex="";var i=n._popup.refs[e].el.getBoundingClientRect();"picker_palette"===e?n._calculatePaletteGrip(t.clientY-i.top,t.clientX-i.left):n._calculateRangeGrip(t.clientX-i.left);var o="picker_palette"===e?n._handleGripMove:n._handleRangeMove;document.addEventListener("mousemove",o),document.addEventListener("mouseup",function(){document.removeEventListener("mousemove",o)}),n._popup.redraw()},buttonsClick:function(t,e){n._eventSystem.fire("buttonClick",[t]),n._pickerState.currentView="palette","cancel"!==t?("apply"===t&&-1===n._pickerState.customColors.indexOf(n._pickerState.background)&&n._pickerState.customColors.push(n._pickerState.background),n._selected=n._pickerState.background,n.callEvent("onColorChange",[n._selected]),setTimeout(function(){n.hide()},1)):n._popup.redraw()},customColorClick:function(){n._pickerState.currentView="picker",n._popup.redraw()},oninput:function(t){n._inputTimeout&&clearTimeout(n._inputTimeout),n._inputTimeout=setTimeout(function(){var e=t.target.value;-1===e.indexOf("#")&&(e="#"+e),n._pickerState.customHex=e,l.isHex(e)&&(n._pickerState.hsv=l.HexToHSV(e),n._popup.redraw())},100)},contextmenu:{".dhx_palette_cell":function(t,e){t.preventDefault();var i=n._pickerState.customColors.indexOf(e.data.color);-1!==i&&n._pickerState.customColors.splice(i,1),n._popup.redraw()}}},n.attachEvent("afterShow",function(){document.addEventListener("keydown",n._handlers.keyDown),document.addEventListener("keyup",n._handlers.keyUp)}),n.attachEvent("afterHide",function(){document.removeEventListener("keydown",n._handlers.keyDown),document.removeEventListener("keyup",n._handlers.keyUp)}),n}return i(e,t),e.prototype.setValue=function(t){this._selected=t||null},e.prototype._calculatePaletteGrip=function(t,e){var n=this._popup.refs.picker_palette.el.getBoundingClientRect(),i=n.height,o=n.width;t=t<0?0:t>i?i:t,e=e<0?0:e>o?o:e;var r=Math.round(e/(o/100)),s=100-Math.round(t/(i/100));this._pickerState.hsv.s=r/100,this._pickerState.hsv.v=s/100},e.prototype._calculateRangeGrip=function(t){var e=this._popup.refs.hue_range.el.getBoundingClientRect().width;t=t<0?0:t>e?e:t,this._pickerState.rangeLeft=t,this._pickerState.hsv.h=Math.round(t/e*360)},e.prototype._getCells=function(t,e){var n=this;return void 0===e&&(e=""),t.reduce(function(t,i){var r=n._selected===i?"dhx_selected":"";return t.push(o.el(".dhx_palette_cell",{class:r+" "+e,_data:{color:i},style:"background:"+i})),t},[])},e.prototype._onColorClick=function(t,e){this._selected=e.data.color,this.callEvent("onColorChange",[this._selected]),this.hide()},e.prototype._getGrayShades=function(){return o.el(".dhx_palette_row",this._getCells(c.grayShades))},e.prototype._getPalette=function(){var t=this;return c.palette.reduce(function(e,n){return e.push(o.el(".dhx_palette_col",t._getCells(n.colors))),e},[])},e.prototype._getPicker=function(){var t=l.HSVtoRGB(this._pickerState.hsv);this._pickerState.background=l.RGBToHex(t);var e=l.RGBToHex(l.HSVtoRGB({h:this._pickerState.hsv.h,s:1,v:1})),n=this._popup.refs?this._popup.refs.picker_palette.el.getBoundingClientRect():{height:200,width:218,x:0,y:0},i=n.height-2,r=n.width-2,s=i-this._pickerState.hsv.v*i-4,a=this._pickerState.hsv.s*r-4,c=n.width-6,u=c-(360-this._pickerState.hsv.h)/360*c,d=this._pickerState.customHex?this._pickerState.customHex.replace("#",""):this._pickerState.background.replace("#","");return o.el(".picker_wrap",{},[o.el(".dhx_picker_palette",{style:{height:132,background:e},onmousedown:this._handlers.mousedown,dhx_id:"picker_palette",_ref:"picker_palette"},[o.el(".dhx_palette_grip",{style:{top:s,left:a}})]),o.el(".dhx_hue_range",{style:{height:16},onmousedown:this._handlers.mousedown,dhx_id:"hue_range",_key:"hue_range",_ref:"hue_range"},[o.el(".dhx_range_grip",{style:{left:u}})]),o.el(".dhx_color_value",[o.el(".dhx_current_color",{style:{background:this._pickerState.background}}),o.el(".dhx_hex_input_wrap",[o.el("input",{class:"dhx_hex_input",value:d,oninput:this._handlers.oninput,maxlength:"7",_key:"hex_input"})])]),o.el(".dhx_picker_buttons",[o.el("button",{class:"dhx_btn dhx_btn--link dhx_cancel",onclick:[this._handlers.buttonsClick,"cancel"]},"cancel"),o.el("button",{class:"dhx_btn dhx_btn--flat dhx_apply",onclick:[this._handlers.buttonsClick,"apply"]},"apply")])])},e.prototype._getContent=function(){var t="palette"===this._pickerState.currentView?[this._getGrayShades()].concat(this._getPalette(),[o.el(".dhx_custom_colors",[o.el(".dhx_custom_colors_header",["Custom colors",o.el("span.hint"," (Right click to delete)")]),o.el(".dhx_custom_palette.dhx_palette_row",this._getCells(this._pickerState.customColors,"custom_color_cell").concat([o.el(".dhx_show_picker",{class:"dxi dxi-plus",onclick:this._handlers.customColorClick})]))])]):[this._getPicker()];return o.el(".dhx_colorpicker_wrap",[o.el(".dhx_palette",{onclick:this._handlers.click,oncontextmenu:this._handlers.contextmenu},t)])},e}(a.Popup);e.Colorpicker=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(82))},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(6),s=n(3),a=function(){function t(t){var e=this;this._handleOutsideClick=function(t){e._popup.node.el.contains(t.target)||e._node.contains(t.target)||e.hide(!0)},this._handleClick=function(t){e.callEvent("onDomEvent",["click",t])};this.config=i({},{width:400,height:400,css:""},t),this._eventSystem=new r.EventSystem(this),this.state={}}return t.prototype.attachEvent=function(t,e){this._eventSystem.on(t,e,this)},t.prototype.detachEvent=function(t){this._eventSystem.detach(t,this)},t.prototype.callEvent=function(t,e){return this._eventSystem.fire(t,e)},t.prototype.show=function(t){if(this._hideTimer)return clearTimeout(this._hideTimer),void this._popup.classList.remove("hide");this._popup||(this._getPosition(t),this._node=t,this._popup=o.create({render:this.render},this),this._popup.mount(document.body),document.body.addEventListener("click",this._handleOutsideClick),this.callEvent("afterShow",[]))},t.prototype.hide=function(t){this._popup.unmount(),this._popup=null,document.body.removeEventListener("click",this._handleOutsideClick),this.callEvent("afterHide",[])},t.prototype.render=function(t,e){return o.el(".dhx_popup",{style:"\n\t\t\twidth:"+e.config.width+"px;\n\t\t\theight:"+e.config.height+"px;\n\t\t\ttop:"+e.state.position.top+"px;\n\t\t\tleft:"+e.state.position.left+"px;",class:e.config.css,onclick:this._handleClick},[o.el(".dhx_popup_content.dhx_card",{style:"width:100%;height:100%;"},[e._getContent()])])},t.prototype._getContent=function(){return null},t.prototype._getPosition=function(t){var e=(t=s.toNode(t)).getBoundingClientRect(),n=document.body.getBoundingClientRect(),i=e.left+e.width/2,o=e.bottom,r=i-this.config.width/2,a=e.bottom+this.config.height,l={top:o,left:r},c=e.top-this.config.height,u=n.bottom-a,d=r,f=n.right-e.right;return f<0&&(l.left=e.right-this.config.width),d<0&&(l.left=e.left),u<0&&c>0?(l={top:o-this.config.height,left:r},(f<0||d<0)&&(l.left=f<0?e.right-this.config.width:e.left)):u<0&&(l.top=e.bottom+n.bottom-a,l.left=e.right,d<0&&(l.left=e.right)),l.top+=window.pageYOffset,l.left+=window.pageXOffset,this.state.position=l,l},t}();e.Popup=a},function(t,e,n){"use strict";function i(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,n,i){return e+e+n+n+i+i});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function o(t){var e,n,i=t.r/255,o=t.g/255,r=t.b/255,s=Math.max(i,o,r),a=s-Math.min(i,o,r),l=function(t){return(s-t)/6/a+.5};if(0===a)e=n=0;else{n=a/s;var c=l(i),u=l(o),d=l(r);i===s?e=d-u:o===s?e=1/3+c-d:r===s&&(e=2/3+u-c),e<0?e+=1:e>1&&(e-=1)}return{h:Math.floor(360*e),s:n,v:s}}Object.defineProperty(e,"__esModule",{value:!0}),e.HSVtoRGB=function(t){var e={r:0,g:0,b:0},n=t.h/60,i=t.s,o=t.v,r=Math.floor(n)%6,s=n-Math.floor(n),a=255*o*(1-i),l=255*o*(1-i*s),c=255*o*(1-i*(1-s));switch(o*=255,r){case 0:e.r=o,e.g=c,e.b=a;break;case 1:e.r=l,e.g=o,e.b=a;break;case 2:e.r=a,e.g=o,e.b=c;break;case 3:e.r=a,e.g=l,e.b=o;break;case 4:e.r=c,e.g=a,e.b=o;break;case 5:e.r=o,e.g=a,e.b=l}for(var u in e)e[u]=Math.round(e[u]);return e},e.RGBToHex=function(t){return Object.keys(t).reduce(function(e,n){var i=t[n].toString(16).toUpperCase();return e+(i=1===i.length?"0"+i:i)},"#")},e.HexToRGB=i,e.RGBToHSV=o,e.HexToHSV=function(t){return o(i(t))},e.isHex=function(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.grayShades=["#000000","#4C4C4C","#666666","#808080","#999999","#B3B3B3","#CCCCCC","#E6E6E6","#F2F2F2","#FFFFFF"],e.palette=[{colors:["#D4DAE4","#B0B8CD","#949DB1","#727A8C","#5E6677","#3F4757","#1D2534"]},{colors:["#FFCDD2","#FE9998","#F35C4E","#E94633","#D73C2D","#CA3626","#BB2B1A"]},{colors:["#F9E6AD","#F4D679","#EDB90F","#EAA100","#EA8F00","#EA7E00","#EA5D00"]},{colors:["#BCE4CE","#90D2AF","#33B579","#36955F","#247346","#1D5B38","#17492D"]},{colors:["#BDF0E9","#92E7DC","#02D7C5","#11B3A5","#018B80","#026B60","#024F43"]},{colors:["#B3E5FC","#81D4FA","#29B6F6","#039BE5","#0288D1","#0277BD","#01579B"]},{colors:["#AEC1FF","#88A3F9","#5874CD","#2349AE","#163FA2","#083596","#002381"]},{colors:["#C5C0DA","#9F97C1","#7E6BAD","#584A8F","#4F4083","#473776","#3A265F"]},{colors:["#D6BDCC","#C492AC","#A9537C","#963A64","#81355A","#6E3051","#4C2640"]},{colors:["#D2C5C1","#B4A09A","#826358","#624339","#5D4037","#4E342E","#3E2723"]}]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.buttonClick="buttonClick",t.colorChange="onColorChange"}(e.ColorpickerEvents||(e.ColorpickerEvents={}))},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),r=n(14),s=n(1),a=function(){function t(t){this.config=t}return t.prototype.do=function(){var t=this.config.cell;this._index||(this._index=s.getCellIndex(t).col);var e=i({},this.config.grid.config.columns[1],{$cellCss:{},header:[{text:""}]});e.id=o.uid(),this.config.grid.data.map(function(t){t[e.id]=""}),this.config.grid.config.columns.splice(this._index,0,e),r.updateColumns(this.config.grid.config),this.config.spreadsheet.selection.setSelectedCell(t),this.config.grid.paint()},t.prototype.undo=function(){this.config.grid.config.columns.splice(this._index,1),r.updateColumns(this.config.grid.config),this.config.spreadsheet.selection.setSelectedCell(this.config.cell)},t}();e.AddColumn=a},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(14),r=n(1),s=function(){function t(t){this.config=t}return t.prototype.do=function(){var t=this.config.cell;this._index||(this._index=r.getCellIndex(t).row);var e=i({},this.config.grid.data.getItem(this.config.grid.data.getId(0)));for(var n in e)e[n]="";this.config.grid.data.add(e,this._index),o.updateRowsIndex(this.config.grid.data),o.removeRowsCss(this.config.grid),this.config.spreadsheet.selection.setSelectedCell(t),this.config.grid.paint()},t.prototype.undo=function(){this.config.grid.data.remove(this.config.grid.data.getId(this._index)),o.updateRowsIndex(this.config.grid.data),o.removeRowsCss(this.config.grid),this.config.spreadsheet.selection.setSelectedCell(this.config.cell)},t}();e.AddRow=s},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),r=n(14),s=n(1),a=function(){function t(t){this.config=t}return t.prototype.do=function(){var t=this.config.cell;if(this._index||(this._index=s.getCellIndex(t).col),this._column=this.config.grid.config.columns.splice(this._index,1)[0],this.config.grid.config.columns.length<=1){var e=i({},this._column,{$cellCss:{},header:[{text:""}]});e.id=o.uid(),this.config.grid.config.columns.push(e)}r.updateColumns(this.config.grid.config),this.config.spreadsheet.selection.setSelectedCell(t),this.config.grid.paint()},t.prototype.undo=function(){this.config.grid.config.columns.splice(this._index,0,this._column),r.updateColumns(this.config.grid.config),this.config.spreadsheet.selection.setSelectedCell(this.config.cell)},t}();e.DeleteColumn=a},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(14),r=n(1),s=function(){function t(t){this.config=t}return t.prototype.do=function(){var t=this.config,e=t.row,n=t.cell;if(this._item||(this._item=i({},this.config.grid.data.getItem(e)),this._index=r.getCellIndex(n).row),this.config.grid.data.remove(e),!this.config.grid.data.getLength()){var s=this.config.grid.config.columns.reduce(function(t,e){return t[e.id]="",t},{});this.config.grid.data.add(s)}o.updateRowsIndex(this.config.grid.data),this.config.spreadsheet.selection.setSelectedCell(n)},t.prototype.undo=function(){this.config.grid.data.add(this._item,this._index),o.updateRowsIndex(this.config.grid.data),o.removeRowsCss(this.config.grid),this.config.spreadsheet.selection.setSelectedCell(this.config.cell)},t}();e.DeleteRow=s},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),r=n(19),s=function(){function t(t){this.config=t,this._actions=[]}return t.prototype.do=function(){var t=this;if(!this._actions.length){var e=this.config.val,n=0;Array.isArray(e)&&(e=e[n]),this.config.spreadsheet.eachCell(function(s){var a=o.getCellIds(t.config.grid,s),l=a.row,c=a.col,u=new r.actions[t.config.action](i({},t.config,{row:l,col:c,cell:s,val:e}));t._actions.push(u),Array.isArray(t.config.val)&&(n+1>=t.config.val.length?n=0:n+=1,e=t.config.val[n])},this.config.cell)}for(var s=0,a=this._actions;s<a.length;s++){a[s].do()}this.config.spreadsheet.selection.setSelectedCell(this.config.cell)},t.prototype.undo=function(){for(var t=0,e=this._actions;t<e.length;t++){e[t].undo()}var n=this.config.cell.split(":")[0];this.config.spreadsheet.selection.setSelectedCell(n)},t}();e.GroupAction=s},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),r=n(19),s=function(){function t(t){this.config=t,this._actions=[]}return t.prototype.do=function(){var t=this;if(!this._actions.length){var e=o.getCellIds(this.config.grid,this.config.cell).start.row,n=this.config.cell.split(":")[0];this.config.spreadsheet.eachCell(function(s){var a=o.getCellIds(t.config.grid,s),l=a.row,c=a.col;if(l===e){var u=new r.actions[t.config.action](i({},t.config,{row:l,col:c,cell:n}));t._actions.push(u)}},this.config.cell)}for(var s=this._actions.length-1;s>=0;s--)this._actions[s].do()},t.prototype.undo=function(){for(var t=0;t<this._actions.length;t++)this._actions[t].undo()},t}();e.GroupColAction=s},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),r=n(19),s=function(){function t(t){this.config=t,this._actions=[]}return t.prototype.do=function(){var t=this;if(!this._actions.length){var e=o.getCellIds(this.config.grid,this.config.cell).start.col,n=this.config.cell.split(":")[0];this.config.spreadsheet.eachCell(function(s){var a=o.getCellIds(t.config.grid,s),l=a.row,c=a.col;if(c===e){var u=new r.actions[t.config.action](i({},t.config,{row:l,col:c,cell:n}));t._actions.push(u)}},this.config.cell)}for(var s=this._actions.length-1;s>=0;s--)this._actions[s].do()},t.prototype.undo=function(){for(var t=this._actions.length-1;t>=0;t--)this._actions[t].undo()},t}();e.GroupRowAction=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=n(5),r=function(){function t(t){this.config=t}return t.prototype.do=function(){var t=this.config,e=t.val,n=t.cell;i.getCellInfo(this.config.grid,n).locked=e,e?this.config.editLine.lock():this.config.editLine.unlock(),this.config.spreadsheet.events.fire(o.SpreadsheetEvents.afterFocusSet,[n])},t.prototype.undo=function(){var t=this.config,e=t.val,n=t.cell;i.getCellInfo(this.config.grid,n).locked=!e,this.config.spreadsheet.events.fire(o.SpreadsheetEvents.afterFocusSet,[n]),e?this.config.editLine.unlock():this.config.editLine.lock()},t}();e.LockCell=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=n(5),r=function(){function t(t){this.config=t}return t.prototype.do=function(){var t=this.config.cell,e=i.getCellIds(this.config.grid,t),n=e.row,r=e.col,s=i.getCellInfo(this.config.grid,t);s.locked||(this.config.grid.removeCellCss(n,r,s.css),this.config.prev=s.css,i.updateCellInfo(this.config.grid,t,{css:""}),this.config.spreadsheet.events.fire(o.SpreadsheetEvents.afterSelectionSet,[t]),this.config.spreadsheet.events.fire(o.SpreadsheetEvents.afterStyleChange,[t]))},t.prototype.undo=function(){var t=this.config,e=t.row,n=t.col,r=t.cell;i.getCellInfo(this.config.grid,r).locked||(i.updateCellInfo(this.config.grid,r,{css:this.config.prev}),this.config.grid.addCellCss(e,n,this.config.prev),this.config.spreadsheet.events.fire(o.SpreadsheetEvents.afterStyleChange,[r]))},t}();e.RemoveCellStyles=r},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),r=n(5),s=function(){function t(t){this.config=t}return t.prototype.do=function(){var t=this.config.cell,e=o.getCellIds(this.config.grid,t),n=e.row,s=e.col,a=o.getCellInfo(this.config.grid,t);if(!a.locked){if("string"!=typeof this.config.val){var l=dhx.css.get(a.css)||{};Array.isArray(this.config.val)&&(this.config.val=this.config.val[0]);var c=dhx.css.add(i({},l,this.config.val));this.config.val=c}var u=this.config.val;this.config.spreadsheet.events.fire(r.SpreadsheetEvents.beforeStyleChange,[t,dhx.css.get(u)])&&(this.config.prev=a.css,this.config.grid.removeCellCss(n,s,a.css),o.updateCellInfo(this.config.grid,t,{css:u}),this.config.grid.addCellCss(n,s,u),this.config.spreadsheet.events.fire(r.SpreadsheetEvents.afterStyleChange,[this.config.cell,dhx.css.get(u)]))}},t.prototype.undo=function(){var t=this.config.val,e=this.config.prev;this.config.val=e||"",this.config.prev=t||"",this.do(),this.config.val=t,this.config.prev=e},t}();e.SetCellStyle=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=n(5),r=function(){function t(t){this.config=t}return t.prototype.do=function(){var t,e=this.config,n=e.val,r=e.cell,s=i.getCellIds(this.config.grid,r),a=s.row,l=s.col;this.config.spreadsheet.isLocked(r)||this.config.spreadsheet.events.fire(o.SpreadsheetEvents.beforeValueChange,[r,n])&&(this.config.prev=this.config.spreadsheet.getValue(r),this.config.grid.data.update(a,((t={})[l]=n,t)),i.updateCellInfo(this.config.grid,r,{nextValue:void 0}),this.config.spreadsheet.selection.setSelectedCell(this.config.cell),this.config.spreadsheet.events.fire(o.SpreadsheetEvents.afterValueChange,[this.config.cell,n]))},t.prototype.undo=function(){var t=this.config.val,e=this.config.prev;this.config.val=e,this.config.prev=t,this.do(),this.config.val=t,this.config.prev=e},t}();e.SetCellValue=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(8);e.getContextMenuStruct=function(){return[{id:"lock",value:i.default.lockCell,icon:"dxi-key"},{id:"clear",value:i.default.clear,icon:"dxi-eraser",childs:[{id:"clear-value",value:i.default.clearValue},{id:"clear-styles",value:i.default.clearStyles},{id:"clear-all",value:i.default.clearAll}]},{id:"columns",value:i.default.columns,icon:"dxi-table-column",childs:[{id:"add-col",value:i.default.addColumn,icon:"dxi-table-column-plus-before"},{id:"remove-col",value:i.default.removeColumn,icon:"dxi-table-column-remove"}]},{id:"rows",value:i.default.rows,icon:"dxi-table-row",childs:[{id:"add-row",value:i.default.addRow,icon:"dxi-table-row-plus-after"},{id:"remove-row",value:i.default.removeRow,icon:"dxi-table-row-remove"}]}]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(21),o=n(8);e.getMenuStruct=function(){return[{id:"edit",value:o.default.edit,childs:[{id:"undo",value:o.default.undo,icon:"dxi-undo"},{id:"redo",value:o.default.redo,icon:"dxi-redo"},{type:i.ItemType.separator},{id:"lock",value:o.default.lockCell,icon:"dxi-key"},{type:i.ItemType.separator},{id:"clear",value:o.default.clear,icon:"dxi-eraser",childs:[{id:"clear-value",value:o.default.clearValue},{id:"clear-styles",value:o.default.clearStyles},{id:"clear-all",value:o.default.clearAll}]}]},{id:"insert",value:o.default.insert,childs:[{id:"columns",value:o.default.columns,icon:"dxi-table-column",childs:[{id:"add-col",value:o.default.addColumn,icon:"dxi-table-column-plus-before"},{id:"remove-col",value:o.default.removeColumn,icon:"dxi-table-column-remove"}]},{id:"rows",value:o.default.rows,icon:"dxi-table-row",childs:[{id:"add-row",value:o.default.addRow,icon:"dxi-table-row-plus-after"},{id:"remove-row",value:o.default.removeRow,icon:"dxi-table-row-remove"}]}]},{id:"configuration",value:o.default.format,childs:[{id:"font-weight-bold",value:o.default.bold,icon:"dxi-format-bold"},{id:"font-style-italic",value:o.default.italic,icon:"dxi-format-italic"},{id:"text-decoration-underline",value:o.default.underline,icon:"dxi-format-underline"},{type:i.ItemType.separator},{id:"align",value:o.default.align,childs:[{id:"align-left",value:o.default.left,icon:"dxi-format-align-left"},{id:"align-center",value:o.default.center,icon:"dxi-format-align-center"},{id:"align-right",value:o.default.right,icon:"dxi-format-align-right"}]}]},{id:"help",value:o.default.help}]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(21),o=n(24),r=n(8),s={undo:"Z",redo:"Y",bold:"B",italic:"I",underline:"U"};function a(t){return!!navigator.platform.match(/(Mac)/i)?"⌘+"+s[t]:"ctrl+"+s[t]}e.getHotKey=a,e.getToolbarStruct=function(t){var e={undo:[{id:"undo",type:i.ItemType.button,icon:"dxi-undo",tooltip:r.default.undo+" ("+a("undo")+")"},{id:"redo",type:i.ItemType.button,icon:"dxi-redo",tooltip:r.default.redo+" ("+a("redo")+")"}],colors:[{id:"color",type:i.ItemType.customHTMLButton,html:o.getColorpickerTemplate("#4C4C4C",r.default.textColor),tooltip:r.default.textColor},{id:"background",type:i.ItemType.customHTMLButton,html:o.getColorpickerTemplate("#FFF",r.default.backgroundColor),tooltip:r.default.backgroundColor}],lock:[{id:"lock",type:i.ItemType.button,icon:"dxi-key",tooltip:r.default.lockCell}],columns:[{id:"add-col",type:i.ItemType.button,icon:"dxi-table-column-plus-before",tooltip:r.default.addColumn},{id:"remove-col",type:i.ItemType.button,icon:"dxi-table-column-remove dxi-flip-h",tooltip:r.default.removeColumn}],rows:[{id:"add-row",type:i.ItemType.button,icon:"dxi-table-row-plus-after",tooltip:r.default.addRow},{id:"remove-row",type:i.ItemType.button,icon:"dxi-table-row-remove",tooltip:r.default.removeRow}],clear:[{type:"menuItem",icon:"dxi-eraser",id:"clear-group",childs:[{id:"clear-value",value:r.default.clearValue},{id:"clear-styles",value:r.default.clearStyles},{id:"clear-all",value:r.default.clearAll}]}],align:[{id:"align-left",type:i.ItemType.button,icon:"dxi-format-align-left",tooltip:r.default.align+" "+r.default.left},{id:"align-center",type:i.ItemType.button,icon:"dxi-format-align-center",tooltip:r.default.align+" "+r.default.center},{id:"align-right",type:i.ItemType.button,icon:"dxi-format-align-right",tooltip:r.default.align+" "+r.default.right}],decoration:[{id:"font-weight-bold",type:i.ItemType.button,icon:"dxi-format-bold",tooltip:r.default.bold+" ("+a("bold")+")"},{id:"font-style-italic",type:i.ItemType.button,icon:"dxi-format-italic",tooltip:r.default.italic+" ("+a("italic")+")"},{id:"text-decoration-underline",type:i.ItemType.button,icon:"dxi-format-underline",tooltip:r.default.underline+" ("+a("underline")+")"}],help:[{id:"help",type:i.ItemType.button,icon:"dxi-help-circle-outline",tooltip:r.default.help}]};return(t=(t||["undo","colors","decoration","align","help"]).filter(function(t,e,n){return n.indexOf(t)===e})).reduce(function(t,n,o,r){return e[n]&&(t.push.apply(t,e[n]),o!==r.length-1&&t.push({type:i.ItemType.separator})),t},[])}},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(9),s=n(5),a=function(t){function e(e,n){void 0===n&&(n={});var i=t.call(this,e,n)||this;i._htmlEvents={oninput:function(t){i.config.events.fire(s.SpreadsheetEvents.editLineInput,[t.target.value])},onfocus:function(t){i.config.events.fire(s.SpreadsheetEvents.editLineFocus,[t.target.value,t])},onblur:function(t){i.config.events.fire(s.SpreadsheetEvents.editLineBlur,[t.target.value,t])}},i.config.events.on(s.SpreadsheetEvents.cellInput,function(t,e){i._value=e,i.paint()});return i.mount(e,o.create({render:function(){return i._render()}})),i}return i(e,t),e.prototype.focus=function(){this.getRootView().refs.input.el.focus()},e.prototype.blur=function(){this.getRootView().refs.input.el.blur()},e.prototype.lock=function(){this._locked=!0,this.paint()},e.prototype.unlock=function(){this._locked=!1,this.paint()},e.prototype.setValue=function(t){this.unlock(),this._value=t,this.paint()},e.prototype.clean=function(){var t=this;setTimeout(function(){t._value="",t.paint()},1)},e.prototype._render=function(){return o.el(".dhx_edit_line",{},[o.el(".input-wrapper",[o.el("input.dhx_edit_line_input",{oninput:this._htmlEvents.oninput,onfocus:this._htmlEvents.onfocus,onblur:this._htmlEvents.onblur,value:this._value||"",_ref:"input",disabled:this._locked}),o.el(".input-animation")])])},e}(r.View);e.EditLine=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),o=n(1),r=function(){function t(t,e,n){this._spreadsheet=t,this._grid=e,this._callAction=n.bind(t),this._buffer={value:"",styles:{},cell:"",cells:"",operation:"",inserted:!1}}return t.prototype.store=function(t){var e=this._spreadsheet.selection.getSelectedCell(),n=this._spreadsheet.selection.getFocusedCell();o.getCellInfo(this._grid,n).edited||(o.isRangeId(e)&&-1===e.indexOf(":")?this._buffer.cell=null:(this._buffer.value=this._spreadsheet.getValue(e),this._buffer.styles=this._spreadsheet.getStyle(e),this._buffer.cells=e,this._buffer.cell=n,this._buffer.operation=t,this._buffer.inserted=!1,this._grid.paint()))},t.prototype.paste=function(){if(this._buffer.cell){this._buffer.inserted=!0;var t=this._spreadsheet.selection.getSelectedCell(),e=t,n=!1;if(o.isRangeId(this._buffer.cells)){n=!0;var r=o.getRangeIndexes(this._buffer.cells),s=o.getCellIndex(t),a={row:r.end.row-r.start.row,col:r.end.col-r.start.col},l=o.getCellNameByIndex(s.row+a.row,s.col+a.col);if(o.isRangeId(t))o.getCellsArray(this._buffer.cells).length>o.getCellsArray(t).length&&(e=t.split(":")[0]+":"+l);else e+=":"+l}var c=o.isRangeId(e),u=Array.isArray(this._buffer.styles)?this._buffer.styles.map(function(t){return dhx.css.add(t)}):dhx.css.add(this._buffer.styles),d=[];"cut"===this._buffer.operation&&(d.push({cell:this._buffer.cells,action:i.Actions.setCellValue,val:"",groupAction:n?i.Actions.groupAction:null},{cell:this._buffer.cells,action:i.Actions.setCellStyle,val:"",groupAction:n?i.Actions.groupAction:null}),this._buffer.operation="copy"),d.push({cell:e,action:i.Actions.setCellValue,val:this._buffer.value,groupAction:c?i.Actions.groupAction:null},{cell:e,action:i.Actions.setCellStyle,val:u,groupAction:c?i.Actions.groupAction:null}),this._callAction(d)}},t.prototype.getStruct=function(){return this._buffer},t}();e.BufferManager=r},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(10),r=n(1),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.toJsonArray=function(e){return t.prototype.toJsonArray.call(this,e).reduce(function(t,e,n){for(var i in e)t.push({value:e[i],cell:r.getCellNameByIndex(n,parseFloat(i))});return t},[])},e}(o.CsvDriver);e.CustomCsvDriver=s},function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o=this;Object.defineProperty(e,"__esModule",{value:!0});var r=n(104),s=n(105),a=n(1),l=n(24),c=n(5);function u(t,e,n,i,o){if(!a.getCellInfo(e,t.selection.getFocusedCell()).edited){var r=a.getCellIndex(t.selection.getFocusedCell()),s=f(e,o),l=i?r[o]+i:n;l>=s.min&&l<=s.max&&(r[o]=l);var c=a.getCellNameByIndex(r.row,r.col);t.selection.setSelectedCell(c);var u=a.getCellIds(e,c);e.scrollTo(u.row,u.col)}}function d(t,e,n,o){var r=t.selection.getFocusedCell();if(!a.getCellInfo(e,r).edited){var s,l,c=a.getCellIndex(r),u=t.selection.getSelectedCell().split(",")[0];if(-1===u.indexOf(":"))s=i({},c),l=c;else{var d=a.getRangeIndexes(u);d.end[o]>c[o]?(s=i({},d.end),l=d.start):(s=i({},d.start),l=d.end)}var h=f(e,o);if(s[o]+n>=h.min&&s[o]+n<=h.max){s[o]+=n;var p=a.getCellNameByIndex(s.row,s.col);if(p===(l=a.getCellNameByIndex(l.row,l.col)))return void t.selection.setSelectedCell(p);t.selection.setSelectedCell(p+":"+l),t.selection.setFocusedCell(r)}}}function f(t,e){return"row"===e?{min:0,max:t.data.getLength()-1}:{min:1,max:t.config.columns.length-1}}e.focusHandler={inFocus:null,getFocusState:function(){return o.inFocus},setFocusState:function(t){return o.inFocus=t}},e.initHotkeys=function(t,n,i){var o,f=function(t,n){r.keyManager.addHotKey(t,function(t){e.focusHandler.getFocusState()&&n(t)})};t.events.on(c.SpreadsheetEvents.afterEditStart,function(t){o=t}),t.events.on(c.SpreadsheetEvents.afterEditEnd,function(){o=null}),document.addEventListener("mousedown",function(n){var i=n.target;e.focusHandler.setFocusState(function(t,e){for(var n=e.parentNode;null!==n;){if(n===t)return!0;n=n.parentNode}return!1}(t.container,i)||i.isEqualNode(t.container))}),t.container.addEventListener("mouseenter",function(t){null===e.focusHandler.getFocusState()&&e.focusHandler.setFocusState(!0)}),document.addEventListener("keydown",function(n){if(e.focusHandler.getFocusState()&&s.isPrintableKey(n)){var i=t.selection.getFocusedCell();i&&i!==o&&(n.preventDefault(),t.startEdit(i,n.key))}}),f("escape",function(){var e=t.selection.getSelectedCell(),i=a.getCellIds(n,e),o=n.data.getItem(i.row)[i.col];e&&(a.updateCellInfo(n,e,{nextValue:o}),t.endEdit(),n.paint())}),f("delete",function(){if(!o){var e=t.selection.getSelectedCell();e&&t.setValue(e,""),n.paint()}});var h=function(t){var e=i.getStruct();t!==JSON.stringify(e.value)?(i.store("copy"),e.value=t,i.paste()):i.paste()};window.clipboardData?(f("ctrl+c",function(){e.focusHandler.getFocusState()&&!o&&(i.store("copy"),window.clipboardData&&window.clipboardData.setData("text",JSON.stringify(t.getValue(t.selection.getSelectedCell()))))}),f("ctrl+x",function(){e.focusHandler.getFocusState()&&!o&&(i.store("cut"),window.clipboardData&&window.clipboardData.setData("text",JSON.stringify(t.getValue(t.selection.getSelectedCell()))))}),f("ctrl+v",function(){if(e.focusHandler.getFocusState()&&!o&&window.clipboardData){var t=window.clipboardData.getData("text");h(t)}})):(document.addEventListener("cut",function(n){e.focusHandler.getFocusState()&&!o&&(i.store("cut"),n.clipboardData.setData("text/plain",JSON.stringify(t.getValue(t.selection.getSelectedCell()))),n.preventDefault())}),document.addEventListener("copy",function(n){e.focusHandler.getFocusState()&&!o&&(i.store("copy"),n.clipboardData.setData("text/plain",JSON.stringify(t.getValue(t.selection.getSelectedCell()))),n.preventDefault())}),document.addEventListener("paste",function(t){if(e.focusHandler.getFocusState()&&!o){var n=t.clipboardData.getData("text");h(n),t.preventDefault()}})),f("enter",function(){if(o){var e=a.getCellIndex(o);e.row=e.row+1===n.data.getLength()?e.row:e.row+1,t.selection.setSelectedCell(a.getCellNameByIndex(e.row,e.col))}else t.startEdit(t.selection.getSelectedCell())}),f("f2",function(){t.startEdit(t.selection.getSelectedCell())}),f("pageUp",function(t){t.preventDefault();var e=n.getRootView().refs.grid_body;e.el.scrollTop-=e.el.clientHeight}),f("pageDown",function(t){t.preventDefault();var e=n.getRootView().refs.grid_body;e.el.scrollTop+=e.el.clientHeight-n.config.rowHeight}),f("ctrl+a",function(e){e.preventDefault();var i=a.getCellNameByIndex(0,1),o=a.getCellNameByIndex(n.data.getLength()-1,n.config.columns.length-1);t.selection.setSelectedCell(i+":"+o)}),f("shift+arrowLeft",function(){d(t,n,-1,"col")}),f("shift+arrowRight",function(){d(t,n,1,"col")}),f("shift+arrowDown",function(){d(t,n,1,"row")}),f("shift+arrowUp",function(){d(t,n,-1,"row")}),f("ctrl+enter",function(){t.endEdit()}),f("shift+enter",function(){u(t,n,null,-1,"row")}),f("tab",function(e){e.preventDefault(),u(t,n,null,1,"col")}),f("shift+tab",function(e){e.preventDefault(),u(t,n,null,-1,"col")}),f("arrowLeft",function(e){o||(e.preventDefault(),u(t,n,null,-1,"col"))}),f("arrowRight",function(e){o||(e.preventDefault(),u(t,n,null,1,"col"))}),f("arrowDown",function(e){o||(e.preventDefault(),u(t,n,null,1,"row"))}),f("arrowUp",function(e){o||(e.preventDefault(),u(t,n,null,-1,"row"))}),f("ctrl+arrowLeft",function(){u(t,n,1,null,"col")}),f("ctrl+arrowRight",function(){u(t,n,n.config.columns.length-1,null,"col")}),f("ctrl+arrowDown",function(){u(t,n,n.data.getLength()-1,null,"row")}),f("ctrl+arrowUp",function(){u(t,n,0,null,"row")}),f("home",function(e){e.preventDefault(),u(t,n,1,null,"col")}),f("end",function(e){e.preventDefault(),u(t,n,n.config.columns.length-1,null,"col")}),f("ctrl+home",function(){u(t,n,0,null,"row"),u(t,n,1,null,"col")}),f("ctrl+end",function(){u(t,n,n.data.getLength()-1,null,"row"),u(t,n,n.config.columns.length-1,null,"col")}),f("ctrl+z",function(){t.undo()}),f("ctrl+y",function(e){e.preventDefault(),t.redo()}),f("ctrl+shift+z",function(){t.redo()}),f("ctrl+b",function(){var e=t.selection.getSelectedCell(),i=l.getToggledValue(n,e,"font-weight","bold");t.setStyle(t.selection.getSelectedCell(),{"font-weight":i})}),f("ctrl+i",function(){var e=t.selection.getSelectedCell(),i=l.getToggledValue(n,e,"font-style","italic");t.setStyle(t.selection.getSelectedCell(),{"font-style":i})}),f("ctrl+u",function(e){e.preventDefault();var i=t.selection.getSelectedCell(),o=l.getToggledValue(n,i,"text-decoration","underline");t.setStyle(t.selection.getSelectedCell(),{"text-decoration":o})}),f("backspace",function(){o||t.setValue(t.selection.getSelectedCell(),"")})}},function(t,e,n){"use strict";function i(t){for(var e=t.toLowerCase().match(/\w+/g),n=0,i="",o=0;o<e.length;o++){var r=e[o];"ctrl"===r?n+=4:"shift"===r?n+=2:"alt"===r?n+=1:i=r}return n+i}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(){var t=this;this._keysStorage={},document.addEventListener("keydown",function(e){var n=(e.ctrlKey||e.metaKey?4:0)+(e.shiftKey?2:0)+(e.altKey?1:0)+(e.which>=48&&e.which<=57||e.which>=65&&e.which<=90?String.fromCharCode(e.which):e.key).toLowerCase(),i=t._keysStorage[n];if(i)for(var o=0;o<i.length;o++)i[o].handler(e)})}return t.prototype.addHotKey=function(t,e,n){var o=i(t);this._keysStorage[o]||(this._keysStorage[o]=[]),this._keysStorage[o].push({handler:e,scope:n})},t.prototype.removeHotKey=function(t,e){var n=this._keysStorage;t&&delete n[o=i(t)];if(e)for(var o in n){for(var r=[],s=0;s<n[o].length;s++)n[o][s].scope===e&&r.push(s);if(n[o].length===r.length)delete n[o];else for(s=r.length-1;s>=0;s--)n[o].splice(r[s],1)}},t.prototype.exist=function(t){var e=i(t);return!!this._keysStorage[e]},t}();e.keyManager=new o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isPrintableKey=function(t){if(!(t.ctrlKey||t.altKey||t.metaKey)){var e=t.which||t.keyCode;return e>=65&&e<=90||e>=48&&e<=57||e>=96&&e<=105||!!{32:" ",106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}[e]||!1}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=n(0),r=n(29),s=n(107),a=n(1),l=n(5),c=function(){function t(t,e,n){this._spreadsheet=t,this._grid=e,this._bufferManager=n,this._selected=[],this._focusedCell={row:"",col:"",cell:""},this._events=t.events,this._setHandlers()}return t.prototype.setSelectedCell=function(t){if(t&&this._events.fire(l.SpreadsheetEvents.beforeSelectionSet,[t])){this._removeHeadersCss();var e=t.split(",");this._selected=e;var n=this._selected[this._selected.length-1];a.isRangeId(n)&&(n=n.split(":")[0]),this.setFocusedCell(n),this._setHeadersCss(),this._mousePressed?this._grid.paint():this._events.fire(l.SpreadsheetEvents.afterSelectionSet,[this.getSelectedCell()])}},t.prototype.getSelectedCell=function(){if(this._selected.length)return this._selected.join(",")},t.prototype.getFocusedCell=function(){if(this._focusedCell&&this._focusedCell.cell)return this._focusedCell.cell},t.prototype.setFocusedCell=function(t){if(t=t.toUpperCase(),this._events.fire(l.SpreadsheetEvents.beforeFocusSet,[t])){var e=a.getCellIds(this._grid,t),n=e.row,i=e.col;this._focusedCell={row:n,col:i,cell:t,edit:!1},this._events.fire(l.SpreadsheetEvents.afterFocusSet,[t])}},t.prototype._isInRange=function(t,e){if(!e||!t||-1===e.indexOf(":"))return!1;var n=a.getCellIndex(t),i=n.row,o=n.col,r=a.getRangeIndexes(e),s=r.start,l=r.end,c=function(t,e,n){return(t-e)*(t-n)<=0};return!(!s||!l)&&(c(i,s.row,l.row)&&c(o,s.col,l.col))},t.prototype._removeHeadersCss=function(){var t=this;this.getSelectedCell()&&(this._spreadsheet.eachCell(function(e){var n=a.getCellIndex(e),i=t._grid.data.getId(n.row);void 0!==i&&t._grid.removeRowCss(i,"dhx_selected_row");var o=t._grid.config.columns[n.col];void 0!==o&&(o.header[0].css=o.header[0].css.replace(" dhx_selected_header",""))}),this._grid.data.exists(this._focusedCell.row)&&this._grid.removeRowCss(this._focusedCell.row,"dhx_selected_row"))},t.prototype._setHeadersCss=function(){var t=this;this.getSelectedCell()&&this._spreadsheet.eachCell(function(e){var n=a.getCellIndex(e),i=t._grid.data.getId(n.row);void 0!==i&&t._grid.addRowCss(i,"dhx_selected_row");var o=t._grid.config.columns[n.col];void 0===o||RegExp(/dhx_selected_header/).test(o.header[0].css)||(o.header[0].css+=" dhx_selected_header")})},t.prototype._selectRow=function(t){var e=this._grid.config.columns[1],n=this._grid.config.columns[this._grid.config.columns.length-1];this.setSelectedCell(a.getCellNameById(this._grid,t.id,e.id)+":"+a.getCellNameById(this._grid,t.id,n.id))},t.prototype._selectColumn=function(t){var e=this._grid.data.getId(0),n=this._grid.data.getId(this._grid.data.getLength()-1),i=this._grid.data.getItem(e),o=this._grid.data.getItem(n);this.setSelectedCell(a.getCellNameById(this._grid,i.id,t.id)+":"+a.getCellNameById(this._grid,o.id,t.id))},t.prototype._setGroupSelectionHandlers=function(){var t=this;this._grid.events.on(r.GridEvents.cellMouseOver,function(e,n){if(!a.getCellInfo(t._grid,t.getFocusedCell()).edited&&t._mousePressed){if(("cell"===t._pressedArea||"header"===t._pressedArea)&&"$index"===n.id)return;if("header"===t._pressedArea&&"$index"!==n.id){var i=t._grid.data.getId(t._grid.data.getLength()-1),o=t._grid.data.getItem(i);return void t.setSelectedCell(t._focusedCell.cell+":"+a.getCellNameById(t._grid,o.id,n.id))}var r=t._grid.config.columns[t._grid.config.columns.length-1],s=a.getCellNameById(t._grid,e.id,"index"===t._pressedArea?r.id:n.id);if(t._focusedCell.cell!==s){var l=t._focusedCell.cell+":"+s,c=t._selected.slice();c[c.length-1]=l,t.setSelectedCell(c.join(","))}}}),this._grid.events.on(r.GridEvents.headerCellMouseOver,function(e){if("cell"!==t._pressedArea&&t._mousePressed&&"header"===t._pressedArea&&"$index"!==e.id){var n=t._grid.data.getId(t._grid.data.getLength()-1),i=t._grid.data.getItem(n);t.setSelectedCell(t._focusedCell.cell+":"+a.getCellNameById(t._grid,i.id,e.id))}})},t.prototype._setHandlers=function(){var t,e,n=this;document.addEventListener("mouseup",function(){n._mousePressed&&(n._mousePressed=!1,n._pressedArea=null,document.removeEventListener("mousemove",c),e&&clearTimeout(e),n._selected.length&&n._events.fire(l.SpreadsheetEvents.afterSelectionSet,[n.getSelectedCell()]),n._grid.paint())});var c=function(i){e&&clearTimeout(e);var o=n._grid.getScrollState();i.clientX>t.width+t.left-50&&n._grid.scroll(o.x+50,o.y),i.clientX<t.left+50&&n._grid.scroll(o.x-50,o.y),i.clientY>t.height+t.top-50&&n._grid.scroll(o.x,o.y+50),i.clientY<t.top+50&&n._grid.scroll(o.x,o.y-50),e=setTimeout(function(){c(i)},100)};this._grid.events.on(r.GridEvents.cellMouseDown,function(e,i,o){if(n._mousePressed=!0,t=n._grid.getRootView().node.el.getBoundingClientRect(),document.addEventListener("mousemove",c),"selection_grip"!==o.target.getAttribute("dhx_id")){if("$index"===i.id)return n._pressedArea="index",void n._selectRow(e);n._pressedArea="cell";var r=a.getCellNameById(n._grid,e.id,i.id),s=a.getCellInfo(n._grid,r);if(!(3===o.which&&n._isInRange(r,n._selected[n._selected.length-1])||s.edited))if(o.shiftKey)n.setSelectedCell(n._focusedCell.cell+":"+a.getCellNameById(n._grid,e.id,i.id));else if(o.ctrlKey||o.metaKey){var l=n.getSelectedCell();l&&n.setSelectedCell(l+","+r)}else n.setSelectedCell(r)}}),this._grid.events.on(r.GridEvents.headerCellMouseDown,function(t,e){var i=e.target.getAttribute("dhx_id");if(i){if("$index"===i){var o=a.getCellNameByIndex(0,1),r=a.getCellNameByIndex(n._grid.data.getLength()-1,n._grid.config.columns.length-1);return void n.setSelectedCell(o+":"+r)}n._resizedColumn=n._grid.config.columns[i].id,s.startResize(n._grid,n._resizedColumn,e,function(){n._resizedColumn=null,n._grid.paint()})}else n._pressedArea="header",n._selectColumn(t),n._mousePressed=!0}),this._setGroupSelectionHandlers(),this._grid.events.on(r.GridEvents.cellDblClick,function(t,e){"$index"!==e.id&&n._spreadsheet.startEdit(a.getCellNameById(n._grid,t.id,e.id))}),this._grid.events.on(r.GridEvents.headerCellDblClick,function(t,e){e.target.getAttribute("dhx_id")&&n._grid.adjustColumnWidth(t.id)}),this._events.on(l.SpreadsheetEvents.gridRedraw,function(t){var e=n.getSelectedCell(),r=n.getFocusedCell();if(e&&r){var s,l,c=function(t){return{x:n._grid.config.columns.slice(0,t.col).reduce(function(t,e){return t+e.width},0),y:t.row*n._grid.config.rowHeight,width:n._grid.config.columns[t.col].width+1,height:n._grid.config.rowHeight+1}},u=function(t){var e=c(t.start),n=c(t.end);return{x:e.x,y:e.y,width:n.x-e.x+n.width,height:n.y-e.y+n.height}},d=n._selected.map(function(t){if(a.isRangeId(t)){var e=u(a.getRangeIndexes(t));return o.el(".dhx_group_selection",{style:{top:e.y,left:e.x,width:e.width,height:e.height}})}if(1!==n._selected.length){var i=c(a.getCellIndex(t)),r=i.x,s=i.y,l=i.width,d=i.height;return o.el(".dhx_group_selection",{style:{width:l,height:d,top:s,left:r,position:"absolute",pointerEvents:"none"}})}}),f=c(a.getCellIndex(r)),h=o.el(".dhx_selected_cell",{style:{width:f.width,height:f.height,top:f.y,left:f.x,position:"absolute",pointerEvents:"none"}}),p=n._bufferManager.getStruct();if(p.cell&&!p.inserted){var g=a.getCellsArray(p.cells),v=a.getCellIndex(g[0]),_=a.getCellIndex(g[g.length-1]),y=u({start:v,end:_});s=o.el(".dhx_copy_selection",{style:{top:y.y,left:y.x,width:y.width,height:y.height}})}if(n._resizedColumn){var m=i.findIndex(n._grid.config.columns,function(t){return t.id===n._resizedColumn}),w=c({row:0,col:m}),C=n._grid.config.$totalHeight;l=o.el(".resize_line",{style:{top:w.y,left:w.x+w.width-1.5,height:C}})}t.refs.selection.patch(o.el(".dhx_grid_selection",[s,h].concat(d,[l])))}})},t}();e.Selection=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2);e.startResize=function(t,e,n,o){var r=n.clientX,s=0,a=function(n){var o=i.findIndex(t.config.columns,function(t){return t.id===e});s=s||t.config.columns[o].width;var a=n.clientX-r,l=t.config.columns.slice(),c=s+a;l[o].width=c<=20?20:c,t.setHeader(l),t.paint()},l=function(){document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",l),o()};document.addEventListener("mousemove",a),document.addEventListener("mouseup",l),t.paint()}}])}),window.dhx_legacy){if(window.dhx)for(var key in dhx)dhx_legacy[key]=dhx[key];window.dhx=dhx_legacy,delete window.dhx_legacy}